import{i as ge,j as e,a as Qs,B as t,r as Y,f as Ve,g as tt,h as st,k as Ie,l as j,m as nt,I as oe,E as De,G as Pe,X as we,H as Me,R as Gn,Z as qn,y as vt,U as Dt,F as $e,K as We,S as He,M as ce,d as Ae,e as ve,C as je,a4 as Kn,a6 as It,A as et,a3 as en,a5 as tn,a1 as sn,W as Pt,a7 as Fs,D as gt,a8 as Yn,a9 as Jn,aa as Xn,ab as Zn,N as Qn}from"./mui-vendor-C85vPdgr.js";import{r as l,b as Ot,f as nn,u as el,L as tl}from"./react-vendor-QLNaZ7XN.js";import{r as fe,u as Ne,e as dt,c as Ke,f as Ye,g as ke,h as Se,R as Je,d as Ee,a as ze,i as lt,j as he,D as Te,k as ye,l as sl,m as Bs,n as ss,_ as nl}from"./index-CvPj5UcW.js";import{t as ll,P as ct,u as rl,a as ol,d as il}from"./PlayDetailChip-dh_jWCGa.js";import{D as Be,C as _e,P as Re,d as rt,u as ot,a as it}from"./useLongPress-BJgmop5a.js";import{A as al,m as cl}from"./motion-vendor-CXcnLVtk.js";import"./chart-vendor-DVL1rbVz.js";var is={},dl=ge;Object.defineProperty(is,"__esModule",{value:!0});var Ge=is.default=void 0,xl=dl(fe()),hl=e;Ge=is.default=(0,xl.default)((0,hl.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7"}),"VisibilityOutlined");var as={},ul=ge;Object.defineProperty(as,"__esModule",{value:!0});var qe=as.default=void 0,pl=ul(fe()),gl=e;qe=as.default=(0,pl.default)((0,gl.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6m-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14M2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45zm7.5 7.5 2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13m-3.4-3.4 1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53"}),"VisibilityOffOutlined");var cs={},fl=ge;Object.defineProperty(cs,"__esModule",{value:!0});var Mt=cs.default=void 0,ml=fl(fe()),jl=e;Mt=cs.default=(0,ml.default)((0,jl.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined");var ds={},yl=ge;Object.defineProperty(ds,"__esModule",{value:!0});var Ct=ds.default=void 0,bl=yl(fe()),vl=e;Ct=ds.default=(0,bl.default)((0,vl.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined");var xs={},Cl=ge;Object.defineProperty(xs,"__esModule",{value:!0});var ln=xs.default=void 0,Il=Cl(fe()),wl=e;ln=xs.default=(0,Il.default)((0,wl.jsx)("path",{d:"M4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29M20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24zm-7.76-2.78c-1.17-.52-2.61-.9-4.24-.9-1.63 0-3.07.39-4.24.9C6.68 14.13 6 15.21 6 16.39V18h12v-1.61c0-1.18-.68-2.26-1.76-2.74M8.07 16c.09-.23.13-.39.91-.69.97-.38 1.99-.56 3.02-.56s2.05.18 3.02.56c.77.3.81.46.91.69zM12 8c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0-2c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"GroupsOutlined");var hs={},Sl=ge;Object.defineProperty(hs,"__esModule",{value:!0});var rn=hs.default=void 0,Tl=Sl(fe()),kl=e;rn=hs.default=(0,Tl.default)((0,kl.jsx)("path",{d:"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonOutlined");var us={},_l=ge;Object.defineProperty(us,"__esModule",{value:!0});var on=us.default=void 0,Rl=_l(fe()),Ol=e;on=us.default=(0,Rl.default)((0,Ol.jsx)("path",{d:"M18 9h-2.5c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1H18c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1m-.5 4.5H16v-3h1.5zm-8 1.5H5v-2.5c0-.55.45-1 1-1h2v-1H5V9h3.5c.55 0 1 .45 1 1v1.5c0 .55-.45 1-1 1h-2v1h3zm3.25-4h-1.5V9.5h1.5zm0 3.5h-1.5V13h1.5zM22 6v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h3V2h2v2h6V2h2v2h3c1.1 0 2 .9 2 2m-2 12V6h-7.25v1.5h-1.5V6H4v12h7.25v-1.5h1.5V18z"}),"ScoreboardOutlined");var ps={},Dl=ge;Object.defineProperty(ps,"__esModule",{value:!0});var an=ps.default=void 0,Pl=Dl(fe()),Vs=e;an=ps.default=(0,Pl.default)([(0,Vs.jsx)("path",{d:"m21.41 11.41-8.83-8.83c-.37-.37-.88-.58-1.41-.58H4c-1.1 0-2 .9-2 2v7.17c0 .53.21 1.04.59 1.41l8.83 8.83c.78.78 2.05.78 2.83 0l7.17-7.17c.78-.78.78-2.04-.01-2.83M12.83 20 4 11.17V4h7.17L20 12.83z"},"0"),(0,Vs.jsx)("circle",{cx:"6.5",cy:"6.5",r:"1.5"},"1")],"SellOutlined");var gs={},Ml=ge;Object.defineProperty(gs,"__esModule",{value:!0});var cn=gs.default=void 0,El=Ml(fe()),bt=e;cn=gs.default=(0,El.default)([(0,bt.jsx)("path",{d:"M12 22C6.49 22 2 17.51 2 12S6.49 2 12 2s10 4.04 10 9c0 3.31-2.69 6-6 6h-1.77c-.28 0-.5.22-.5.5 0 .12.05.23.13.33.41.47.64 1.06.64 1.67 0 1.38-1.12 2.5-2.5 2.5m0-18c-4.41 0-8 3.59-8 8s3.59 8 8 8c.28 0 .5-.22.5-.5 0-.16-.08-.28-.14-.35-.41-.46-.63-1.05-.63-1.65 0-1.38 1.12-2.5 2.5-2.5H16c2.21 0 4-1.79 4-4 0-3.86-3.59-7-8-7"},"0"),(0,bt.jsx)("circle",{cx:"6.5",cy:"11.5",r:"1.5"},"1"),(0,bt.jsx)("circle",{cx:"9.5",cy:"7.5",r:"1.5"},"2"),(0,bt.jsx)("circle",{cx:"14.5",cy:"7.5",r:"1.5"},"3"),(0,bt.jsx)("circle",{cx:"17.5",cy:"11.5",r:"1.5"},"4")],"PaletteOutlined");var fs={},zl=ge;Object.defineProperty(fs,"__esModule",{value:!0});var dn=fs.default=void 0,$l=zl(fe()),Us=e;dn=fs.default=(0,$l.default)([(0,Us.jsx)("path",{d:"M20 3H4c-1.11 0-2 .89-2 2v12c0 1.1.89 2 2 2h4v2h8v-2h4c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2m0 14H4V5h16z"},"0"),(0,Us.jsx)("path",{d:"M6 8.25h8v1.5H6zm10.5 1.5H18v-1.5h-1.5V7H15v4h1.5zm-6.5 2.5h8v1.5h-8zM7.5 15H9v-4H7.5v1.25H6v1.5h1.5z"},"1")],"DisplaySettingsOutlined");var ms={},Hl=ge;Object.defineProperty(ms,"__esModule",{value:!0});var xn=ms.default=void 0,Al=Hl(fe()),Wl=e;xn=ms.default=(0,Al.default)((0,Wl.jsx)("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"StorageOutlined");var js={},Nl=ge;Object.defineProperty(js,"__esModule",{value:!0});var hn=js.default=void 0,Ll=Nl(fe()),Fl=e;hn=js.default=(0,Ll.default)((0,Fl.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");var ys={},Bl=ge;Object.defineProperty(ys,"__esModule",{value:!0});var un=ys.default=void 0,Vl=Bl(fe()),Ul=e;un=ys.default=(0,Vl.default)((0,Ul.jsx)("path",{d:"M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"}),"LinkOutlined");var bs={},Gl=ge;Object.defineProperty(bs,"__esModule",{value:!0});var pn=bs.default=void 0,ql=Gl(fe()),Kl=e;pn=bs.default=(0,ql.default)((0,Kl.jsx)("path",{d:"M16.54 11 13 7.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41zM11 7H2v2h9zm10 6.41L19.59 12 17 14.59 14.41 12 13 13.41 15.59 16 13 18.59 14.41 20 17 17.41 19.59 20 21 18.59 18.41 16zM11 15H2v2h9z"}),"RuleOutlined");function Yl({teams:y,setTeams:f,setMembers:k,selectedTeam:p,setSelectedTeam:_,createTeam:R,showSnackbar:A}){const[T,O]=l.useState(!1),[w,W]=l.useState(""),[v,b]=l.useState(null),H=Qs(),E=Ne("md"),{handleTouchEnd:P,setSwiperRef:c,getSwiperRef:B}=dt(2),[$,z]=l.useState(""),g="tutorial-team-swipe",[J,Q]=l.useState(()=>E&&y.length>0&&!localStorage.getItem(g)),[se,le]=l.useState(()=>{var s;return((s=y[0])==null?void 0:s.id)||""}),ie=l.useRef(y.length),S=s=>{if($){const m=B($);m&&(m.allowTouchMove=!0),z("")}if(!s.destination)return;const i=Array.from(y),[o]=i.splice(s.source.index,1);i.splice(s.destination.index,0,o),f(i)},de=()=>{b(-1),W(""),O(!0)},n=s=>{b(s),W(y[s].name),O(!0)},x=()=>{if(v===-1){const s=R(w);f(i=>[...i,s]),k(i=>({...i,[s.id]:[]})),p||_(s.id),E&&!localStorage.getItem(g)&&(le(s.id),Q(!0))}else if(v!==null){const s=y[v].id;f(i=>i.map((o,m)=>m===v?{...o,name:w}:o)),p===s&&_(s)}O(!1)},C=()=>{O(!1)},q=s=>{var te;const i=y[s];let o=[];k(Z=>{o=Z[i.id]||[];const X={...Z};return delete X[i.id],X});const m=p,N=y.filter((Z,X)=>X!==s);f(N),p===i.id&&_(((te=N[0])==null?void 0:te.id)||""),A("チームを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{f(Z=>{const X=[...Z];return X.splice(s,0,i),X}),k(Z=>({...Z,[i.id]:o})),_(m)},autoHideDuration:5e3})};l.useEffect(()=>{E&&y.length>0&&ie.current===0&&!localStorage.getItem(g)&&(le(y[0].id),Q(!0)),ie.current=y.length},[y,E]);const a=({t:s,idx:i,dragProvided:o})=>{const m=o.dragHandleProps,{onPointerDown:N,...te}=m||{},Z=ot(X=>{N==null||N(X);const re=B(s.id);re&&(re.allowTouchMove=!1),z(s.id)});return e.jsx(t,{ref:o.innerRef,...o.draggableProps,style:o.draggableProps.style,children:e.jsx(Gn,{open:J&&se===s.id,onClose:()=>Q(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:qn,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${H.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${H.palette.text.secondary}`}}}},title:e.jsxs(t,{sx:{p:1,maxWidth:260},children:[e.jsx(vt,{variant:"body2",sx:{whiteSpace:"pre-line"},children:ll.teamSwipe.text}),e.jsx(t,{sx:{textAlign:"right",mt:1},children:e.jsx(Dt,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem(g,"1"),Q(!1)},children:"了解した"})})]}),children:e.jsx(t,{children:e.jsxs(lt,{onSwiper:X=>c(s.id,X),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(X,re)=>re.stopPropagation(),onTouchEnd:X=>P(s.id,X),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...te,...Z,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:$===s.id?"none":"pan-y",cursor:"grab"},children:e.jsx(t,{sx:{flexGrow:1},children:s.name})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>n(i),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>q(i),children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})})})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(Y,{onClick:de,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})}),e.jsx(Ye,{component:Ve,storageKey:"teams-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:S,children:E?e.jsx(_e,{droppableId:"teams",children:s=>e.jsxs(t,{ref:s.innerRef,...s.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:e.jsx(t,{sx:{flexGrow:1},children:"チーム名"})}),y.map((i,o)=>e.jsx(Re,{draggableId:i.id,index:o,children:m=>e.jsx(a,{t:i,idx:o,dragProvided:m})},i.id)),s.placeholder]})}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:s=>s.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{}),e.jsx(j,{children:"チーム名"}),e.jsx(j,{})]})}),e.jsx(_e,{droppableId:"teams",children:s=>e.jsxs(nt,{ref:s.innerRef,...s.droppableProps,children:[y.map((i,o)=>e.jsx(Re,{draggableId:i.id,index:o,children:m=>e.jsxs(Ie,{ref:m.innerRef,...m.draggableProps,style:m.draggableProps.style,onClick:()=>n(o),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",onClick:N=>N.stopPropagation(),children:e.jsx(t,{onClick:N=>N.stopPropagation(),...m.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:i.name}),e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:N=>N.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:()=>q(o),sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:"error"})})})})]})},i.id)),s.placeholder]})})]})})})]}),e.jsxs(Je,{open:T,onClose:C,children:[e.jsxs(De,{children:["チーム名",v===-1?"追加":"編集"]}),e.jsx(Pe,{sx:{mt:2},children:e.jsx(we,{label:"チーム名",value:w,onChange:s=>W(s.target.value),fullWidth:!0,margin:"dense"})}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:C,startIcon:e.jsx(Ee,{}),color:"inherit",sx:{color:{xs:"black",md:"inherit"}},children:"キャンセル"}),e.jsx(Y,{onClick:x,disabled:w.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}const Gs=32,Xt=80,Zt=200,Qt=200,es=64,Jl=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function Xl({teams:y,members:f,setMembers:k,selectedTeam:p,setSelectedTeam:_,showSnackbar:R}){const[A,T]=l.useState(null),[O,w]=l.useState(""),[W,v]=l.useState(""),[b,H]=l.useState([]),[E,P]=l.useState(!0),[c,B]=l.useState(!1),$=Ne("md"),z=Ne("sm"),g=Zt+16+(z?0:Xt+Qt+es),{handleTouchEnd:J,setSwiperRef:Q,getSwiperRef:se}=dt(2),[le,ie]=l.useState(""),S=s=>{if(le){const m=se(le);m&&(m.allowTouchMove=!0),ie("")}if(!s.destination||!p)return;const i=Array.from(f[p]||[]),[o]=i.splice(s.source.index,1);i.splice(s.destination.index,0,o),k(m=>({...m,[p]:i}))},de=()=>{T(-1),w(""),v(""),H([]),P(!0),B(!0)},n=s=>{T(s);const i=f[p][s];w(String(i.no)),v(i.name),H(i.positions||[]),P(i.visible!==!1),B(!0)},x=()=>{p&&(A===-1?k(s=>({...s,[p]:[...s[p]||[],{id:Jl(),no:Number(O),name:W,positions:b,visible:E}]})):A!==null&&k(s=>({...s,[p]:s[p].map((i,o)=>o===A?{...i,no:Number(O),name:W,positions:b,visible:E}:i)})),B(!1))},C=()=>{B(!1)},q=s=>{if(!p)return;let i;k(o=>{const m=[...o[p]||[]];i=m[s];const N=m.filter((te,Z)=>Z!==s);return{...o,[p]:N}}),R("メンバーを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{i&&k(o=>{const m=[...o[p]||[]];return m.splice(s,0,i),{...o,[p]:m}})},autoHideDuration:5e3})},a=({m:s,idx:i,dragProvided:o})=>{const m=o.dragHandleProps,{onPointerDown:N,...te}=m||{},Z=ot(X=>{N==null||N(X);const re=se(s.id);re&&(re.allowTouchMove=!1),ie(s.id)});return e.jsx(t,{ref:o.innerRef,...o.draggableProps,style:o.draggableProps.style,children:e.jsxs(lt,{onSwiper:X=>Q(s.id,X),threshold:20,slidesPerView:"auto",style:{overflow:"hidden",width:"100%",minWidth:g},onTouchStart:(X,re)=>re.stopPropagation(),onTouchEnd:X=>J(s.id,X),children:[e.jsx(he,{style:{width:"100%",minWidth:g,flex:"0 0 auto"},children:e.jsxs(t,{...te,...Z,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:le===s.id?"none":"pan-y",width:"100%",minWidth:g},children:[!z&&e.jsx(t,{sx:{width:Xt},children:s.no}),e.jsx(t,{sx:{width:Zt,flexShrink:0,whiteSpace:"nowrap",overflow:"hidden"},children:s.name}),!z&&e.jsx(t,{sx:{width:Qt,whiteSpace:"nowrap",overflow:"hidden"},children:(s.positions||[]).join(", ")}),!z&&e.jsx(t,{sx:{width:es,display:"flex",justifyContent:"center"},children:s.visible===!1?e.jsx(qe,{}):e.jsx(Ge,{})})]})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>n(i),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>q(i),children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto"},children:e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"team-select-label",children:"チーム"}),e.jsx(He,{labelId:"team-select-label",value:p,label:"チーム",onChange:s=>_(s.target.value),children:y.map(s=>e.jsx(ce,{value:s.id,children:s.name},s.id))})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mt:2,mb:1},children:e.jsx(Y,{onClick:de,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})}),e.jsx(Ye,{component:Ve,storageKey:"members-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:S,children:$?e.jsx(_e,{droppableId:"members",children:s=>{var i;return e.jsxs(t,{ref:s.innerRef,...s.droppableProps,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",width:"100%",minWidth:g,...ke},children:[!z&&e.jsx(t,{sx:{width:Xt},children:"番号"}),e.jsx(t,{sx:{width:Zt,flexShrink:0},children:"名前"}),!z&&e.jsx(t,{sx:{width:Qt},children:"ポジション"}),!z&&e.jsx(t,{sx:{width:es,textAlign:"center"},children:"表示"})]}),(i=f[p])==null?void 0:i.map((o,m)=>e.jsx(Re,{draggableId:o.id,index:m,children:N=>e.jsx(a,{m:o,idx:m,dragProvided:N})},o.id)),s.placeholder]})}}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:s=>s.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{}),e.jsx(j,{children:"番号"}),e.jsx(j,{children:"名前"}),!z&&e.jsx(j,{children:"ポジション"}),e.jsx(j,{children:"表示"}),e.jsx(j,{})]})}),e.jsx(_e,{droppableId:"members",children:s=>{var i;return e.jsxs(nt,{ref:s.innerRef,...s.droppableProps,children:[(i=f[p])==null?void 0:i.map((o,m)=>e.jsx(Re,{draggableId:o.id,index:m,children:N=>e.jsxs(Ie,{ref:N.innerRef,...N.draggableProps,"data-index":m,onClick:()=>n(m),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:te=>te.stopPropagation(),...N.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:Gs,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:o.no}),e.jsx(j,{children:o.name}),!z&&e.jsx(j,{children:(o.positions||[]).join(", ")}),e.jsx(j,{children:o.visible===!1?e.jsx(qe,{}):e.jsx(Ge,{})}),e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:te=>te.stopPropagation(),sx:{width:Gs,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:()=>q(m),sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:"error"})})})})]})},o.id)),s.placeholder]})}})]})})})]}),e.jsxs(Je,{open:c,onClose:C,children:[e.jsxs(De,{children:["メンバー",A===-1?"追加":"編集"]}),e.jsxs(Pe,{children:[e.jsx(we,{label:"番号",type:"number",value:O,onChange:s=>w(s.target.value),fullWidth:!0,margin:"dense"}),e.jsx(we,{label:"名前",value:W,onChange:s=>v(s.target.value),fullWidth:!0,margin:"dense"}),e.jsxs($e,{margin:"dense",fullWidth:!0,children:[e.jsx(We,{id:"positions-label",children:"ポジション"}),e.jsxs(He,{labelId:"positions-label",multiple:!0,value:b,label:"ポジション",onChange:s=>H(typeof s.target.value=="string"?s.target.value.split(","):s.target.value),renderValue:s=>s.join(", "),children:[e.jsx(ce,{value:"レフト",children:"レフト"}),e.jsx(ce,{value:"センター",children:"センター"}),e.jsx(ce,{value:"ライト",children:"ライト"}),e.jsx(ce,{value:"セッター",children:"セッター"}),e.jsx(ce,{value:"リベロ",children:"リベロ"})]})]}),e.jsxs(Ae,{value:E?"visible":"hidden",exclusive:!0,onChange:(s,i)=>i&&P(i==="visible"),fullWidth:!0,sx:{display:"flex",mt:1},children:[e.jsxs(ve,{value:"visible",sx:{flex:1,whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(Ge,{sx:{mr:1}}),"表示"]}),e.jsxs(ve,{value:"hidden",sx:{flex:1,whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(qe,{sx:{mr:1}}),"非表示"]})]})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:C,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:x,disabled:O==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}const qs=!1;function Zl({openAddPlayDialog:y,playCategories:f,setPlayCategories:k,openEditPlayDialog:p,scoreInput:_,renderIcon:R,rallyCategoryTags:A,handlePlayDelete:T,openAddDetailDialog:O,playDetails:w,setPlayDetails:W,openEditDetailDialog:v,theme:b,rallyDetailTags:H,handleDetailDelete:E}){const P=n=>{if(se){const q=Q(se);q&&(q.allowTouchMove=!0),le("")}if(!n.destination)return;const x=Array.from(f),[C]=x.splice(n.source.index,1);x.splice(n.destination.index,0,C),k(x)},c=Ot.useMemo(()=>{const n={};return f.forEach(x=>{n[x.id]=[]}),w.forEach((x,C)=>{(n[x.playCategoryId]||(n[x.playCategoryId]=[])).push(C)}),n},[f,w]),B=n=>{if(se){const N=Q(se);N&&(N.allowTouchMove=!0),le("")}const{source:x,destination:C}=n;if(!C||x.droppableId!==C.droppableId)return;const q=x.droppableId,a=q==="play-details"?Object.values(c).flat():c[q.replace("play-details-","")];if(!a)return;const s=a[x.index],i=a[C.index],o=Array.from(w),[m]=o.splice(s,1);o.splice(i,0,m),W(o)},$=Ne("md"),z=Ne("sm"),{handleTouchEnd:g,setSwiperRef:J,getSwiperRef:Q}=dt(2),[se,le]=Ot.useState("");let ie=0;const S=({p:n,idx:x,dragProvided:C})=>{const q=C.dragHandleProps,{onPointerDown:a,...s}=q||{},i=ot(o=>{a==null||a(o);const m=Q(n.id);m&&(m.allowTouchMove=!1),le(n.id)});return e.jsx(t,{ref:C.innerRef,...C.draggableProps,style:C.draggableProps.style,children:e.jsxs(lt,{onSwiper:o=>J(n.id,o),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(o,m)=>m.stopPropagation(),onTouchEnd:o=>g(n.id,o),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{...s,...i,sx:{display:"grid",gridTemplateColumns:z?"1fr":"1fr 1fr 1fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:se===n.id?"none":"pan-y",cursor:"grab"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(je,{label:n.name,size:"small",variant:"outlined",sx:{backgroundColor:"transparent",borderColor:n.color,color:n.color}}),_.showRallyIcons&&e.jsx(t,{children:R(n)})]}),!z&&e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:(n.tags||[]).map(o=>{const m=A.find(te=>te.id===o),N=(m==null?void 0:m.color)||ye;return e.jsx(je,{label:(m==null?void 0:m.name)||o,size:"small",sx:{backgroundColor:N,color:"#fff"}},o)})}),!z&&e.jsx(t,{sx:{display:"flex",alignItems:"center"},children:n.visible===!1?e.jsx(qe,{}):e.jsx(Ge,{})})]})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>p(x),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>T(x),disabled:n.id==="init-serve",children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},de=({d:n,i:x,dragProvided:C})=>{const q=C.dragHandleProps,{onPointerDown:a,...s}=q||{},i=ot(o=>{a==null||a(o);const m=Q(n.id);m&&(m.allowTouchMove=!1),le(n.id)});return e.jsx(t,{ref:C.innerRef,...C.draggableProps,style:C.draggableProps.style,children:e.jsxs(lt,{onSwiper:o=>J(n.id,o),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(o,m)=>m.stopPropagation(),onTouchEnd:o=>g(n.id,o),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{...s,...i,sx:{display:"grid",gridTemplateColumns:z?"1fr":"1fr 1fr 1fr 1fr 0.3fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:se===n.id?"none":"pan-y",cursor:"grab"},children:[e.jsx(t,{children:e.jsx(je,{label:n.name,size:"small",sx:{backgroundColor:n.pointType==="得点"?b.scoreColor:b.lossColor,border:`1px solid ${n.pointType==="得点"?b.scoreColor:b.lossColor}`,color:"#fff"}})}),!z&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:n.pointType}),e.jsx(t,{children:n.pointUnitType}),e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:(n.tags||[]).map(o=>{const m=H.find(te=>te.id===o),N=(m==null?void 0:m.color)||ye;return e.jsx(je,{label:(m==null?void 0:m.name)||o,size:"small",sx:{backgroundColor:N,color:"#fff"}},o)})}),e.jsx(t,{sx:{display:"flex",alignItems:"center"},children:n.visible===!1?e.jsx(qe,{}):e.jsx(Ge,{})})]})]})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>v(x),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>E(x),children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})};return e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(Y,{onClick:y,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})}),e.jsx(Ye,{component:Ve,storageKey:"play-category-grid",sx:{maxWidth:1024,mx:"auto"},children:$?e.jsx(Be,{onDragEnd:P,children:e.jsx(_e,{droppableId:"play-categories",children:n=>e.jsxs(t,{ref:n.innerRef,...n.droppableProps,children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:z?"1fr":"1fr 1fr 1fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:[e.jsx(t,{children:"プレー区分"}),!z&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"ラリー区分タグ"}),e.jsx(t,{children:"表示"})]})]}),f.map((x,C)=>e.jsx(Re,{draggableId:x.id,index:C,children:q=>e.jsx(S,{p:x,idx:C,dragProvided:q})},x.id)),n.placeholder]})})}):e.jsxs(tt,{size:"small",sx:{minWidth:600},children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:n=>n.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{sx:{width:48}}),e.jsx(j,{children:"プレー区分"}),qs,_.showRallyIcons&&e.jsx(j,{children:"アイコン"}),e.jsx(j,{children:"タグ"}),e.jsx(j,{children:"表示"}),e.jsx(j,{})]})}),e.jsx(Be,{onDragEnd:P,children:e.jsx(_e,{droppableId:"play-categories",children:n=>e.jsxs(nt,{ref:n.innerRef,...n.droppableProps,children:[f.map((x,C)=>e.jsx(Re,{draggableId:x.id,index:C,children:q=>e.jsxs(Ie,{ref:q.innerRef,...q.draggableProps,"data-index":C,onClick:()=>p(C),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",sx:{width:48},children:e.jsx(t,{onClick:a=>a.stopPropagation(),...q.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:e.jsx(je,{label:x.name,size:"small",variant:"outlined",sx:{backgroundColor:"transparent",borderColor:x.color,color:x.color}})}),qs,_.showRallyIcons&&e.jsx(j,{children:R(x)}),e.jsx(j,{children:(x.tags||[]).map(a=>{const s=A.find(o=>o.id===a),i=(s==null?void 0:s.color)||ye;return e.jsx(je,{label:(s==null?void 0:s.name)||a,size:"small",sx:{mr:.5,mb:.5,backgroundColor:i,color:"#fff"}},a)})}),e.jsx(j,{children:x.visible===!1?e.jsx(qe,{}):e.jsx(Ge,{})}),e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:a=>a.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:x.id==="init-serve"?void 0:()=>T(C),disabled:x.id==="init-serve",sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:x.id==="init-serve"?"disabled":"error"})})})})]})},x.id)),n.placeholder]})})})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1,mt:2},children:e.jsx(Y,{onClick:O,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})}),e.jsx(Ye,{component:Ve,storageKey:"play-detail-grid",sx:{maxWidth:1024,mx:"auto"},children:$?e.jsx(Be,{onDragEnd:B,children:e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:z?"1fr":"1fr 1fr 1fr 1fr 0.3fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:[e.jsx(t,{children:"プレー詳細"}),!z&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"得点区分"}),e.jsx(t,{children:"得失点単位区分"}),e.jsx(t,{children:"タグ"}),e.jsx(t,{children:"表示"})]})]}),f.map(n=>{const x=w.map((C,q)=>({d:C,i:q})).filter(({d:C})=>C.playCategoryId===n.id);return e.jsxs(Ot.Fragment,{children:[e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",px:1,borderBottom:1,borderColor:"divider",...ke},children:n.name}),e.jsx(_e,{droppableId:`play-details-${n.id}`,children:C=>e.jsxs(t,{ref:C.innerRef,...C.droppableProps,children:[x.map(({d:q,i:a},s)=>e.jsx(Re,{draggableId:q.id,index:s,children:i=>e.jsx(de,{d:q,i:a,dragProvided:i})},q.id)),C.placeholder]})})]},n.id)})]})}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:n=>n.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{}),e.jsx(j,{children:"プレー詳細"}),e.jsx(j,{children:"得点区分"}),e.jsx(j,{children:"得失点単位区分"}),e.jsx(j,{children:"タグ"}),e.jsx(j,{children:"表示"}),e.jsx(j,{})]})}),e.jsx(Be,{onDragEnd:B,children:e.jsx(_e,{droppableId:"play-details",children:n=>e.jsxs(nt,{ref:n.innerRef,...n.droppableProps,children:[f.map(x=>e.jsxs(Ot.Fragment,{children:[e.jsx(Ie,{sx:{backgroundColor:C=>C.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:e.jsx(j,{colSpan:7,children:x.name})}),w.map((C,q)=>({d:C,i:q})).filter(({d:C})=>C.playCategoryId===x.id).map(({d:C,i:q})=>{const a=ie++;return e.jsx(Re,{draggableId:C.id,index:a,children:s=>e.jsxs(Ie,{ref:s.innerRef,...s.draggableProps,"data-index":q,onClick:()=>v(q),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:i=>i.stopPropagation(),...s.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:e.jsx(je,{label:C.name,size:"small",sx:{backgroundColor:C.pointType==="得点"?b.scoreColor:b.lossColor,border:`1px solid ${C.pointType==="得点"?b.scoreColor:b.lossColor}`,color:"#fff"}})}),e.jsx(j,{children:C.pointType}),e.jsx(j,{children:C.pointUnitType}),e.jsx(j,{children:(C.tags||[]).map(i=>{const o=H.find(N=>N.id===i),m=(o==null?void 0:o.color)||ye;return e.jsx(je,{label:(o==null?void 0:o.name)||i,size:"small",sx:{mr:.5,mb:.5,backgroundColor:m,color:"#fff"}},i)})}),e.jsx(j,{children:C.visible===!1?e.jsx(qe,{}):e.jsx(Ge,{})}),e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:i=>i.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:()=>E(q),sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:"error"})})})})]})},C.id)})]},x.id)),n.placeholder]})})})]})})]})}var vs={},Ql=ge;Object.defineProperty(vs,"__esModule",{value:!0});var ns=vs.default=void 0,er=Ql(fe()),tr=e;ns=vs.default=(0,er.default)((0,tr.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy");function sr({open:y,playCategories:f,playDetails:k,initial:p,onSave:_,onClose:R}){const[A,T]=l.useState(""),[O,w]=l.useState(""),[W,v]=l.useState(""),[b,H]=l.useState(""),E=Ne("md"),P=l.useMemo(()=>k.find(S=>S.id===O),[k,O]),c=(P==null?void 0:P.pointType)==="得点"?"失点":P?"得点":void 0;l.useEffect(()=>{if(p){const S=k.find(n=>n.id===p.sourceDetailId),de=k.find(n=>n.id===p.targetDetailId);T((S==null?void 0:S.playCategoryId)||""),w(p.sourceDetailId),v((de==null?void 0:de.playCategoryId)||""),H(p.targetDetailId)}else T(""),w(""),v(""),H("")},[p,k]);const B=()=>{_({enabled:(p==null?void 0:p.enabled)??!0,sourceDetailId:O,targetDetailId:b})},$=l.useMemo(()=>k.filter(S=>S.playCategoryId===A&&S.visible!==!1),[k,A]),z=l.useMemo(()=>{const S=f.filter(de=>de.visible!==!1);return c?S.filter(de=>k.some(n=>n.playCategoryId===de.id&&n.visible!==!1&&n.pointType===c)):S},[f,k,c]),g=l.useMemo(()=>k.filter(S=>S.playCategoryId===W&&S.visible!==!1&&(!c||S.pointType===c)),[k,W,c]);l.useEffect(()=>{W&&!z.some(S=>S.id===W)&&(v(""),H(""))},[z,W]),l.useEffect(()=>{b&&!g.some(S=>S.id===b)&&H("")},[g,b]);const J=!O||!b,Q=e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"source-cat",children:"入力プレー区分"}),e.jsx(He,{labelId:"source-cat",value:A,label:"入力プレー区分",onChange:S=>{T(S.target.value),w("")},children:f.filter(S=>S.visible!==!1).map(S=>e.jsx(ce,{value:S.id,children:S.name},S.id))})]}),se=e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"source-detail",children:"入力プレー詳細"}),e.jsx(He,{labelId:"source-detail",value:O,label:"入力プレー詳細",onChange:S=>w(S.target.value),children:$.map(S=>e.jsx(ce,{value:S.id,children:S.name},S.id))})]}),le=e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"target-cat",children:"相手プレー区分"}),e.jsx(He,{labelId:"target-cat",value:W,label:"相手プレー区分",onChange:S=>{v(S.target.value),H("")},children:z.map(S=>e.jsx(ce,{value:S.id,children:S.name},S.id))})]}),ie=e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"target-detail",children:"相手プレー詳細"}),e.jsx(He,{labelId:"target-detail",value:b,label:"相手プレー詳細",onChange:S=>H(S.target.value),children:g.map(S=>e.jsx(ce,{value:S.id,children:S.name},S.id))})]});return e.jsxs(Je,{open:y,onClose:R,children:[e.jsxs(De,{children:["組み合わせ",p?"編集":"追加"]}),e.jsx(Pe,{sx:{display:"flex",flexDirection:"column",gap:2},children:E?e.jsxs(e.Fragment,{children:[Q,se,e.jsx(Kn,{}),le,ie]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{display:"flex",gap:2},children:[Q,le]}),e.jsxs(t,{sx:{display:"flex",gap:2},children:[se,ie]})]})}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:R,color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:()=>{B(),R()},disabled:J,children:"保存"})]})]})}function gn({enabled:y,label:f,onToggle:k,onAdd:p,actions:_}){return e.jsxs(t,{sx:{display:"flex",flexDirection:"row",gap:.5,mb:1,maxWidth:1024,justifyContent:"space-between",margin:"auto"},children:[e.jsxs(t,{children:[e.jsx(It,{checked:y,onChange:R=>k(R.target.checked)}),f]}),e.jsxs(t,{sx:{display:"flex",gap:.5},children:[_,p&&e.jsx(Y,{onClick:p,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})]})]})}function nr({playCombinationSetting:y,onChange:f,playCategories:k,playDetails:p,showSnackbar:_}){const[R,A]=l.useState([...y.pairs]),[T,O]=l.useState(y.enabled),[w,W]=l.useState(!1),[v,b]=l.useState(null),H=Qs(),E=Ne("md"),{handleTouchEnd:P,setSwiperRef:c,getSwiperRef:B}=dt(3),[$,z]=l.useState(""),g=(a,s=T)=>{O(s),typeof a=="function"?A(i=>{const o=a(i);return f({enabled:s,pairs:o}),o}):(A(a),f({enabled:s,pairs:a}))},J=a=>{if($){const o=B($);o&&(o.allowTouchMove=!0),z("")}if(!a.destination)return;const s=Array.from(R),[i]=s.splice(a.source.index,1);s.splice(a.destination.index,0,i),g(s)},Q=a=>{g([...R,a])},se=(a,s)=>{const i=[...R];i[a]=s,g(i)},le=a=>{const s=R[a];g(R.filter((i,o)=>o!==a)),_("組み合わせを削除しました","success",{actionLabel:"元に戻す",onAction:()=>g(i=>{const o=[...i];return o.splice(a,0,s),o}),autoHideDuration:5e3})},ie=a=>{g([...R,{...R[a]}])},S=({p:a,idx:s,sDetail:i,tDetail:o,prov:m})=>{var N,te,Z,X;return e.jsxs(t,{ref:m.innerRef,...m.draggableProps,onClick:()=>{b(s),W(!0)},sx:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",alignItems:"center",p:1,borderBottom:1,borderColor:"divider",cursor:"pointer"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,minWidth:0},children:[e.jsx(t,{...m.dragHandleProps,sx:{display:"flex",alignItems:"center"},children:e.jsx(rt,{})}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ct,{label:C((i==null?void 0:i.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(N=x((i==null?void 0:i.playCategoryId)||""))==null?void 0:N.color,borderColor:(te=x((i==null?void 0:i.playCategoryId)||""))==null?void 0:te.color}}),e.jsx(ct,{label:(i==null?void 0:i.name)||"",sx:{bgcolor:q(i),color:"common.white"}})]})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ct,{label:C((o==null?void 0:o.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(Z=x((o==null?void 0:o.playCategoryId)||""))==null?void 0:Z.color,borderColor:(X=x((o==null?void 0:o.playCategoryId)||""))==null?void 0:X.color}}),e.jsx(ct,{label:(o==null?void 0:o.name)||"",sx:{bgcolor:q(o),color:"common.white"}})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"flex-start",justifySelf:"flex-start",width:1,minWidth:0},children:[e.jsx(It,{sx:{ml:0},checked:a.enabled,onChange:re=>{const Ce=[...R];Ce[s]={...a,enabled:re.target.checked},g(Ce)}}),e.jsx(oe,{size:"small",sx:{ml:"auto"},onClick:re=>{re.stopPropagation(),ie(s)},children:e.jsx(ns,{fontSize:"small"})}),e.jsx(oe,{size:"small",onClick:re=>{re.stopPropagation(),le(s)},children:e.jsx(Se,{fontSize:"small",color:"error"})})]})]})},de=({p:a,idx:s,sDetail:i,tDetail:o,prov:m})=>{var D,K,U,G;const N=String(s),te=l.useRef(null),[Z,X]=l.useState(0);l.useLayoutEffect(()=>{var ne;const ae=((ne=te.current)==null?void 0:ne.offsetHeight)??0;ae&&ae!==Z&&X(ae)},[i,o,Z]);const re=m.dragHandleProps,{onPointerDown:Ce,...r}=re||{},u=ot(ae=>{Ce==null||Ce(ae);const ne=B(N);ne&&(ne.allowTouchMove=!1),z(N)});return e.jsx(t,{ref:m.innerRef,...m.draggableProps,children:e.jsxs(lt,{onSwiper:ae=>c(N,ae),threshold:20,slidesPerView:"auto",style:{overflow:"hidden",height:Z||void 0},onTouchStart:(ae,ne)=>ne.stopPropagation(),onTouchEnd:ae=>P(N,ae),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{ref:te,...r,...u,sx:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",alignItems:"center",p:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:$===N?"none":"pan-y",cursor:"grab"},children:[e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ct,{label:C((i==null?void 0:i.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(D=x((i==null?void 0:i.playCategoryId)||""))==null?void 0:D.color,borderColor:(K=x((i==null?void 0:i.playCategoryId)||""))==null?void 0:K.color}}),e.jsx(ct,{label:(i==null?void 0:i.name)||"",sx:{bgcolor:q(i),color:"common.white"}})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ct,{label:C((o==null?void 0:o.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(U=x((o==null?void 0:o.playCategoryId)||""))==null?void 0:U.color,borderColor:(G=x((o==null?void 0:o.playCategoryId)||""))==null?void 0:G.color}}),e.jsx(ct,{label:(o==null?void 0:o.name)||"",sx:{bgcolor:q(o),color:"common.white"}})]}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-start",justifySelf:"flex-start",width:1,minWidth:0},children:e.jsx(It,{sx:{ml:0},checked:a.enabled,onChange:ae=>{const ne=[...R];ne[s]={...a,enabled:ae.target.checked},g(ne)}})})]})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto",height:Z||void 0},children:e.jsx(t,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>{b(s),W(!0)},children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto",height:Z||void 0},children:e.jsx(t,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"secondary.main"},children:e.jsx(oe,{size:"small",onClick:()=>{ie(s)},children:e.jsx(ns,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto",height:Z||void 0},children:e.jsx(t,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>{le(s)},children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},n=a=>p.find(s=>s.id===a),x=a=>k.find(s=>s.id===a),C=a=>{var s;return((s=x(a))==null?void 0:s.name)||""},q=a=>(a==null?void 0:a.pointType)==="得点"?H.palette.success.main:(a==null?void 0:a.pointType)==="失点"?H.palette.error.main:void 0;return e.jsxs(t,{children:[e.jsx(gn,{enabled:T,label:"自動入力",onToggle:a=>g(R,a),actions:e.jsx(Y,{onClick:()=>{b(null),W(!0)},variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})}),e.jsx(Ye,{component:Ve,storageKey:"play-combination-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:J,children:e.jsx(_e,{droppableId:"pairs",children:a=>e.jsxs(t,{ref:a.innerRef,...a.droppableProps,children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",borderTopLeftRadius:s=>s.shape.borderRadius,borderTopRightRadius:s=>s.shape.borderRadius,...ke},children:[e.jsx(t,{sx:{minWidth:0,pl:E?0:4},children:"入力"}),e.jsx(t,{sx:{minWidth:0},children:"相手"}),e.jsx(t,{sx:{minWidth:0},children:"自動入力"})]}),R.map((s,i)=>{const o=n(s.sourceDetailId),m=n(s.targetDetailId);return e.jsx(Re,{draggableId:`pc-${i}`,index:i,children:N=>E?e.jsx(de,{p:s,idx:i,sDetail:o,tDetail:m,prov:N}):e.jsx(S,{p:s,idx:i,sDetail:o,tDetail:m,prov:N})},i)}),a.placeholder]})})})}),e.jsx(et,{severity:"info",sx:{mt:2,maxWidth:1024,mx:"auto"},children:"「相手プレー自動入力」機能を有効にすると、片方のチームでプレー詳細を選択した際に、ここで有効化した組み合わせに従って相手側のプレーが自動入力されます。"}),e.jsx(sr,{open:w,playCategories:k,playDetails:p,initial:v!==null?R[v]:void 0,onSave:a=>{v===null?Q(a):se(v,a)},onClose:()=>W(!1)})]})}var Cs={},lr=ge;Object.defineProperty(Cs,"__esModule",{value:!0});var fn=Cs.default=void 0,rr=lr(fe()),or=e;fn=Cs.default=(0,rr.default)((0,or.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");var Is={},ir=ge;Object.defineProperty(Is,"__esModule",{value:!0});var mn=Is.default=void 0,ar=ir(fe()),cr=e;mn=Is.default=(0,ar.default)((0,cr.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.89-2-2-2m0 16H5V7h14zm-5.5-6c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5 1.5.67 1.5 1.5M12 9c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Preview");function dr({sourceCategoryId:y,rules:f,playCategories:k,onChange:p}){const _=k.filter(O=>O.visible!==!1),R=O=>f.find(w=>w.sourceCategoryId===y&&!w.sourceDetailId&&w.targetCategoryId===O&&w.targetDetailIds.length===0),A=O=>{const w=R(O);return!w||w.allow},T=O=>{const w=R(O);if(w){const W=f.filter(v=>v!==w);p(W)}else{const W=[...f,{enabled:!0,sourceCategoryId:y,targetCategoryId:O,targetDetailIds:[],allow:!1}];p(W)}};return e.jsx(t,{sx:{maxWidth:1024,mx:"auto",width:"100%"},children:e.jsx(Ve,{variant:"outlined",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(en,{disablePadding:!0,children:_.map((O,w)=>e.jsxs(tn,{onClick:()=>T(O.id),divider:w!==_.length-1,children:[e.jsx(sn,{primary:O.name}),A(O.id)?e.jsx(ze,{color:"success"}):e.jsx(Ee,{color:"error"})]},O.id))})})})}var ws={},xr=ge;Object.defineProperty(ws,"__esModule",{value:!0});var jn=ws.default=void 0,hr=xr(fe()),ur=e;jn=ws.default=(0,hr.default)((0,ur.jsx)("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8m-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91"}),"RestartAlt");function pr({open:y,onClose:f,playCategories:k,playDetails:p,opponentPlayInputControlSetting:_,playCombinationSetting:R,themeSetting:A}){const{autoSourceIds:T,getAllowedCategories:O,getAutoInput:w}=rl({playCategories:k,playDetails:p,opponentPlayInputControlSetting:_,playCombinationSetting:R}),W=Ne("sm"),v=l.useMemo(()=>new Map(p.map(n=>[n.id,n])),[p]),[b,H]=l.useState(""),[E,P]=l.useState(""),[c,B]=l.useState(""),[$,z]=l.useState(""),[g,J]=l.useState(""),Q=l.useMemo(()=>O(c),[c,O]),se=l.useMemo(()=>O($),[$,O]);l.useEffect(()=>{E&&!Q.some(n=>n.id===E)&&(P(""),z(""))},[Q,E]),l.useEffect(()=>{b&&!se.some(n=>n.id===b)&&(H(""),B(""))},[se,b]),l.useEffect(()=>{if(J(""),!c||$)return;const{detail:n,blocked:x}=w(c);n&&(x?J("自動入力が制限により反映されません"):(P(n.playCategoryId),z(n.id)))},[c]),l.useEffect(()=>{if(J(""),!$||c)return;const{detail:n,blocked:x}=w($);n&&(x?J("自動入力が制限により反映されません"):(H(n.playCategoryId),B(n.id)))},[$]);const le=l.useMemo(()=>{const n=v.get($),x=n?n.pointType==="得点"?"失点":"得点":null;return p.filter(C=>C.playCategoryId===b&&C.visible!==!1&&(!x||C.pointType===x))},[b,p,$,v]),ie=l.useMemo(()=>{const n=v.get(c),x=n?n.pointType==="得点"?"失点":"得点":null;return p.filter(C=>C.playCategoryId===E&&C.visible!==!1&&(!x||C.pointType===x))},[E,p,c,v]);l.useEffect(()=>{c&&!le.some(n=>n.id===c)&&B("")},[le,c]),l.useEffect(()=>{$&&!ie.some(n=>n.id===$)&&z("")},[ie,$]);const S=()=>{H(""),P(""),B(""),z(""),J("")},de=()=>{S(),f()};return e.jsxs(Je,{open:y,onClose:de,fullWidth:!0,children:[e.jsx(De,{children:"プレビュー"}),e.jsx(Pe,{dividers:!0,children:W?e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(t,{sx:{flex:1,display:"flex",flexDirection:"column",gap:1},children:[e.jsx(t,{sx:{typography:"subtitle1"},children:"チームA"}),e.jsxs(t,{sx:{display:"flex",gap:1,mt:1},children:[e.jsx(t,{sx:{flex:1,position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:b,onChange:(n,x)=>{H(x),B("")},sx:{width:"100%"},children:se.map(n=>e.jsx(ve,{value:n.id,size:"small",children:n.name},n.id))})}),e.jsx(t,{sx:{flex:1,position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:c,onChange:(n,x)=>B(x),sx:{width:"100%"},children:le.map(n=>{const x=n.pointType==="得点"?A.scoreColor:A.lossColor;return e.jsx(ve,{value:n.id,size:"small",sx:{color:x,"&.Mui-selected":{color:x}},children:T.has(n.id)?`${n.name}*`:n.name},n.id)})})})]})]}),e.jsxs(t,{sx:{flex:1,display:"flex",flexDirection:"column",gap:1},children:[e.jsx(t,{sx:{typography:"subtitle1"},children:"チームB"}),e.jsxs(t,{sx:{display:"flex",gap:1,mt:1},children:[e.jsx(t,{sx:{flex:1,position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:E,onChange:(n,x)=>{P(x),z("")},sx:{width:"100%"},children:Q.map(n=>e.jsx(ve,{value:n.id,size:"small",children:n.name},n.id))})}),e.jsx(t,{sx:{flex:1,position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:$,onChange:(n,x)=>z(x),sx:{width:"100%"},children:ie.map(n=>{const x=n.pointType==="得点"?A.scoreColor:A.lossColor;return e.jsx(ve,{value:n.id,size:"small",sx:{color:x,"&.Mui-selected":{color:x}},children:T.has(n.id)?`${n.name}*`:n.name},n.id)})})})]})]}),g&&e.jsx(et,{severity:"warning",children:g})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{display:"flex",px:1},children:[e.jsx(t,{sx:{flex:"1 1 50%",textAlign:"center",typography:"subtitle1"},children:"チームA"}),e.jsx(t,{sx:{flex:"1 1 50%",textAlign:"center",typography:"subtitle1"},children:"チームB"})]}),e.jsxs(t,{sx:{display:"flex",gap:2,mt:1},children:[e.jsx(t,{sx:{flex:"1 1 25%",position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:b,onChange:(n,x)=>{H(x),B("")},sx:{width:"100%"},children:se.map(n=>e.jsx(ve,{value:n.id,size:"small",children:n.name},n.id))})}),e.jsx(t,{sx:{flex:"1 1 25%",position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:c,onChange:(n,x)=>B(x),sx:{width:"100%"},children:le.map(n=>{const x=n.pointType==="得点"?A.scoreColor:A.lossColor;return e.jsx(ve,{value:n.id,size:"small",sx:{color:x,"&.Mui-selected":{color:x}},children:T.has(n.id)?`${n.name}*`:n.name},n.id)})})}),e.jsx(t,{sx:{flex:"1 1 25%",position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:E,onChange:(n,x)=>{P(x),z("")},sx:{width:"100%"},children:Q.map(n=>e.jsx(ve,{value:n.id,size:"small",children:n.name},n.id))})}),e.jsx(t,{sx:{flex:"1 1 25%",position:"relative",borderRadius:1},children:e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:$,onChange:(n,x)=>z(x),sx:{width:"100%"},children:ie.map(n=>{const x=n.pointType==="得点"?A.scoreColor:A.lossColor;return e.jsx(ve,{value:n.id,size:"small",sx:{color:x,"&.Mui-selected":{color:x}},children:T.has(n.id)?`${n.name}*`:n.name},n.id)})})})]}),g&&e.jsx(et,{severity:"warning",sx:{mt:2},children:g})]})}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:S,startIcon:e.jsx(jn,{}),children:"リセット"}),e.jsx(Y,{onClick:de,startIcon:e.jsx(Ee,{}),children:"閉じる"})]})]})}function gr({opponentPlayInputControlSetting:y,onChange:f,playCategories:k,playDetails:p,playCombinationSetting:_,setAppBarLeftAction:R,themeSetting:A}){const[T,O]=l.useState(y.enabled),[w,W]=l.useState([...y.rules]),[v,b]=l.useState(null),[H,E]=l.useState(!1),P=nn(),c=($,z=T)=>{O(z),W($),f({enabled:z,rules:$})},B=k.filter($=>$.visible!==!1);return l.useEffect(()=>{if(R)return R(v?e.jsx(oe,{onClick:()=>b(null),size:"small",children:e.jsx(Mt,{})}):e.jsx(oe,{onClick:()=>P("/settings"),size:"small",children:e.jsx(Mt,{})})),()=>R(null)},[v,R,P]),v?e.jsx(dr,{sourceCategoryId:v,rules:w,playCategories:k,onChange:$=>c($)}):e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",width:"100%"},children:[e.jsx(gn,{enabled:T,label:"機能を有効にする",onToggle:$=>c(w,$),actions:e.jsx(Y,{sx:{mb:1},onClick:()=>E(!0),variant:"outlined",startIcon:e.jsx(mn,{}),children:"プレビュー"})}),e.jsx(Ve,{variant:"outlined",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(en,{disablePadding:!0,children:B.map(($,z)=>{const g=w.some(J=>J.enabled&&J.sourceCategoryId===$.id&&!J.allow);return e.jsxs(tn,{onClick:()=>b($.id),divider:z!==B.length-1,children:[e.jsx(sn,{primary:$.name}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",color:J=>J.palette.text.secondary},children:[e.jsx(t,{component:"span",sx:{mr:1,typography:"body2"},children:g?"一部不可":"全て可"}),e.jsx(fn,{})]})]},$.id)})})}),e.jsxs(et,{severity:"info",sx:{mt:1},children:["選択したプレー区分で相手プレーの入力可否を設定できます。",e.jsx("br",{}),"制限を設けることで誤入力を防ぎ、試合進行をスムーズにします。"]}),e.jsx(pr,{open:H,onClose:()=>E(!1),playCategories:k,playDetails:p,opponentPlayInputControlSetting:{enabled:T,rules:w},playCombinationSetting:_,themeSetting:A})]})}const Ks=!1,Ys=!1,Js=!1;function fr({tags:y,setTags:f,rallyCategoryTags:k,setRallyCategoryTags:p,rallyDetailTags:_,setRallyDetailTags:R,setMatches:A,setPlayCategories:T,setPlayDetails:O,showSnackbar:w}){const[W,v]=l.useState(null),[b,H]=l.useState(""),[E,P]=l.useState(ye),[c,B]=l.useState(!1),[$,z]=l.useState(null),[g,J]=l.useState(""),[Q,se]=l.useState(ye),[le,ie]=l.useState(!1),[S,de]=l.useState(null),[n,x]=l.useState(""),[C,q]=l.useState(ye),[a,s]=l.useState(!1),i=Ne("md"),{handleTouchEnd:o,setSwiperRef:m,getSwiperRef:N}=dt(2),{handleTouchEnd:te,setSwiperRef:Z,getSwiperRef:X}=dt(2),{handleTouchEnd:re,setSwiperRef:Ce,getSwiperRef:r}=dt(2),[u,D]=l.useState(""),[K,U]=l.useState(""),[G,ae]=l.useState(""),ne=h=>{if(u){const F=N(u);F&&(F.allowTouchMove=!0),D("")}if(!h.destination)return;const I=Array.from(y),[V]=I.splice(h.source.index,1);I.splice(h.destination.index,0,V),f(I)},xe=h=>{if(K){const F=X(K);F&&(F.allowTouchMove=!0),U("")}if(!h.destination)return;const I=Array.from(k),[V]=I.splice(h.source.index,1);I.splice(h.destination.index,0,V),p(I)},Xe=h=>{if(G){const F=r(G);F&&(F.allowTouchMove=!0),ae("")}if(!h.destination)return;const I=Array.from(_),[V]=I.splice(h.source.index,1);I.splice(h.destination.index,0,V),R(I)},ft=()=>{v(-1),H(""),P(ye),B(!0)},wt=h=>{v(h),H(y[h].name),P(y[h].color),B(!0)},ht=()=>{W===-1?f(h=>[...h,{id:crypto.randomUUID(),name:b,color:E}]):W!==null&&f(h=>h.map((I,V)=>V===W?{...I,name:b,color:E}:I)),B(!1)},ut=()=>{B(!1)},mt=h=>{const I=y[h];let V=[];f(F=>F.filter((L,ue)=>ue!==h)),A(F=>(V=F.map(L=>({...L,tags:[...L.tags]})),F.map(L=>({...L,tags:L.tags.filter(ue=>ue!==I.id)})))),w("試合タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{f(F=>{const L=[...F];return L.splice(h,0,I),L}),A(()=>V)},autoHideDuration:5e3})},Et=()=>{z(-1),J(""),se(ye),ie(!0)},pt=h=>{z(h),J(k[h].name),se(k[h].color),ie(!0)},Le=()=>{$===-1?p(h=>[...h,{id:crypto.randomUUID(),name:g,color:Q}]):$!==null&&p(h=>h.map((I,V)=>V===$?{...I,name:g,color:Q}:I)),ie(!1)},Ue=()=>{ie(!1)},at=h=>{const I=k[h];let V=[];p(F=>F.filter((L,ue)=>ue!==h)),T(F=>(V=F.map(L=>({...L,tags:[...L.tags||[]]})),F.map(L=>({...L,tags:(L.tags||[]).filter(ue=>ue!==I.id)})))),w("プレー区分タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{p(F=>{const L=[...F];return L.splice(h,0,I),L}),T(()=>V)},autoHideDuration:5e3})},zt=()=>{de(-1),x(""),q(ye),s(!0)},Ze=h=>{de(h),x(_[h].name),q(_[h].color),s(!0)},$t=()=>{S===-1?R(h=>[...h,{id:crypto.randomUUID(),name:n,color:C}]):S!==null&&R(h=>h.map((I,V)=>V===S?{...I,name:n,color:C}:I)),s(!1)},Fe=()=>{s(!1)},St=h=>{const I=_[h];let V=[];R(F=>F.filter((L,ue)=>ue!==h)),O(F=>(V=F.map(L=>({...L,tags:[...L.tags||[]]})),F.map(L=>({...L,tags:(L.tags||[]).filter(ue=>ue!==I.id)})))),w("プレー詳細タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{R(F=>{const L=[...F];return L.splice(h,0,I),L}),O(()=>V)},autoHideDuration:5e3})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"試合タグ"}),e.jsx(Y,{onClick:ft,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})]}),e.jsx(Ye,{component:Ve,storageKey:"match-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:ne,children:i?e.jsx(_e,{droppableId:"match-tags",children:h=>e.jsxs(t,{ref:h.innerRef,...h.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})}),y.map((I,V)=>e.jsx(Re,{draggableId:I.id,index:V,children:F=>{const L=F.dragHandleProps,{onPointerDown:ue,...Qe}=L||{},xt=ot(pe=>{ue==null||ue(pe);const Oe=N(I.id);Oe&&(Oe.allowTouchMove=!1),D(I.id)});return e.jsx(t,{ref:F.innerRef,...F.draggableProps,style:F.draggableProps.style,children:e.jsxs(lt,{onSwiper:pe=>m(I.id,pe),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(pe,Oe)=>Oe.stopPropagation(),onTouchEnd:pe=>o(I.id,pe),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...Qe,...xt,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:u===I.id?"none":"pan-y"},children:e.jsx(t,{sx:{flexGrow:1},children:e.jsx(je,{label:I.name,size:"small",sx:{backgroundColor:I.color,border:`1px solid ${I.color}`,color:"#fff"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>wt(V),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>mt(V),children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})}},I.id)),h.placeholder]})}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:h=>h.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{}),e.jsx(j,{children:"タグ名称"}),Ks,e.jsx(j,{})]})}),e.jsx(_e,{droppableId:"match-tags",children:h=>e.jsxs(nt,{ref:h.innerRef,...h.droppableProps,children:[y.map((I,V)=>e.jsx(Re,{draggableId:I.id,index:V,children:F=>e.jsxs(Ie,{ref:F.innerRef,...F.draggableProps,"data-index":V,onClick:()=>wt(V),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:L=>L.stopPropagation(),...F.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:e.jsx(je,{label:I.name,size:"small",sx:{backgroundColor:I.color,border:`1px solid ${I.color}`,color:"#fff"}})}),Ks,e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:L=>L.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:()=>mt(V),sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:"error"})})})})]})},I.id)),h.placeholder]})})]})})}),e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,mt:2},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"プレー区分タグ"}),e.jsx(Y,{onClick:Et,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})]}),e.jsx(Ye,{component:Ve,storageKey:"play-category-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:xe,children:i?e.jsx(_e,{droppableId:"rally-category-tags",children:h=>e.jsxs(t,{ref:h.innerRef,...h.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})}),k.map((I,V)=>e.jsx(Re,{draggableId:I.id,index:V,children:F=>{const L=F.dragHandleProps,{onPointerDown:ue,...Qe}=L||{},xt=ot(pe=>{ue==null||ue(pe);const Oe=X(I.id);Oe&&(Oe.allowTouchMove=!1),U(I.id)});return e.jsx(t,{ref:F.innerRef,...F.draggableProps,style:F.draggableProps.style,children:e.jsxs(lt,{onSwiper:pe=>Z(I.id,pe),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(pe,Oe)=>Oe.stopPropagation(),onTouchEnd:pe=>te(I.id,pe),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...Qe,...xt,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:K===I.id?"none":"pan-y"},children:e.jsx(t,{sx:{flexGrow:1},children:e.jsx(je,{label:I.name,size:"small",sx:{backgroundColor:I.color,border:`1px solid ${I.color}`,color:"#fff"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>pt(V),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>at(V),children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})}},I.id)),h.placeholder]})}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:h=>h.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{}),e.jsx(j,{children:"タグ名称"}),Ys,e.jsx(j,{})]})}),e.jsx(_e,{droppableId:"rally-category-tags",children:h=>e.jsxs(nt,{ref:h.innerRef,...h.droppableProps,children:[k.map((I,V)=>e.jsx(Re,{draggableId:I.id,index:V,children:F=>e.jsxs(Ie,{ref:F.innerRef,...F.draggableProps,"data-index":V,onClick:()=>pt(V),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:L=>L.stopPropagation(),...F.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:e.jsx(je,{label:I.name,size:"small",sx:{backgroundColor:I.color,border:`1px solid ${I.color}`,color:"#fff"}})}),Ys,e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:L=>L.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:()=>at(V),sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:"error"})})})})]})},I.id)),h.placeholder]})})]})})}),e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,mt:2},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"プレー詳細タグ"}),e.jsx(Y,{onClick:zt,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})]}),e.jsx(Ye,{component:Ve,storageKey:"play-detail-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:Xe,children:i?e.jsx(_e,{droppableId:"rally-detail-tags",children:h=>e.jsxs(t,{ref:h.innerRef,...h.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})}),_.map((I,V)=>e.jsx(Re,{draggableId:I.id,index:V,children:F=>{const L=F.dragHandleProps,{onPointerDown:ue,...Qe}=L||{},xt=ot(pe=>{ue==null||ue(pe);const Oe=r(I.id);Oe&&(Oe.allowTouchMove=!1),ae(I.id)});return e.jsx(t,{ref:F.innerRef,...F.draggableProps,style:F.draggableProps.style,children:e.jsxs(lt,{onSwiper:pe=>Ce(I.id,pe),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(pe,Oe)=>Oe.stopPropagation(),onTouchEnd:pe=>re(I.id,pe),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...Qe,...xt,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:G===I.id?"none":"pan-y"},children:e.jsx(t,{sx:{flexGrow:1},children:e.jsx(je,{label:I.name,size:"small",sx:{backgroundColor:I.color,border:`1px solid ${I.color}`,color:"#fff"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>Ze(V),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>St(V),children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})}},I.id)),h.placeholder]})}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:h=>h.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{}),e.jsx(j,{children:"タグ名称"}),Js,e.jsx(j,{})]})}),e.jsx(_e,{droppableId:"rally-detail-tags",children:h=>e.jsxs(nt,{ref:h.innerRef,...h.droppableProps,children:[_.map((I,V)=>e.jsx(Re,{draggableId:I.id,index:V,children:F=>e.jsxs(Ie,{ref:F.innerRef,...F.draggableProps,"data-index":V,onClick:()=>Ze(V),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:L=>L.stopPropagation(),...F.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:e.jsx(je,{label:I.name,size:"small",sx:{backgroundColor:I.color,border:`1px solid ${I.color}`,color:"#fff"}})}),Js,e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:L=>L.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:()=>St(V),sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:"error"})})})})]})},I.id)),h.placeholder]})})]})})})]}),e.jsxs(Je,{open:c,onClose:ut,children:[e.jsxs(De,{children:["タグ",W===-1?"追加":"編集"]}),e.jsxs(Pe,{sx:{mt:2},children:[e.jsx(we,{label:"タグ名称",value:b,onChange:h=>H(h.target.value),fullWidth:!0,margin:"dense"}),e.jsx(we,{label:"色",type:"color",value:E,onChange:h=>P(h.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:ut,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:ht,disabled:b.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(Je,{open:le,onClose:Ue,children:[e.jsxs(De,{children:["タグ",$===-1?"追加":"編集"]}),e.jsxs(Pe,{sx:{mt:2},children:[e.jsx(we,{label:"タグ名称",value:g,onChange:h=>J(h.target.value),fullWidth:!0,margin:"dense"}),e.jsx(we,{label:"色",type:"color",value:Q,onChange:h=>se(h.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:Ue,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:Le,disabled:g.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(Je,{open:a,onClose:Fe,children:[e.jsxs(De,{children:["タグ",S===-1?"追加":"編集"]}),e.jsxs(Pe,{sx:{mt:2},children:[e.jsx(we,{label:"タグ名称",value:n,onChange:h=>x(h.target.value),fullWidth:!0,margin:"dense"}),e.jsx(we,{label:"色",type:"color",value:C,onChange:h=>q(h.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:Fe,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:$t,disabled:n.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}const mr=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function jr({statsSettings:y,setStatsSettings:f,playCategories:k,playDetails:p,rallyCategoryTags:_,rallyDetailTags:R,showSnackbar:A}){const[T,O]=l.useState(null),[w,W]=l.useState(""),[v,b]=l.useState(""),[H,E]=l.useState([]),[P,c]=l.useState([]),[B,$]=l.useState(""),[z,g]=l.useState(""),[J,Q]=l.useState("合算"),[se,le]=l.useState(!1),ie=Ne("md"),S=Ne("sm"),{handleTouchEnd:de,setSwiperRef:n,getSwiperRef:x}=dt(2),[C,q]=l.useState(""),a=r=>{if(C){const K=x(C);K&&(K.allowTouchMove=!0),q("")}if(!r.destination)return;const u=Array.from(y),[D]=u.splice(r.source.index,1);u.splice(r.destination.index,0,D),f(u)},s=r=>{var u;return((u=k.find(D=>D.id===r))==null?void 0:u.name)||""},i=r=>{var u;return((u=p.find(D=>D.id===r))==null?void 0:u.name)||""},o=r=>{const u=r.playCategoryId?s(r.playCategoryId):r.playCategoryTags?r.playCategoryTags.map(ae=>{var ne;return((ne=_.find(xe=>xe.id===ae))==null?void 0:ne.name)||ae}).join(", "):"",D=r.playDetailId?i(r.playDetailId):r.playDetailTags?r.playDetailTags.map(ae=>{var ne;return((ne=R.find(xe=>xe.id===ae))==null?void 0:ne.name)||ae}).join(", "):"",K=r.pointType||"",U=r.pointUnitType||"",G=r.aggregateType||"合算";return[u,D,K,U,G].filter(ae=>ae).join(", ")},m=()=>{O(-1),W(""),b(""),E([]),c([]),$(""),g(""),Q("合算"),le(!0)},N=r=>{const u=y[r];O(r),W(u.playCategoryId||""),b(u.playDetailId||""),E(u.playCategoryTags||[]),c(u.playDetailTags||[]),$(u.pointType||""),g(u.pointUnitType||""),Q(u.aggregateType||"合算"),le(!0)},te=()=>{const r=w!=="",u=v!=="",D=H.length>0,K=P.length>0,U=B!=="",G=z!=="";return r&&!u&&!D&&!K&&!U&&!G||r&&u&&!D&&!K&&!U&&!G||r&&!u&&!D&&!K&&U&&!G||r&&!u&&!D&&!K&&!U&&G||r&&!u&&!D&&!K&&U&&G||!r&&!u&&!D&&!K&&U&&!G||!r&&!u&&!D&&!K&&U&&G||!r&&!u&&!D&&!K&&!U&&G||D&&!r&&!u&&!K&&!U&&!G||D&&K&&!r&&!u&&!U&&!G||D&&K&&!r&&!u&&U&&!G||D&&K&&!r&&!u&&!U&&G||D&&K&&!r&&!u&&U&&G||D&&!r&&!u&&U&&!G||D&&!r&&!u&&!U&&G||D&&!r&&!u&&U&&G||K&&!r&&!u&&!D&&!U&&!G||K&&!r&&!u&&!D&&U&&!G||K&&!r&&!u&&!D&&!U&&G||K&&!r&&!u&&!D&&U&&G},Z=()=>{const r={id:T===-1?mr():y[T].id,playCategoryId:w||void 0,playDetailId:v||void 0,playCategoryTags:w===""&&H.length>0?H:void 0,playDetailTags:v===""&&P.length>0?P:void 0,pointType:v?void 0:B||void 0,pointUnitType:v?void 0:z||void 0,aggregateType:J};T===-1?f(u=>[...u,r]):T!==null&&f(u=>u.map((D,K)=>K===T?r:D)),le(!1)},X=()=>{le(!1)},re=r=>{const u=y[r];f(D=>D.filter((K,U)=>U!==r)),A("スタッツを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{f(D=>{const K=[...D];return K.splice(r,0,u),K})},autoHideDuration:5e3})},Ce=({s:r,idx:u,dragProvided:D})=>{const K=D.dragHandleProps,{onPointerDown:U,...G}=K||{},ae=ot(ne=>{U==null||U(ne);const xe=x(r.id);xe&&(xe.allowTouchMove=!1),q(r.id)});return e.jsx(t,{ref:D.innerRef,...D.draggableProps,style:D.draggableProps.style,children:e.jsxs(lt,{onSwiper:ne=>n(r.id,ne),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(ne,xe)=>xe.stopPropagation(),onTouchEnd:ne=>de(r.id,ne),children:[e.jsx(he,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...G,...ae,sx:{display:"grid",gridTemplateColumns:S?"1fr":"repeat(5, 1fr)",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:C===r.id?"none":"pan-y",cursor:"grab"},children:S?e.jsx(t,{children:o(r)}):e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{pr:1},children:r.playCategoryId?s(r.playCategoryId):r.playCategoryTags&&r.playCategoryTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:r.playCategoryTags.map(ne=>{const xe=_.find(Xe=>Xe.id===ne);return e.jsx(je,{label:(xe==null?void 0:xe.name)||ne,size:"small",sx:{backgroundColor:(xe==null?void 0:xe.color)||ye,color:"#fff"}},ne)})}):""}),e.jsx(t,{sx:{pr:1},children:r.playDetailId?i(r.playDetailId):r.playDetailTags&&r.playDetailTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:r.playDetailTags.map(ne=>{const xe=R.find(Xe=>Xe.id===ne);return e.jsx(je,{label:(xe==null?void 0:xe.name)||ne,size:"small",sx:{backgroundColor:(xe==null?void 0:xe.color)||ye,color:"#fff"}},ne)})}):""}),e.jsx(t,{sx:{pr:1},children:r.pointType||""}),e.jsx(t,{sx:{pr:1},children:r.pointUnitType||""}),e.jsx(t,{children:r.aggregateType||"合算"})]})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(oe,{size:"small",onClick:()=>N(u),children:e.jsx(it,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(he,{style:{width:Te,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(oe,{size:"small",onClick:()=>re(u),children:e.jsx(Se,{fontSize:"small",sx:{color:"common.white"}})})})})]})})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(Y,{onClick:m,variant:"contained",startIcon:e.jsx(Ke,{}),children:"追加"})}),e.jsx(Ye,{component:Ve,storageKey:"stats-grid",sx:{maxWidth:1024,mx:"auto"},children:ie?e.jsx(Be,{onDragEnd:a,children:e.jsx(_e,{droppableId:"stats-settings",children:r=>e.jsxs(t,{ref:r.innerRef,...r.droppableProps,children:[e.jsx(t,{sx:{display:"grid",gridTemplateColumns:S?"1fr":"repeat(5, 1fr)",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:S?e.jsx(t,{children:"スタッツ"}):e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"プレー区分"}),e.jsx(t,{children:"プレー詳細"}),e.jsx(t,{children:"得点区分"}),e.jsx(t,{children:"得失点単位区分"}),e.jsx(t,{children:"集計方法"})]})}),y.map((u,D)=>e.jsx(Re,{draggableId:u.id,index:D,children:K=>e.jsx(Ce,{s:u,idx:D,dragProvided:K})},u.id)),r.placeholder]})})}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:r=>r.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{padding:"checkbox",sx:{width:48}}),e.jsx(j,{children:"プレー区分"}),e.jsx(j,{children:"プレー詳細"}),e.jsx(j,{children:"得点区分"}),e.jsx(j,{children:"得失点単位区分"}),e.jsx(j,{children:"集計方法"}),e.jsx(j,{})]})}),e.jsx(Be,{onDragEnd:a,children:e.jsx(_e,{droppableId:"stats-settings",children:r=>e.jsxs(nt,{ref:r.innerRef,...r.droppableProps,children:[y.map((u,D)=>e.jsx(Re,{draggableId:u.id,index:D,children:K=>e.jsxs(Ie,{ref:K.innerRef,...K.draggableProps,"data-index":D,onClick:()=>N(D),sx:{cursor:"pointer",height:50},children:[e.jsx(j,{padding:"checkbox",sx:{width:48},children:e.jsx(t,{onClick:U=>U.stopPropagation(),...K.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(rt,{})})}),e.jsx(j,{children:u.playCategoryId?s(u.playCategoryId):u.playCategoryTags&&u.playCategoryTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.playCategoryTags.map(U=>{const G=_.find(ae=>ae.id===U);return e.jsx(je,{label:(G==null?void 0:G.name)||U,size:"small",sx:{backgroundColor:(G==null?void 0:G.color)||ye,color:"#fff"}},U)})}):""}),e.jsx(j,{children:u.playDetailId?i(u.playDetailId):u.playDetailTags&&u.playDetailTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.playDetailTags.map(U=>{const G=R.find(ae=>ae.id===U);return e.jsx(je,{label:(G==null?void 0:G.name)||U,size:"small",sx:{backgroundColor:(G==null?void 0:G.color)||ye,color:"#fff"}},U)})}):""}),e.jsx(j,{children:u.pointType||""}),e.jsx(j,{children:u.pointUnitType||""}),e.jsx(j,{children:u.aggregateType||"合算"}),e.jsx(j,{padding:"checkbox",children:e.jsx(t,{onClick:U=>U.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:"small",onClick:()=>re(D),sx:{width:24,height:24},children:e.jsx(Se,{fontSize:"small",color:"error"})})})})]})},u.id)),r.placeholder]})})})]})})]}),e.jsxs(Je,{open:se,onClose:X,children:[e.jsxs(De,{children:["スタッツ設定",T===-1?"追加":"編集"]}),e.jsxs(Pe,{children:[e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"stat-category-label",children:"プレー区分"}),e.jsxs(He,{labelId:"stat-category-label",value:w,label:"プレー区分",onChange:r=>{W(r.target.value),b(""),E([]),c([])},disabled:H.length>0||P.length>0,children:[e.jsx(ce,{value:"",children:"なし"}),k.map(r=>e.jsx(ce,{value:r.id,children:r.name},r.id))]})]}),e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"stat-detail-label",children:"プレー詳細"}),e.jsxs(He,{labelId:"stat-detail-label",value:v,label:"プレー詳細",onChange:r=>{b(r.target.value),$(""),g(""),E([]),c([])},disabled:B!==""||z!==""||H.length>0||P.length>0,children:[e.jsx(ce,{value:"",children:"なし"}),p.filter(r=>r.playCategoryId===w).map(r=>e.jsx(ce,{value:r.id,children:r.name},r.id))]})]}),e.jsx(Pt,{multiple:!0,options:_,getOptionLabel:r=>r.name,value:_.filter(r=>H.includes(r.id)),onChange:(r,u)=>{E(u.map(D=>D.id)),u.length>0&&(W(""),b(""))},disabled:w!==""||v!=="",renderTags:(r,u)=>r.map((D,K)=>{const{key:U,...G}=u({index:K});return e.jsx(je,{...G,label:D.name,size:"small",sx:{backgroundColor:D.color||ye,color:"#fff"}},U)}),renderInput:r=>e.jsx(we,{...r,label:"プレー区分タグ",margin:"dense"}),fullWidth:!0}),e.jsx(Pt,{multiple:!0,options:R,getOptionLabel:r=>r.name,value:R.filter(r=>P.includes(r.id)),onChange:(r,u)=>{c(u.map(D=>D.id)),u.length>0&&(W(""),b(""))},disabled:w!==""||v!=="",renderTags:(r,u)=>r.map((D,K)=>{const{key:U,...G}=u({index:K});return e.jsx(je,{...G,label:D.name,size:"small",sx:{backgroundColor:D.color||ye,color:"#fff"}},U)}),renderInput:r=>e.jsx(we,{...r,label:"プレー詳細タグ",margin:"dense"}),fullWidth:!0}),e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"stat-point-label",children:"得点区分"}),e.jsxs(He,{labelId:"stat-point-label",value:B,label:"得点区分",onChange:r=>{$(r.target.value),r.target.value!==""&&b("")},disabled:v!=="",children:[e.jsx(ce,{value:"",children:"なし"}),e.jsx(ce,{value:"得点",children:"得点"}),e.jsx(ce,{value:"失点",children:"失点"})]})]}),e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"stat-unit-label",children:"得失点単位区分"}),e.jsxs(He,{labelId:"stat-unit-label",value:z,label:"得失点単位区分",onChange:r=>{g(r.target.value),r.target.value!==""&&b("")},disabled:v!=="",children:[e.jsx(ce,{value:"",children:"なし"}),e.jsx(ce,{value:"メンバー",children:"メンバー"}),e.jsx(ce,{value:"チーム",children:"チーム"})]})]}),e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"stat-aggregate-label",children:"集計方法"}),e.jsxs(He,{labelId:"stat-aggregate-label",value:J,label:"集計方法",onChange:r=>Q(r.target.value),children:[e.jsx(ce,{value:"合算",children:"合算"}),e.jsx(ce,{value:"セット平均",children:"セット平均"})]})]})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:X,color:"inherit",startIcon:e.jsx(Ee,{}),children:"キャンセル"}),e.jsx(Y,{onClick:Z,disabled:!te(),startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}var Ss={},yr=ge;Object.defineProperty(Ss,"__esModule",{value:!0});var yn=Ss.default=void 0,br=yr(fe()),vr=e;yn=Ss.default=(0,br.default)((0,vr.jsx)("path",{d:"M9.37 5.51c-.18.64-.27 1.31-.27 1.99 0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27C17.45 17.19 14.93 19 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1"}),"DarkModeOutlined");var Ts={},Cr=ge;Object.defineProperty(Ts,"__esModule",{value:!0});var bn=Ts.default=void 0,Ir=Cr(fe()),wr=e;bn=Ts.default=(0,Ir.default)((0,wr.jsx)("path",{d:"M12 9c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3m0-2c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5M2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1m18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1M11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1m0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1M5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0z"}),"LightModeOutlined");const ts=[{id:"light1",name:"ライトモード１",setting:{mode:"light",appBarColor:"#F5F5F5",appBarTextColor:"#000000",buttonColor:"#1C8139",scoreColor:"#1C8139",lossColor:"#D21972"}},{id:"light2",name:"ライトモード２",setting:{mode:"light",appBarColor:"#F2EDE3",appBarTextColor:"#000000",buttonColor:"#48A588",scoreColor:"#48A588",lossColor:"#CE5164"}},{id:"dark1",name:"ダークモード１",setting:{mode:"dark",appBarColor:"#333333",appBarTextColor:"#FFFFFF",buttonColor:"#90CAF9",scoreColor:"#90CAF9",lossColor:"#F48FB1"}},{id:"dark2",name:"ダークモード２",setting:{mode:"dark",appBarColor:"#121212",appBarTextColor:"#FFFFFF",buttonColor:"#BB86FC",scoreColor:"#419552",lossColor:"#C77584"}}];function Sr({theme:y,onThemeChange:f,adminMode:k}){var A;const p=(A=ts.find(T=>T.name===y.name))==null?void 0:A.id,_=(T,O)=>{if(!O)return;const w=ts.find(W=>W.id===O);w&&f({name:w.name,...w.setting})},R=[{key:"buttonColor",label:"ボタンカラー"},{key:"scoreColor",label:"得点カラー"},{key:"lossColor",label:"失点カラー"}];return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxWidth:1024,width:"100%",mx:"auto"},children:[e.jsxs(t,{sx:{display:k?"flex":"none",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"アプリカラー"}),e.jsx("input",{type:"color",value:y.appBarColor,onChange:T=>f({...y,appBarColor:T.target.value}),title:"背景色"}),e.jsx("input",{type:"color",value:y.appBarTextColor,onChange:T=>f({...y,appBarTextColor:T.target.value}),title:"文字色",style:{marginLeft:8}})]}),R.map(({key:T,label:O})=>e.jsxs(t,{sx:{display:k?"flex":"none",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:O}),e.jsx("input",{type:"color",value:y[T],onChange:w=>f({...y,[T]:w.target.value})})]},T)),e.jsx(Ae,{orientation:"vertical",exclusive:!0,value:p,onChange:_,sx:{"& .MuiToggleButton-root":{justifyContent:"flex-start"}},children:ts.map(T=>e.jsxs(ve,{value:T.id,sx:{textAlign:"left"},children:[T.setting.mode==="dark"?e.jsx(yn,{sx:{mr:1}}):e.jsx(bn,{sx:{mr:1}}),T.name,p===T.id&&e.jsx(ze,{sx:{ml:"auto"}})]},T.id))})]})}var ks={},Tr=ge;Object.defineProperty(ks,"__esModule",{value:!0});var vn=ks.default=void 0,kr=Tr(fe()),_r=e;vn=ks.default=(0,kr.default)((0,_r.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");function Rr({scoreInput:y,onScoreInputChange:f,dashboardVisible:k,onDashboardVisibleChange:p,showSnackbar:_,adminMode:R}){const[A,T]=l.useState(!1),O=()=>{try{const E=[];for(let P=0;P<localStorage.length;P++){const c=localStorage.key(P);c&&c.startsWith("tutorial-")&&E.push(c)}E.forEach(P=>localStorage.removeItem(P)),_("ガイド表示済み状態をクリアしました","success")}catch(E){console.error(E),_("ガイド表示済み状態のクリアに失敗しました","error")}},w=()=>T(!0),W=()=>T(!1),v=()=>{T(!1),O()},b=[{key:"rallyMemberRequired",label:"ラリー結果メンバー選択必須"},{key:"showRallyIcons",label:"ラリー結果アイコン表示"},{key:"showGridScrollHint",label:"グリッド横スクロール表記表示"},{key:"showScoreProgressArea",label:"得点推移エリア表示"}],H=(E,P)=>{f({...y,[E]:P})};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",mt:1,maxWidth:1024,width:"100%",mx:"auto"},children:[R&&b.map(({key:E,label:P})=>e.jsx(Fs,{control:e.jsx(It,{checked:y[E],onChange:c=>H(E,c.target.checked)}),label:P,sx:{mb:1}},E)),e.jsx(Fs,{control:e.jsx(It,{checked:k,onChange:E=>p(E.target.checked)}),label:"ダッシュボード表示",sx:{mb:1,display:"none"}}),e.jsx(Y,{variant:"contained",startIcon:e.jsx(vn,{}),onClick:w,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"},alignSelf:"flex-start",mt:2},children:"ガイド再表示"}),e.jsxs(gt,{open:A,onClose:W,children:[e.jsx(De,{children:"確認"}),e.jsx(Pe,{sx:{mt:2},children:"ガイドを再表示しますか？"}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:W,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:v,startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}var _s={},Or=ge;Object.defineProperty(_s,"__esModule",{value:!0});var ls=_s.default=void 0,Dr=Or(fe()),Pr=e;ls=_s.default=(0,Dr.default)((0,Pr.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen");function Mr({teams:y,matches:f,tags:k,matchLocks:p,setMatchLocks:_,lockGroupBy:R,setLockGroupBy:A}){const T=Ne("md"),O=Ne("sm"),w=P=>{var c;return((c=y.find(B=>B.id===P))==null?void 0:c.name)||""},W=O?"32px 100px 1fr 100px":"32px 100px 1fr 170px 210px 60px",v=R,b=sl(f,v),H=P=>P.map(c=>{const B=c.sets.filter(g=>g.my>g.opponent).length,$=c.sets.filter(g=>g.my<g.opponent).length,z=p[c.id];return e.jsxs(Ie,{sx:{height:50},children:[e.jsx(j,{padding:"checkbox",sx:{width:32},children:e.jsx(oe,{size:"small",onClick:()=>_(g=>({...g,[c.id]:!g[c.id]})),children:z?e.jsx(ss,{sx:{color:"#D21972"}}):e.jsx(ls,{sx:{color:"#1C8139"}})})}),e.jsx(j,{sx:{width:100},children:c.date}),e.jsx(j,{children:c.matchName}),e.jsx(j,{sx:{width:170},children:`${w(c.teamA)} - ${w(c.teamB)}`}),e.jsx(j,{sx:{width:210},children:c.tags.map(g=>{const J=k.find(se=>se.id===g),Q=(J==null?void 0:J.color)||ye;return e.jsx(je,{label:(J==null?void 0:J.name)||g,size:"small",sx:{mr:.5,mb:.5,backgroundColor:Q,color:"#fff"}},g)})}),e.jsxs(j,{sx:{width:60,textAlign:"left"},children:[B,"-",$]})]},c.id)}),E=P=>P.map(c=>{const B=c.sets.filter(g=>g.my>g.opponent).length,$=c.sets.filter(g=>g.my<g.opponent).length,z=p[c.id];return e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:W,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider"},children:[e.jsx(t,{children:e.jsx(oe,{size:"small",onClick:()=>_(g=>({...g,[c.id]:!g[c.id]})),children:z?e.jsx(ss,{sx:{color:"#D21972"}}):e.jsx(ls,{sx:{color:"#1C8139"}})})}),e.jsx(t,{children:c.date}),e.jsx(t,{children:c.matchName}),e.jsx(t,{children:O?e.jsxs(e.Fragment,{children:[e.jsx(t,{children:w(c.teamA)}),e.jsx(t,{children:w(c.teamB)})]}):`${w(c.teamA)} - ${w(c.teamB)}`}),!O&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:c.tags.map(g=>{const J=k.find(se=>se.id===g),Q=(J==null?void 0:J.color)||ye;return e.jsx(je,{label:(J==null?void 0:J.name)||g,size:"small",sx:{mr:.5,mb:.5,backgroundColor:Q,color:"#fff"}},g)})}),e.jsxs(t,{sx:{textAlign:"left"},children:[B,"-",$]})]})]},c.id)});return e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto"},children:T?e.jsx($e,{size:"small",margin:"dense",children:e.jsxs(He,{value:R,onChange:P=>A(P.target.value),children:[e.jsx(ce,{value:"none",children:"グルーピングなし"}),e.jsx(ce,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(ce,{value:"card",children:"対戦カード"})]})}):e.jsxs(Ae,{exclusive:!0,value:R,onChange:(P,c)=>{c!==null&&A(c)},sx:{mb:1},children:[e.jsx(ve,{value:"none",children:"グルーピングなし"}),e.jsx(ve,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(ve,{value:"card",children:"対戦カード"})]})}),e.jsx(Ye,{component:Ve,storageKey:"match-lock-grid",sx:{maxWidth:1024,mx:"auto"},children:T?e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:W,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:[e.jsx(t,{}),e.jsx(t,{children:"日付"}),e.jsx(t,{children:"試合名"}),e.jsx(t,{children:"対戦カード"}),!O&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"タグ"}),e.jsx(t,{sx:{textAlign:"left"},children:"セット"})]})]}),v==="none"?E(b.all||[]):Object.entries(b).map(([P,c])=>{const B=v==="card"?Bs(c[0].teamA,c[0].teamB,y):P;return e.jsxs(t,{children:[e.jsx(t,{sx:{display:"grid",gridTemplateColumns:W,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...ke},children:e.jsx(t,{sx:{gridColumn:"1 / -1"},children:B})}),E(c)]},P)})]}):e.jsxs(tt,{size:"small",children:[e.jsx(st,{children:e.jsxs(Ie,{sx:{backgroundColor:P=>P.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(j,{padding:"checkbox",sx:{width:32}}),e.jsx(j,{sx:{width:100,...ke},children:"日付"}),e.jsx(j,{sx:ke,children:"試合名"}),e.jsx(j,{sx:{width:170,...ke},children:"対戦カード"}),e.jsx(j,{sx:{width:210,...ke},children:"タグ"}),e.jsx(j,{sx:{width:60,textAlign:"left",...ke},children:"セット"})]})}),e.jsx(nt,{children:v==="none"?H(b.all||[]):Object.entries(b).map(([P,c])=>{const B=v==="card"?Bs(c[0].teamA,c[0].teamB,y):P;return e.jsxs(l.Fragment,{children:[e.jsx(Ie,{sx:{height:50},children:e.jsx(j,{colSpan:6,sx:ke,children:B})}),H(c)]},P)})})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",mt:1},children:e.jsx(et,{severity:"info",children:"試合をロックすると、この試合は削除できなくなり閲覧のみとなります。ロック解除で編集・削除が可能です。"})})]})}var Rs={},Er=ge;Object.defineProperty(Rs,"__esModule",{value:!0});var Cn=Rs.default=void 0,zr=Er(fe()),$r=e;Cn=Rs.default=(0,zr.default)((0,$r.jsx)("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 12H4V8h16z"}),"FolderOpen");var Os={},Hr=ge;Object.defineProperty(Os,"__esModule",{value:!0});var rs=Os.default=void 0,Ar=Hr(fe()),Wr=e;rs=Os.default=(0,Ar.default)((0,Wr.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");var Ds={},Nr=ge;Object.defineProperty(Ds,"__esModule",{value:!0});var In=Ds.default=void 0,Lr=Nr(fe()),Fr=e;In=Ds.default=(0,Lr.default)((0,Fr.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload");const Br=`[team]
サンプルチーム

[member]
サンプルチーム,1,バレーボーラー

[rally-play-category]
スパイク

[rally-play-detail]
スパイク,イン,得点,メンバー
スパイク,アウト,失点,メンバー
スパイク,アウト,失点,メンバー`,os=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36),Vr=y=>({id:crypto.randomUUID(),name:y}),Ur=y=>({id:os(),name:y,color:ye,iconType:"none",tags:[],visible:!0});function Gr({onDeleteData:y,onImportData:f,onExportData:k,showSnackbar:p,teams:_,setTeams:R,setMembers:A,playCategories:T,setPlayCategories:O,setPlayDetails:w,adminMode:W}){const[v,b]=l.useState(!1),[H,E]=l.useState(null),[P,c]=l.useState(!1),[B,$]=l.useState(!1),[z,g]=l.useState(Br),J=()=>{b(!0)},Q=async()=>{b(!1);try{await y(),p("全データを削除しました","success")}catch(a){console.error(a),p("全データの削除に失敗しました","error")}},se=()=>{b(!1)},le=a=>{E(a.target.files&&a.target.files[0]?a.target.files[0]:null)},ie=()=>{c(!0)},S=async()=>{c(!1);const a=H;E(null);try{a&&await f(a),p("インポートが完了しました","success")}catch(s){console.error(s),p("インポートに失敗しました","error")}},de=()=>{c(!1)},n=async()=>{try{await k(),p("エクスポートが完了しました","success")}catch(a){console.error(a),p("エクスポートに失敗しました","error")}},x=()=>{$(!0)},C=()=>{$(!1);try{const a=z.replace(/\r\n/g,`
`).split(`
`);let s="";const i=[],o={},m=[],N=[];for(const te of a){const Z=te.trim();if(Z!==""){if(Z.startsWith("[")&&Z.endsWith("]")){s=Z.toLowerCase();continue}switch(s){case"[team]":i.push(Vr(Z));break;case"[member]":{const[X,re,Ce]=Z.split(",").map(r=>r.trim());if(X&&re&&Ce){const r=[..._,...i].find(u=>u.name===X);if(r){const u={id:os(),no:Number(re),name:Ce,positions:[],visible:!0};o[r.id]||(o[r.id]=[]),o[r.id].push(u)}}break}case"[rally-play-category]":m.push(Ur(Z));break;case"[rally-play-detail]":{const[X,re,Ce,r]=Z.split(",").map(u=>u.trim());if(X&&re&&Ce&&r){const u=[...T,...m].find(D=>D.name===X);u&&N.push({id:os(),playCategoryId:u.id,name:re,pointType:Ce,pointUnitType:r,tags:[],visible:!0})}break}default:break}}}i.length&&R(te=>[...te,...i]),Object.keys(o).length&&A(te=>{const Z={...te};for(const[X,re]of Object.entries(o))Z[X]=[...Z[X]||[],...re];return Z}),m.length&&O(te=>[...te,...m]),N.length&&w(te=>[...te,...N]),i.length||Object.keys(o).length||m.length||N.length?(p("一括登録が完了しました","success"),g("")):p("登録対象のデータがありません","error")}catch(a){console.error(a),p("一括登録に失敗しました","error")}},q=()=>{$(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{maxWidth:1024,width:"100%",mx:"auto",textAlign:"left",display:"flex",flexDirection:"column",gap:1,alignItems:"flex-start"},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"データエクスポート"}),e.jsx(t,{children:e.jsx(Y,{variant:"contained",startIcon:e.jsx(In,{}),onClick:n,children:"エクスポート"})}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"データインポート"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(Y,{variant:"outlined",component:"label",startIcon:e.jsx(Cn,{}),children:["ファイル選択",e.jsx("input",{type:"file",accept:".zip",hidden:!0,onChange:le})]}),e.jsx(Y,{variant:"contained",startIcon:e.jsx(rs,{}),onClick:ie,disabled:!H,children:"インポート"})]}),W&&e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"一括登録"}),e.jsx(we,{value:z,onChange:a=>g(a.target.value),multiline:!0,minRows:10,fullWidth:!0}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:e.jsx(Y,{variant:"contained",startIcon:e.jsx(rs,{}),onClick:x,children:"一括登録"})})]}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"データ削除"}),e.jsx(Y,{variant:"contained",color:"error",startIcon:e.jsx(Se,{}),onClick:J,children:"全データ削除"})]}),e.jsxs(gt,{open:v,onClose:se,children:[e.jsx(De,{children:"削除確認"}),e.jsx(Pe,{sx:{mt:2},children:"全データを削除しますか？"}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:se,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:Q,color:"error",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(gt,{open:P,onClose:de,children:[e.jsx(De,{children:"確認"}),e.jsx(Pe,{sx:{mt:2},children:"データをインポートしますか？"}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:de,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:S,disabled:!H,startIcon:e.jsx(ze,{}),children:"OK"})]})]}),W&&e.jsxs(gt,{open:B,onClose:q,children:[e.jsx(De,{children:"確認"}),e.jsx(Pe,{sx:{mt:2},children:"一括登録を実行しますか？"}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:q,startIcon:e.jsx(Ee,{}),color:"inherit",children:"キャンセル"}),e.jsx(Y,{onClick:C,startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}var Ps={},qr=ge;Object.defineProperty(Ps,"__esModule",{value:!0});var wn=Ps.default=void 0,Kr=qr(fe()),Yr=e;wn=Ps.default=(0,Kr.default)((0,Yr.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");const Jr=`MIT License

Copyright (c) 2025 shinya_sun_sun

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
`;function Xr(y){if(!y)return"";let f=y.replace(/^git\+/,"");const k=f.match(/^git@github\.com:(.+)$/);k&&(f=`https://github.com/${k[1]}`);const p=f.match(/^git:\/\/github\.com\/(.+)$/);p&&(f=`https://github.com/${p[1]}`);const _=f.match(/^ssh:\/\/git@github\.com\/(.+)$/);return _&&(f=`https://github.com/${_[1]}`),f.startsWith("github.com/")&&(f=`https://${f}`),/^[a-zA-Z]+:\/\//.test(f)||(/^[^/]+\/[^/]+$/.test(f)?f=`https://github.com/${f}`:f=`https://${f}`),f=f.replace(/\.git$/,""),f}function Zr(){const[y,f]=l.useState(""),[k,p]=l.useState([]),[_,R]=l.useState(!0),[A,T]=l.useState({}),O={MIT:"https://opensource.org/license/mit/"};l.useEffect(()=>{nl(()=>import("./licenses-uPPrrUXe.js"),[]).then(v=>p(v.licenses)).finally(()=>R(!1))},[]);const w=l.useMemo(()=>k.filter(v=>v.name.toLowerCase().includes(y.toLowerCase())),[y,k]),W=async v=>{if(!A[v])try{const b=await fetch(`https://raw.githubusercontent.com/spdx/license-list-data/main/text/${v}.txt`);if(!b.ok)throw new Error("not ok");const H=await b.text();T(E=>({...E,[v]:H}))}catch{T(b=>({...b,[v]:""}))}};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(vt,{variant:"h6",sx:{mb:1},children:"BreakPoint MIT License"}),e.jsx(t,{component:"pre",sx:{p:1,backgroundColor:v=>v.palette.mode==="dark"?"#343A42":"#f5f5f5",color:v=>v.palette.text.primary,whiteSpace:"pre-wrap",minHeight:128,overflow:"auto"},children:Jr}),e.jsx(we,{label:"検索",value:y,onChange:v=>f(v.target.value),sx:{my:2}}),e.jsx(t,{sx:{flexGrow:1,overflow:"auto"},children:_?e.jsx(t,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(Yn,{})}):w.map(v=>{const b=v.license;return e.jsxs(Jn,{onChange:(H,E)=>{E&&W(b)},children:[e.jsxs(Xn,{expandIcon:e.jsx(wn,{}),children:[e.jsx(vt,{sx:{flexGrow:1},children:v.name}),e.jsx(vt,{variant:"body2",sx:{ml:2},children:b})]}),e.jsxs(Zn,{children:[(()=>{const H=Xr(v.url);return H&&e.jsx(Dt,{href:H,target:"_blank",rel:"noopener",sx:{display:"block",mb:1,wordBreak:"break-all"},children:H})})(),v.license.startsWith("CC")&&v.attribution&&e.jsx(vt,{variant:"body2",sx:{mb:1,whiteSpace:"pre-wrap"},children:v.attribution}),A[b]!==void 0&&(A[b]?e.jsx(t,{component:"pre",sx:{p:1,backgroundColor:H=>H.palette.mode==="dark"?"#343A42":"#f5f5f5",color:H=>H.palette.text.primary,whiteSpace:"pre-wrap",maxHeight:300,overflow:"auto"},children:A[b]}):e.jsx(Dt,{href:O[b]||`https://spdx.org/licenses/${b}.html`,target:"_blank",rel:"noopener",sx:{wordBreak:"break-all"},children:O[b]||`https://spdx.org/licenses/${b}.html`}))]})]},v.name)})})]})}const Qr=cl.create(t),eo=new Set(["playCombinations","opponentPlayInputControls","tags","stats"]),Xs=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function Zs(y){if(typeof window>"u")return y;try{const k=new DOMParser().parseFromString(y,"image/svg+xml"),p=new Set(["svg","g","path","circle","rect","line","polygon","polyline","text","defs","use"]),_=R=>{[...R.children].forEach(A=>{if(p.has(A.tagName))[...A.attributes].forEach(T=>{T.name.startsWith("on")&&A.removeAttribute(T.name)}),_(A);else{const T=document.createTextNode(A.outerHTML);A.replaceWith(T)}})};return _(k.documentElement),k.documentElement.outerHTML}catch{return""}}function to({src:y,cropX:f,cropY:k,onChange:p}){const _=l.useRef(null),R=l.useRef(null),[A,T]=l.useState(!1),[O,w]=l.useState({x:0,y:0}),W=()=>_.current?{sx:_.current.clientWidth/_.current.naturalWidth,sy:_.current.clientHeight/_.current.naturalHeight}:{sx:1,sy:1},v=c=>{c.preventDefault(),c.stopPropagation();const B=R.current.getBoundingClientRect();w({x:c.clientX-B.left,y:c.clientY-B.top}),T(!0)},b=c=>{if(!A||!_.current)return;const B=_.current.getBoundingClientRect(),{sx:$,sy:z}=W(),g=c.clientX-B.left-O.x,J=c.clientY-B.top-O.y,Q=Math.min(Math.max(0,g/$),_.current.naturalWidth-64),se=Math.min(Math.max(0,J/z),_.current.naturalHeight-64);p(Math.round(Q),Math.round(se))},H=()=>T(!1),{sx:E,sy:P}=W();return e.jsxs(t,{sx:{position:"relative",display:"inline-block"},onMouseMove:b,onMouseUp:H,onMouseLeave:H,children:[e.jsx("img",{src:y,ref:_,style:{maxWidth:256}}),e.jsx(t,{ref:R,sx:{position:"absolute",left:f*E,top:k*P,width:64,height:64,border:"1px solid red",cursor:"move"},onMouseDown:v})]})}function so({name:y}){const f=l.useRef(null),[k,p]=l.useState(1);return l.useEffect(()=>{const _=f.current;if(!_)return;const R=_.getBBox().width;p(R>64?64/R:1)},[y]),e.jsx("svg",{width:64,height:64,children:e.jsx("g",{transform:`scale(${k})`,children:e.jsx("text",{ref:f,x:32/k,y:32/k,textAnchor:"middle",dominantBaseline:"middle",fontSize:8,children:y})})})}function xo({matches:y,teams:f,teamMembers:k,playCategories:p,playDetails:_,statsSettings:R,tags:A,rallyCategoryTags:T,rallyDetailTags:O,themeSetting:w,scoreInputSetting:W,onSave:v,onDirtyChange:b,onDeleteData:H,onImportData:E,onExportData:P,showSnackbar:c,dashboardVisible:B,onDashboardVisibleChange:$,setAppBarLeftAction:z}){var Ls;const[g,J]=l.useState("teams");l.useEffect(()=>{window.scrollTo(0,0)},[g]);const[Q,se]=l.useState(()=>{try{return localStorage.getItem("break-point-admin")==="1"}catch{return!1}}),le=l.useRef(0),ie=l.useRef(),[S,de]=l.useState([...f]),[n,x]=l.useState({...k}),[C,q]=l.useState(((Ls=f[0])==null?void 0:Ls.id)||""),[a,s]=l.useState([...p]),[i,o]=l.useState(null),[m,N]=l.useState(""),[te,Z]=l.useState(ye),[X,re]=l.useState("設定なし"),[Ce,r]=l.useState(""),[u,D]=l.useState(""),[K,U]=l.useState(0),[G,ae]=l.useState(0),[ne,xe]=l.useState([]),[Xe,ft]=l.useState(!0),[wt,ht]=l.useState(!1),[ut,mt]=l.useState(null),[Et,pt]=l.useState(!1),[Le,Ue]=l.useState([..._]),[at,zt]=l.useState([...R]),[Ze,$t]=l.useState([...A]),[Fe,St]=l.useState([...T]),[h,I]=l.useState([...O]),[V,F]=l.useState({...w}),[L,ue]=l.useState({...W}),[Qe,xt]=l.useState([...y]),[pe,Oe]=l.useState(()=>{const d={};return y.forEach(M=>{d[M.id]=!!M.locked}),d}),[Sn,Tn]=l.useState("none"),Ht=!0,jt=el(),Tt=nn();l.useEffect(()=>{if(!jt.pathname.startsWith("/settings"))return;jt.pathname.split("/")[2]},[Ht,jt.pathname,Tt]),l.useEffect(()=>{const M=jt.pathname.split("/")[2];J(M??null)},[jt.pathname,Ht]);const[yt,Ms]=l.useState(null),[At,Wt]=l.useState(""),[kt,Nt]=l.useState(""),[Lt,Ft]=l.useState("得点"),[Bt,Vt]=l.useState("メンバー"),[Ut,Gt]=l.useState([]),[qt,Kt]=l.useState(!0),[kn,_t]=l.useState(!1),[Es,zs]=l.useState(null),[_n,Yt]=l.useState(!1),Rn=d=>({id:crypto.randomUUID(),name:d}),On=d=>({id:Xs(),name:d,color:ye,iconType:"none",tags:[],visible:!0}),Rt=l.useMemo(()=>{const d=y.some(M=>!!M.locked!==pe[M.id]);return JSON.stringify(S)!==JSON.stringify(f)||JSON.stringify(n)!==JSON.stringify(k)||JSON.stringify(a)!==JSON.stringify(p)||JSON.stringify(Le)!==JSON.stringify(_)||JSON.stringify(at)!==JSON.stringify(R)||JSON.stringify(Ze)!==JSON.stringify(A)||JSON.stringify(Fe)!==JSON.stringify(T)||JSON.stringify(h)!==JSON.stringify(O)||JSON.stringify(V)!==JSON.stringify(w)||JSON.stringify(L)!==JSON.stringify(W)||d},[S,n,a,Le,at,Ze,Fe,h,V,L,pe,f,k,p,_,R,A,T,O,w,W,y]),Dn=l.useMemo(()=>[{key:"teams",label:"チーム",icon:e.jsx(ln,{})},{key:"members",label:"メンバー",icon:e.jsx(rn,{})},{key:"scores",label:"ラリー",icon:e.jsx(on,{})},{key:"playCombinations",label:"相手プレー自動入力",icon:e.jsx(un,{})},{key:"opponentPlayInputControls",label:"相手プレー入力制御",icon:e.jsx(pn,{})},{key:"tags",label:"タグ",icon:e.jsx(an,{})},{key:"stats",label:"スタッツ",icon:e.jsx(ol,{})},{key:"locks",label:"試合ロック",icon:e.jsx(ss,{})},{key:"theme",label:"テーマ",icon:e.jsx(cn,{})},{key:"display",label:"表示・操作",icon:e.jsx(dn,{})},{key:"data",label:"データ",icon:e.jsx(xn,{})},{key:"license",label:"ライセンス",icon:e.jsx(il,{})},{key:"version",label:"バージョン",icon:e.jsx(hn,{})}],[]),Pn=l.useMemo(()=>[["teams","members","scores","playCombinations","opponentPlayInputControls","tags","stats"],["display","theme"],["locks","data"],["license"],["version"]],[]),$s=l.useCallback(()=>{const d=Qe.map(M=>({...M,locked:pe[M.id]}));v(S,n,a,Le,at,Ze,Fe,h,V,L,d,!0)},[a,Le,pe,Qe,v,S,n,at,Ze,Fe,h,V,L]),Mn=()=>{o(-1),N(""),Z(ye),re("設定なし"),r(""),D(""),U(0),ae(0),xe([]),ft(!0),ht(!0)},En=d=>{o(d),N(a[d].name),Z(a[d].color||ye);const M=a[d];re(M.iconType==="svg"?"SVG":M.iconType==="image"?"画像":"設定なし"),r(M.svg||""),D(M.image||""),U(M.cropX||0),ae(M.cropY||0),xe(M.tags||[]),ft(M.visible!==!1),ht(!0)},zn=()=>{const d=X==="SVG"?"svg":X==="画像"?"image":"none",M=d==="svg"?{iconType:d,svg:Ce}:d==="image"?{iconType:d,image:u,cropX:K,cropY:G}:{iconType:d};i===-1?s(ee=>[...ee,{...On(m),...M,color:te,tags:ne,visible:Xe}]):i!==null&&s(ee=>ee.map((be,me)=>me===i?{...be,name:m,...M,color:te,tags:ne,visible:Xe}:be)),ht(!1)},Hs=()=>{ht(!1)},$n=d=>{mt(d),pt(!0)},Hn=()=>{if(ut!==null&&a[ut].id!=="init-serve"){const d=ut,M=a[d];s(ee=>ee.filter((be,me)=>me!==d)),c("プレー区分を削除しました","success",{actionLabel:"元に戻す",onAction:()=>{s(ee=>{const be=[...ee];return be.splice(d,0,M),be})},autoHideDuration:5e3})}pt(!1),mt(null)},As=()=>{pt(!1)},An=()=>{var d;Ms(-1),Wt(((d=a.find(M=>M.visible!==!1))==null?void 0:d.id)||""),Nt(""),Ft("得点"),Vt("メンバー"),Gt([]),Kt(!0),_t(!0)},Wn=d=>{const M=Le[d];Ms(d),Wt(M.playCategoryId),Nt(M.name),Ft(M.pointType),Vt(M.pointUnitType),Gt(M.tags||[]),Kt(M.visible!==!1),_t(!0)},Nn=()=>{yt===-1?Ue(d=>[...d,{id:Xs(),playCategoryId:At,name:kt,pointType:Lt,pointUnitType:Bt,tags:Ut,visible:qt}]):yt!==null&&Ue(d=>d.map((M,ee)=>ee===yt?{...M,playCategoryId:At,name:kt,pointType:Lt,pointUnitType:Bt,tags:Ut,visible:qt}:M)),_t(!1)},Ws=()=>{_t(!1)},Ln=d=>{zs(d),Yt(!0)},Fn=()=>{if(Es!==null){const d=Es,M=Le[d];Ue(ee=>ee.filter((be,me)=>me!==d)),c("プレー詳細を削除しました","success",{actionLabel:"元に戻す",onAction:()=>{Ue(ee=>{const be=[...ee];return be.splice(d,0,M),be})},autoHideDuration:5e3})}Yt(!1),zs(null)},Ns=()=>{Yt(!1)},Bn=l.useCallback(()=>{if(le.current+=1,ie.current&&clearTimeout(ie.current),ie.current=window.setTimeout(()=>{le.current=0},1e3),le.current>=5){const d=Q?"0":"1";try{localStorage.setItem("break-point-admin",d)}catch(M){console.error(M)}se(d==="1"),c(d==="1"?"管理者モードを有効にしました":"管理者モードを無効にしました","success"),le.current=0}},[Q,c]);l.useEffect(()=>()=>{ie.current&&clearTimeout(ie.current)},[]),l.useEffect(()=>(z(g?e.jsx(oe,{onClick:()=>Tt("/settings"),size:"small",children:e.jsx(Mt,{})}):null),()=>z(null)),[z,Ht,g,Tt]),l.useEffect(()=>(b==null||b(Rt),()=>b==null?void 0:b(!1)),[Rt,b]),l.useEffect(()=>{Rt&&$s()},[Rt,$s]);const Vn=d=>d.iconType==="svg"&&d.svg?e.jsx(t,{sx:{width:64,height:64},dangerouslySetInnerHTML:{__html:Zs(d.svg)}}):d.iconType==="image"&&d.image?e.jsx(t,{component:"img",src:d.image,sx:{width:64,height:64,objectFit:"none",objectPosition:`-${d.cropX||0}px -${d.cropY||0}px`}}):e.jsx(so,{name:d.name});return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",height:g!==null?"auto":"100dvh",...g!==null?{overflowY:"auto"}:{}},children:[g===null?e.jsx(t,{children:Pn.map((d,M)=>e.jsx(Qn,{orientation:"vertical",fullWidth:!0,variant:"outlined",sx:{mb:2,"& .MuiButton-root":{justifyContent:"flex-start",color:ee=>ee.palette.text.secondary,height:50,textAlign:"left"},"& .MuiButton-root .MuiButton-startIcon":{mr:1},"& .MuiButton-root .MuiButton-endIcon":{marginLeft:"auto"},"& .MuiButtonGroup-grouped":{borderColor:"divider"}},children:d.map(ee=>{const be=Dn.find(me=>me.key===ee);return be?e.jsxs(Y,{onClick:ee==="version"?Bn:()=>Tt(`/settings/${ee}`),disableRipple:ee==="version",startIcon:be.icon,endIcon:ee==="version"?void 0:ee==="theme"?e.jsxs(t,{sx:{display:"flex",alignItems:"center",color:me=>me.palette.text.secondary},children:[e.jsx(t,{component:"span",sx:{mr:1,typography:"button"},children:V.name}),e.jsx(Ct,{})]}):ee==="playCombinations"?e.jsxs(t,{sx:{display:"flex",alignItems:"center",color:me=>me.palette.text.secondary},children:[e.jsx(t,{component:"span",sx:{mr:1,typography:"button"},children:L.playCombinationSetting.enabled?"有効":"無効"}),e.jsx(Ct,{})]}):ee==="opponentPlayInputControls"?e.jsxs(t,{sx:{display:"flex",alignItems:"center",color:me=>me.palette.text.secondary},children:[e.jsx(t,{component:"span",sx:{mr:1,typography:"button"},children:L.opponentPlayInputControlSetting.enabled?"有効":"無効"}),e.jsx(Ct,{})]}):e.jsx(Ct,{sx:{color:me=>me.palette.text.secondary}}),children:[be.label,eo.has(ee)&&e.jsx(je,{label:"上級者",size:"small",variant:"outlined",sx:{ml:1,backgroundColor:"transparent",borderColor:me=>me.palette.primary.main,color:me=>me.palette.primary.main}}),ee==="version"&&e.jsx(t,{component:"span",sx:{ml:"auto",color:me=>me.palette.text.secondary},children:"0.0.0"})]},ee):null})},M))}):null,g!==null&&e.jsx(t,{sx:{mt:0,flexGrow:1,overflowY:"visible"},children:e.jsx(al,{mode:"wait",children:g&&e.jsxs(Qr,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[g==="teams"&&e.jsx(Yl,{teams:S,setTeams:de,setMembers:x,selectedTeam:C,setSelectedTeam:q,createTeam:Rn,showSnackbar:c}),g==="members"&&(S.length===0?e.jsxs(et,{severity:"info",children:["チームを登録するとメンバーを設定できるようになります",e.jsx("br",{}),e.jsx(Dt,{component:tl,to:"/settings/teams",children:"チーム設定へ"})]}):C&&e.jsx(Xl,{teams:S,members:n,setMembers:x,selectedTeam:C,setSelectedTeam:q,showSnackbar:c})),g==="scores"&&e.jsx(Zl,{openAddPlayDialog:Mn,playCategories:a,setPlayCategories:s,openEditPlayDialog:En,scoreInput:L,renderIcon:Vn,rallyCategoryTags:Fe,handlePlayDelete:$n,openAddDetailDialog:An,playDetails:Le,setPlayDetails:Ue,openEditDetailDialog:Wn,theme:V,rallyDetailTags:h,handleDetailDelete:Ln}),g==="playCombinations"&&e.jsx(nr,{playCombinationSetting:L.playCombinationSetting,onChange:d=>ue(M=>({...M,playCombinationSetting:d})),playCategories:a,playDetails:Le,showSnackbar:c}),g==="opponentPlayInputControls"&&e.jsx(gr,{opponentPlayInputControlSetting:L.opponentPlayInputControlSetting,onChange:d=>ue(M=>({...M,opponentPlayInputControlSetting:d})),playCategories:a,playDetails:Le,playCombinationSetting:L.playCombinationSetting,setAppBarLeftAction:z,themeSetting:V}),g==="stats"&&e.jsx(jr,{statsSettings:at,setStatsSettings:zt,playCategories:a,playDetails:Le,rallyCategoryTags:Fe,rallyDetailTags:h,showSnackbar:c}),g==="tags"&&e.jsx(fr,{tags:Ze,setTags:$t,rallyCategoryTags:Fe,setRallyCategoryTags:St,rallyDetailTags:h,setRallyDetailTags:I,setMatches:xt,setPlayCategories:s,setPlayDetails:Ue,showSnackbar:c}),g==="locks"&&e.jsx(Mr,{teams:S,matches:Qe,tags:Ze,matchLocks:pe,setMatchLocks:Oe,lockGroupBy:Sn,setLockGroupBy:Tn}),g==="theme"&&e.jsx(Sr,{theme:V,onThemeChange:F,adminMode:Q}),g==="display"&&e.jsx(Rr,{scoreInput:L,onScoreInputChange:ue,dashboardVisible:B,onDashboardVisibleChange:$,showSnackbar:c,adminMode:Q}),g==="data"&&e.jsx(Gr,{onDeleteData:H,onImportData:E,onExportData:P,showSnackbar:c,teams:S,setTeams:de,setMembers:x,playCategories:a,setPlayCategories:s,setPlayDetails:Ue,adminMode:Q}),g==="license"&&e.jsx(Zr,{})]},g)})}),e.jsxs(Je,{open:wt,onClose:Hs,children:[e.jsxs(De,{children:["プレー区分",i===-1?"追加":"編集"]}),e.jsxs(Pe,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[e.jsx(we,{label:"プレー区分",value:m,onChange:d=>N(d.target.value),fullWidth:!0,margin:"dense"}),e.jsx(we,{label:"色",type:"color",value:te,onChange:d=>Z(d.target.value),margin:"dense",InputLabelProps:{shrink:!0},fullWidth:!0}),e.jsx(Pt,{multiple:!0,options:Fe,getOptionLabel:d=>d.name,value:Fe.filter(d=>ne.includes(d.id)),onChange:(d,M)=>xe(M.map(ee=>ee.id)),renderTags:(d,M)=>d.map((ee,be)=>{const{key:me,...Jt}=M({index:be});return e.jsx(je,{...Jt,label:ee.name,size:"small",sx:{backgroundColor:ee.color||ye,color:"#fff"}},me)}),renderInput:d=>e.jsx(we,{...d,label:"タグ",margin:"dense"})}),e.jsxs(et,{severity:"info",children:["プレー区分タグは設定＞タグメニューにて追加できます",e.jsx("br",{}),"プレー区分にタグを設定することにより、プレー区分を横串で集計することが可能となります"]}),e.jsxs(Ae,{exclusive:!0,value:Xe?"表示":"非表示",onChange:(d,M)=>M&&ft(M==="表示"),fullWidth:!0,children:[e.jsxs(ve,{value:"表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Ge,{sx:{mr:1}}),"表示"]}),e.jsxs(ve,{value:"非表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(qe,{sx:{mr:1}}),"非表示"]})]}),L.showRallyIcons&&e.jsxs(e.Fragment,{children:[e.jsxs(Ae,{exclusive:!0,value:X,onChange:(d,M)=>M&&re(M),children:[e.jsx(ve,{value:"設定なし",children:"設定なし"}),e.jsx(ve,{value:"SVG",children:"SVG"}),e.jsx(ve,{value:"画像",children:"画像"})]}),X==="SVG"&&e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{width:64,height:64},dangerouslySetInnerHTML:{__html:Zs(Ce)}}),e.jsx(we,{multiline:!0,minRows:10,label:"SVG",value:Ce,onChange:d=>r(d.target.value),fullWidth:!0,margin:"dense"})]}),X==="画像"&&e.jsxs(e.Fragment,{children:[u&&e.jsx(to,{src:u,cropX:K,cropY:G,onChange:(d,M)=>{U(d),ae(M)}}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/bmp,image/tiff,image/gif",onChange:d=>{var be;const M=(be=d.target.files)==null?void 0:be[0];if(!M)return;const ee=new FileReader;ee.onload=()=>{D(ee.result)},ee.readAsDataURL(M)}})]})]})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:Hs,color:"inherit",startIcon:e.jsx(Ee,{}),children:"キャンセル"}),e.jsx(Y,{onClick:zn,disabled:m.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(Je,{open:kn,onClose:Ws,children:[e.jsxs(De,{children:["プレー詳細",yt===-1?"追加":"編集"]}),e.jsxs(Pe,{children:[e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"detail-category-label",children:"プレー区分"}),e.jsx(He,{labelId:"detail-category-label",value:At,label:"プレー区分",onChange:d=>Wt(d.target.value),children:a.map(d=>e.jsx(ce,{value:d.id,children:d.name},d.id))})]}),e.jsx(we,{fullWidth:!0,label:"プレー詳細",value:kt,onChange:d=>Nt(d.target.value),margin:"dense"}),e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"detail-point-label",children:"得点区分"}),e.jsxs(He,{labelId:"detail-point-label",value:Lt,label:"得点区分",onChange:d=>Ft(d.target.value),children:[e.jsx(ce,{value:"得点",children:"得点"}),e.jsx(ce,{value:"失点",children:"失点"})]})]}),e.jsxs($e,{fullWidth:!0,margin:"dense",children:[e.jsx(We,{id:"detail-point-unit-label",children:"得失点単位区分"}),e.jsxs(He,{labelId:"detail-point-unit-label",value:Bt,label:"得失点単位区分",onChange:d=>Vt(d.target.value),disabled:yt!==-1,children:[e.jsx(ce,{value:"メンバー",children:"メンバー"}),e.jsx(ce,{value:"チーム",children:"チーム"})]})]}),e.jsx(et,{severity:"warning",sx:{whiteSpace:"pre-line",mt:1},children:`得失点単位区分は追加時にのみ設定でき、後から変更できません
再設定する場合はプレー詳細を作り直してください`}),e.jsx(Pt,{multiple:!0,options:h,getOptionLabel:d=>d.name,value:h.filter(d=>Ut.includes(d.id)),onChange:(d,M)=>Gt(M.map(ee=>ee.id)),renderTags:(d,M)=>d.map((ee,be)=>{const me=ee.color||ye,{key:Jt,...Un}=M({index:be});return e.jsx(je,{...Un,label:ee.name,size:"small",sx:{backgroundColor:me,color:"#fff"}},Jt)}),renderInput:d=>e.jsx(we,{...d,label:"タグ",margin:"dense"})}),e.jsxs(et,{severity:"info",sx:{mt:1},children:["プレー詳細タグは設定＞タグメニューにて追加できます",e.jsx("br",{}),"プレー詳細にタグを設定することにより、プレー詳細を横串で集計することが可能となります"]}),e.jsxs(Ae,{exclusive:!0,value:qt?"表示":"非表示",onChange:(d,M)=>M&&Kt(M==="表示"),fullWidth:!0,sx:{mt:2},children:[e.jsxs(ve,{value:"表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Ge,{sx:{mr:1}}),"表示"]}),e.jsxs(ve,{value:"非表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(qe,{sx:{mr:1}}),"非表示"]})]})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:Ws,color:"inherit",startIcon:e.jsx(Ee,{}),children:"キャンセル"}),e.jsx(Y,{onClick:Nn,disabled:kt.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(gt,{open:Et,onClose:As,children:[e.jsx(De,{children:"削除確認"}),e.jsxs(Pe,{sx:{mt:2},children:["このプレー区分を削除しますか？",e.jsx(t,{sx:{mt:1},children:"削除すると、すでに入力されている試合のスコアや分析に影響が出る可能性があります。"})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:As,color:"inherit",startIcon:e.jsx(Ee,{}),children:"キャンセル"}),e.jsx(Y,{onClick:Hn,color:"error",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(gt,{open:_n,onClose:Ns,children:[e.jsx(De,{children:"削除確認"}),e.jsxs(Pe,{sx:{mt:2},children:["このプレー詳細を削除しますか？",e.jsx(t,{sx:{mt:1},children:"削除すると、すでに入力されている試合のスコアや分析に影響が出る可能性があります。"})]}),e.jsxs(Me,{children:[e.jsx(Y,{onClick:Ns,color:"inherit",startIcon:e.jsx(Ee,{}),children:"キャンセル"}),e.jsx(Y,{onClick:Fn,color:"error",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}export{xo as default};
