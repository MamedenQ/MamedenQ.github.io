import{i as be,j as e,a as Vs,B as t,r as V,f as qe,g as Xe,h as Ze,k as ye,l as h,m as Qe,I as le,E as Pe,G as Me,X as ve,H as Ee,R as wn,Z as Sn,y as bt,U as Ot,F as De,K as He,S as Oe,M as oe,d as pt,e as We,C as ge,D as ut,a6 as it,A as gt,W as Pt,a7 as mt,a8 as kn,a9 as Tn,aa as Rn,ab as _n,N as Dn}from"./mui-vendor-C85vPdgr.js";import{r as o,b as Dt,u as On,f as Pn,L as Mn}from"./react-vendor-QLNaZ7XN.js";import{r as Ce,u as Fe,e as at,c as et,f as Ye,g as Se,h as Ie,R as ct,d as Ae,a as ze,i as tt,j as ce,D as we,k as xe,l as En,m as zs,n as Qt,_ as zn}from"./index-B-3_ZdWa.js";import{t as Hn,P as ot,a as An,d as Wn}from"./PlayDetailChip-BvY4-tZq.js";import{D as Be,C as Re,P as _e,d as st,u as nt,a as lt}from"./useLongPress-BcrFz37c.js";import{A as $n,m as Nn}from"./motion-vendor-CXcnLVtk.js";import"./chart-vendor-DVL1rbVz.js";var rs={},Ln=be;Object.defineProperty(rs,"__esModule",{value:!0});var Ge=rs.default=void 0,Bn=Ln(Ce()),Fn=e;Ge=rs.default=(0,Bn.default)((0,Fn.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7"}),"VisibilityOutlined");var os={},Un=be;Object.defineProperty(os,"__esModule",{value:!0});var Ke=os.default=void 0,Vn=Un(Ce()),Gn=e;Ke=os.default=(0,Vn.default)((0,Gn.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6m-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14M2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45zm7.5 7.5 2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13m-3.4-3.4 1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53"}),"VisibilityOffOutlined");var is={},Kn=be;Object.defineProperty(is,"__esModule",{value:!0});var Gs=is.default=void 0,qn=Kn(Ce()),Yn=e;Gs=is.default=(0,qn.default)((0,Yn.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined");var as={},Jn=be;Object.defineProperty(as,"__esModule",{value:!0});var es=as.default=void 0,Xn=Jn(Ce()),Zn=e;es=as.default=(0,Xn.default)((0,Zn.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined");var cs={},Qn=be;Object.defineProperty(cs,"__esModule",{value:!0});var Ks=cs.default=void 0,el=Qn(Ce()),tl=e;Ks=cs.default=(0,el.default)((0,tl.jsx)("path",{d:"M4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29M20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24zm-7.76-2.78c-1.17-.52-2.61-.9-4.24-.9-1.63 0-3.07.39-4.24.9C6.68 14.13 6 15.21 6 16.39V18h12v-1.61c0-1.18-.68-2.26-1.76-2.74M8.07 16c.09-.23.13-.39.91-.69.97-.38 1.99-.56 3.02-.56s2.05.18 3.02.56c.77.3.81.46.91.69zM12 8c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0-2c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"GroupsOutlined");var ds={},sl=be;Object.defineProperty(ds,"__esModule",{value:!0});var qs=ds.default=void 0,nl=sl(Ce()),ll=e;qs=ds.default=(0,nl.default)((0,ll.jsx)("path",{d:"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonOutlined");var xs={},rl=be;Object.defineProperty(xs,"__esModule",{value:!0});var Ys=xs.default=void 0,ol=rl(Ce()),il=e;Ys=xs.default=(0,ol.default)((0,il.jsx)("path",{d:"M18 9h-2.5c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1H18c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1m-.5 4.5H16v-3h1.5zm-8 1.5H5v-2.5c0-.55.45-1 1-1h2v-1H5V9h3.5c.55 0 1 .45 1 1v1.5c0 .55-.45 1-1 1h-2v1h3zm3.25-4h-1.5V9.5h1.5zm0 3.5h-1.5V13h1.5zM22 6v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h3V2h2v2h6V2h2v2h3c1.1 0 2 .9 2 2m-2 12V6h-7.25v1.5h-1.5V6H4v12h7.25v-1.5h1.5V18z"}),"ScoreboardOutlined");var hs={},al=be;Object.defineProperty(hs,"__esModule",{value:!0});var Js=hs.default=void 0,cl=al(Ce()),Hs=e;Js=hs.default=(0,cl.default)([(0,Hs.jsx)("path",{d:"m21.41 11.41-8.83-8.83c-.37-.37-.88-.58-1.41-.58H4c-1.1 0-2 .9-2 2v7.17c0 .53.21 1.04.59 1.41l8.83 8.83c.78.78 2.05.78 2.83 0l7.17-7.17c.78-.78.78-2.04-.01-2.83M12.83 20 4 11.17V4h7.17L20 12.83z"},"0"),(0,Hs.jsx)("circle",{cx:"6.5",cy:"6.5",r:"1.5"},"1")],"SellOutlined");var us={},dl=be;Object.defineProperty(us,"__esModule",{value:!0});var gs=us.default=void 0,xl=dl(Ce()),yt=e;gs=us.default=(0,xl.default)([(0,yt.jsx)("path",{d:"M12 22C6.49 22 2 17.51 2 12S6.49 2 12 2s10 4.04 10 9c0 3.31-2.69 6-6 6h-1.77c-.28 0-.5.22-.5.5 0 .12.05.23.13.33.41.47.64 1.06.64 1.67 0 1.38-1.12 2.5-2.5 2.5m0-18c-4.41 0-8 3.59-8 8s3.59 8 8 8c.28 0 .5-.22.5-.5 0-.16-.08-.28-.14-.35-.41-.46-.63-1.05-.63-1.65 0-1.38 1.12-2.5 2.5-2.5H16c2.21 0 4-1.79 4-4 0-3.86-3.59-7-8-7"},"0"),(0,yt.jsx)("circle",{cx:"6.5",cy:"11.5",r:"1.5"},"1"),(0,yt.jsx)("circle",{cx:"9.5",cy:"7.5",r:"1.5"},"2"),(0,yt.jsx)("circle",{cx:"14.5",cy:"7.5",r:"1.5"},"3"),(0,yt.jsx)("circle",{cx:"17.5",cy:"11.5",r:"1.5"},"4")],"PaletteOutlined");var ps={},hl=be;Object.defineProperty(ps,"__esModule",{value:!0});var Xs=ps.default=void 0,ul=hl(Ce()),As=e;Xs=ps.default=(0,ul.default)([(0,As.jsx)("path",{d:"M20 3H4c-1.11 0-2 .89-2 2v12c0 1.1.89 2 2 2h4v2h8v-2h4c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2m0 14H4V5h16z"},"0"),(0,As.jsx)("path",{d:"M6 8.25h8v1.5H6zm10.5 1.5H18v-1.5h-1.5V7H15v4h1.5zm-6.5 2.5h8v1.5h-8zM7.5 15H9v-4H7.5v1.25H6v1.5h1.5z"},"1")],"DisplaySettingsOutlined");var fs={},gl=be;Object.defineProperty(fs,"__esModule",{value:!0});var Zs=fs.default=void 0,pl=gl(Ce()),fl=e;Zs=fs.default=(0,pl.default)((0,fl.jsx)("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"StorageOutlined");var js={},jl=be;Object.defineProperty(js,"__esModule",{value:!0});var Qs=js.default=void 0,ml=jl(Ce()),yl=e;Qs=js.default=(0,ml.default)((0,yl.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");var ms={},bl=be;Object.defineProperty(ms,"__esModule",{value:!0});var en=ms.default=void 0,Cl=bl(Ce()),vl=e;en=ms.default=(0,Cl.default)((0,vl.jsx)("path",{d:"M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"}),"LinkOutlined");function Il({teams:g,setTeams:j,setMembers:O,selectedTeam:y,setSelectedTeam:_,createTeam:I,showSnackbar:N}){const[L,K]=o.useState(!1),[z,G]=o.useState(""),[p,C]=o.useState(null),M=Vs(),J=Fe("md"),{handleTouchEnd:F,setSwiperRef:b,getSwiperRef:U}=at(2),[w,B]=o.useState(""),f="tutorial-team-swipe",[ee,X]=o.useState(()=>J&&g.length>0&&!localStorage.getItem(f)),[re,ie]=o.useState(()=>{var s;return((s=g[0])==null?void 0:s.id)||""}),pe=o.useRef(g.length),he=s=>{if(w){const d=U(w);d&&(d.allowTouchMove=!0),B("")}if(!s.destination)return;const r=Array.from(g),[l]=r.splice(s.source.index,1);r.splice(s.destination.index,0,l),j(r)},ke=()=>{C(-1),G(""),K(!0)},c=s=>{C(s),G(g[s].name),K(!0)},S=()=>{if(p===-1){const s=I(z);j(r=>[...r,s]),O(r=>({...r,[s.id]:[]})),y||_(s.id),J&&!localStorage.getItem(f)&&(ie(s.id),X(!0))}else if(p!==null){const s=g[p].id;j(r=>r.map((l,d)=>d===p?{...l,name:z}:l)),y===s&&_(s)}K(!1)},v=()=>{K(!1)},T=s=>{var Y;const r=g[s];let l=[];O(Z=>{l=Z[r.id]||[];const q={...Z};return delete q[r.id],q});const d=y,R=g.filter((Z,q)=>q!==s);j(R),y===r.id&&_(((Y=R[0])==null?void 0:Y.id)||""),N("チームを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{j(Z=>{const q=[...Z];return q.splice(s,0,r),q}),O(Z=>({...Z,[r.id]:l})),_(d)},autoHideDuration:5e3})};o.useEffect(()=>{J&&g.length>0&&pe.current===0&&!localStorage.getItem(f)&&(ie(g[0].id),X(!0)),pe.current=g.length},[g,J]);const u=({t:s,idx:r,dragProvided:l})=>{const d=l.dragHandleProps,{onPointerDown:R,...Y}=d||{},Z=nt(q=>{R==null||R(q);const ne=U(s.id);ne&&(ne.allowTouchMove=!1),B(s.id)});return e.jsx(t,{ref:l.innerRef,...l.draggableProps,style:l.draggableProps.style,children:e.jsx(wn,{open:ee&&re===s.id,onClose:()=>X(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Sn,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${M.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${M.palette.text.secondary}`}}}},title:e.jsxs(t,{sx:{p:1,maxWidth:260},children:[e.jsx(bt,{variant:"body2",sx:{whiteSpace:"pre-line"},children:Hn.teamSwipe.text}),e.jsx(t,{sx:{textAlign:"right",mt:1},children:e.jsx(Ot,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem(f,"1"),X(!1)},children:"了解した"})})]}),children:e.jsx(t,{children:e.jsxs(tt,{onSwiper:q=>b(s.id,q),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(q,ne)=>ne.stopPropagation(),onTouchEnd:q=>F(s.id,q),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...Y,...Z,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:w===s.id?"none":"pan-y",cursor:"grab"},children:e.jsx(t,{sx:{flexGrow:1},children:s.name})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>c(r),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>T(r),children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})})})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(V,{onClick:ke,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})}),e.jsx(Ye,{component:qe,storageKey:"teams-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:he,children:J?e.jsx(Re,{droppableId:"teams",children:s=>e.jsxs(t,{ref:s.innerRef,...s.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:e.jsx(t,{sx:{flexGrow:1},children:"チーム名"})}),g.map((r,l)=>e.jsx(_e,{draggableId:r.id,index:l,children:d=>e.jsx(u,{t:r,idx:l,dragProvided:d})},r.id)),s.placeholder]})}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:s=>s.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{}),e.jsx(h,{children:"チーム名"}),e.jsx(h,{})]})}),e.jsx(Re,{droppableId:"teams",children:s=>e.jsxs(Qe,{ref:s.innerRef,...s.droppableProps,children:[g.map((r,l)=>e.jsx(_e,{draggableId:r.id,index:l,children:d=>e.jsxs(ye,{ref:d.innerRef,...d.draggableProps,style:d.draggableProps.style,onClick:()=>c(l),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",onClick:R=>R.stopPropagation(),children:e.jsx(t,{onClick:R=>R.stopPropagation(),...d.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:r.name}),e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:R=>R.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:()=>T(l),sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:"error"})})})})]})},r.id)),s.placeholder]})})]})})})]}),e.jsxs(ct,{open:L,onClose:v,children:[e.jsxs(Pe,{children:["チーム名",p===-1?"追加":"編集"]}),e.jsx(Me,{sx:{mt:2},children:e.jsx(ve,{label:"チーム名",value:z,onChange:s=>G(s.target.value),fullWidth:!0,margin:"dense"})}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:v,startIcon:e.jsx(Ae,{}),color:"inherit",sx:{color:{xs:"black",md:"inherit"}},children:"キャンセル"}),e.jsx(V,{onClick:S,disabled:z.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}const Ws=32,qt=80,Yt=200,Jt=200,Xt=64,wl=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function Sl({teams:g,members:j,setMembers:O,selectedTeam:y,setSelectedTeam:_,showSnackbar:I}){const[N,L]=o.useState(null),[K,z]=o.useState(""),[G,p]=o.useState(""),[C,M]=o.useState([]),[J,F]=o.useState(!0),[b,U]=o.useState(!1),w=Fe("md"),B=Fe("sm"),f=Yt+16+(B?0:qt+Jt+Xt),{handleTouchEnd:ee,setSwiperRef:X,getSwiperRef:re}=at(2),[ie,pe]=o.useState(""),he=s=>{if(ie){const d=re(ie);d&&(d.allowTouchMove=!0),pe("")}if(!s.destination||!y)return;const r=Array.from(j[y]||[]),[l]=r.splice(s.source.index,1);r.splice(s.destination.index,0,l),O(d=>({...d,[y]:r}))},ke=()=>{L(-1),z(""),p(""),M([]),F(!0),U(!0)},c=s=>{L(s);const r=j[y][s];z(String(r.no)),p(r.name),M(r.positions||[]),F(r.visible!==!1),U(!0)},S=()=>{y&&(N===-1?O(s=>({...s,[y]:[...s[y]||[],{id:wl(),no:Number(K),name:G,positions:C,visible:J}]})):N!==null&&O(s=>({...s,[y]:s[y].map((r,l)=>l===N?{...r,no:Number(K),name:G,positions:C,visible:J}:r)})),U(!1))},v=()=>{U(!1)},T=s=>{if(!y)return;let r;O(l=>{const d=[...l[y]||[]];r=d[s];const R=d.filter((Y,Z)=>Z!==s);return{...l,[y]:R}}),I("メンバーを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{r&&O(l=>{const d=[...l[y]||[]];return d.splice(s,0,r),{...l,[y]:d}})},autoHideDuration:5e3})},u=({m:s,idx:r,dragProvided:l})=>{const d=l.dragHandleProps,{onPointerDown:R,...Y}=d||{},Z=nt(q=>{R==null||R(q);const ne=re(s.id);ne&&(ne.allowTouchMove=!1),pe(s.id)});return e.jsx(t,{ref:l.innerRef,...l.draggableProps,style:l.draggableProps.style,children:e.jsxs(tt,{onSwiper:q=>X(s.id,q),threshold:20,slidesPerView:"auto",style:{overflow:"hidden",width:"100%",minWidth:f},onTouchStart:(q,ne)=>ne.stopPropagation(),onTouchEnd:q=>ee(s.id,q),children:[e.jsx(ce,{style:{width:"100%",minWidth:f,flex:"0 0 auto"},children:e.jsxs(t,{...Y,...Z,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:ie===s.id?"none":"pan-y",width:"100%",minWidth:f},children:[!B&&e.jsx(t,{sx:{width:qt},children:s.no}),e.jsx(t,{sx:{width:Yt,flexShrink:0,whiteSpace:"nowrap",overflow:"hidden"},children:s.name}),!B&&e.jsx(t,{sx:{width:Jt,whiteSpace:"nowrap",overflow:"hidden"},children:(s.positions||[]).join(", ")}),!B&&e.jsx(t,{sx:{width:Xt,display:"flex",justifyContent:"center"},children:s.visible===!1?e.jsx(Ke,{}):e.jsx(Ge,{})})]})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>c(r),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>T(r),children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"team-select-label",children:"チーム"}),e.jsx(Oe,{labelId:"team-select-label",value:y,label:"チーム",onChange:s=>_(s.target.value),children:g.map(s=>e.jsx(oe,{value:s.id,children:s.name},s.id))})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mt:2,mb:1},children:e.jsx(V,{onClick:ke,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})}),e.jsx(Ye,{component:qe,storageKey:"members-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:he,children:w?e.jsx(Re,{droppableId:"members",children:s=>{var r;return e.jsxs(t,{ref:s.innerRef,...s.droppableProps,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",width:"100%",minWidth:f,...Se},children:[!B&&e.jsx(t,{sx:{width:qt},children:"番号"}),e.jsx(t,{sx:{width:Yt,flexShrink:0},children:"名前"}),!B&&e.jsx(t,{sx:{width:Jt},children:"ポジション"}),!B&&e.jsx(t,{sx:{width:Xt,textAlign:"center"},children:"表示"})]}),(r=j[y])==null?void 0:r.map((l,d)=>e.jsx(_e,{draggableId:l.id,index:d,children:R=>e.jsx(u,{m:l,idx:d,dragProvided:R})},l.id)),s.placeholder]})}}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:s=>s.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{}),e.jsx(h,{children:"番号"}),e.jsx(h,{children:"名前"}),!B&&e.jsx(h,{children:"ポジション"}),e.jsx(h,{children:"表示"}),e.jsx(h,{})]})}),e.jsx(Re,{droppableId:"members",children:s=>{var r;return e.jsxs(Qe,{ref:s.innerRef,...s.droppableProps,children:[(r=j[y])==null?void 0:r.map((l,d)=>e.jsx(_e,{draggableId:l.id,index:d,children:R=>e.jsxs(ye,{ref:R.innerRef,...R.draggableProps,"data-index":d,onClick:()=>c(d),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:Y=>Y.stopPropagation(),...R.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:Ws,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:l.no}),e.jsx(h,{children:l.name}),!B&&e.jsx(h,{children:(l.positions||[]).join(", ")}),e.jsx(h,{children:l.visible===!1?e.jsx(Ke,{}):e.jsx(Ge,{})}),e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:Y=>Y.stopPropagation(),sx:{width:Ws,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:()=>T(d),sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:"error"})})})})]})},l.id)),s.placeholder]})}})]})})})]}),e.jsxs(ct,{open:b,onClose:v,children:[e.jsxs(Pe,{children:["メンバー",N===-1?"追加":"編集"]}),e.jsxs(Me,{children:[e.jsx(ve,{label:"番号",type:"number",value:K,onChange:s=>z(s.target.value),fullWidth:!0,margin:"dense"}),e.jsx(ve,{label:"名前",value:G,onChange:s=>p(s.target.value),fullWidth:!0,margin:"dense"}),e.jsxs(De,{margin:"dense",fullWidth:!0,children:[e.jsx(He,{id:"positions-label",children:"ポジション"}),e.jsxs(Oe,{labelId:"positions-label",multiple:!0,value:C,label:"ポジション",onChange:s=>M(typeof s.target.value=="string"?s.target.value.split(","):s.target.value),renderValue:s=>s.join(", "),children:[e.jsx(oe,{value:"レフト",children:"レフト"}),e.jsx(oe,{value:"センター",children:"センター"}),e.jsx(oe,{value:"ライト",children:"ライト"}),e.jsx(oe,{value:"セッター",children:"セッター"}),e.jsx(oe,{value:"リベロ",children:"リベロ"})]})]}),e.jsxs(pt,{value:J?"visible":"hidden",exclusive:!0,onChange:(s,r)=>r&&F(r==="visible"),fullWidth:!0,sx:{display:"flex",mt:1},children:[e.jsxs(We,{value:"visible",sx:{flex:1,whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(Ge,{sx:{mr:1}}),"表示"]}),e.jsxs(We,{value:"hidden",sx:{flex:1,whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(Ke,{sx:{mr:1}}),"非表示"]})]})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:v,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:S,disabled:K==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}const $s=!1;function kl({openAddPlayDialog:g,playCategories:j,setPlayCategories:O,openEditPlayDialog:y,scoreInput:_,renderIcon:I,rallyCategoryTags:N,handlePlayDelete:L,openAddDetailDialog:K,playDetails:z,setPlayDetails:G,openEditDetailDialog:p,theme:C,rallyDetailTags:M,handleDetailDelete:J}){const F=c=>{if(re){const T=X(re);T&&(T.allowTouchMove=!0),ie("")}if(!c.destination)return;const S=Array.from(j),[v]=S.splice(c.source.index,1);S.splice(c.destination.index,0,v),O(S)},b=Dt.useMemo(()=>{const c={};return j.forEach(S=>{c[S.id]=[]}),z.forEach((S,v)=>{(c[S.playCategoryId]||(c[S.playCategoryId]=[])).push(v)}),c},[j,z]),U=c=>{if(re){const R=X(re);R&&(R.allowTouchMove=!0),ie("")}const{source:S,destination:v}=c;if(!v||S.droppableId!==v.droppableId)return;const T=S.droppableId,u=T==="play-details"?Object.values(b).flat():b[T.replace("play-details-","")];if(!u)return;const s=u[S.index],r=u[v.index],l=Array.from(z),[d]=l.splice(s,1);l.splice(r,0,d),G(l)},w=Fe("md"),B=Fe("sm"),{handleTouchEnd:f,setSwiperRef:ee,getSwiperRef:X}=at(2),[re,ie]=Dt.useState("");let pe=0;const he=({p:c,idx:S,dragProvided:v})=>{const T=v.dragHandleProps,{onPointerDown:u,...s}=T||{},r=nt(l=>{u==null||u(l);const d=X(c.id);d&&(d.allowTouchMove=!1),ie(c.id)});return e.jsx(t,{ref:v.innerRef,...v.draggableProps,style:v.draggableProps.style,children:e.jsxs(tt,{onSwiper:l=>ee(c.id,l),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(l,d)=>d.stopPropagation(),onTouchEnd:l=>f(c.id,l),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{...s,...r,sx:{display:"grid",gridTemplateColumns:B?"1fr":"1fr 1fr 1fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:re===c.id?"none":"pan-y",cursor:"grab"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(ge,{label:c.name,size:"small",variant:"outlined",sx:{backgroundColor:"transparent",borderColor:c.color,color:c.color}}),_.showRallyIcons&&e.jsx(t,{children:I(c)})]}),!B&&e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:(c.tags||[]).map(l=>{const d=N.find(Y=>Y.id===l),R=(d==null?void 0:d.color)||xe;return e.jsx(ge,{label:(d==null?void 0:d.name)||l,size:"small",sx:{backgroundColor:R,color:"#fff"}},l)})}),!B&&e.jsx(t,{sx:{display:"flex",alignItems:"center"},children:c.visible===!1?e.jsx(Ke,{}):e.jsx(Ge,{})})]})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>y(S),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>L(S),disabled:c.id==="init-serve",children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},ke=({d:c,i:S,dragProvided:v})=>{const T=v.dragHandleProps,{onPointerDown:u,...s}=T||{},r=nt(l=>{u==null||u(l);const d=X(c.id);d&&(d.allowTouchMove=!1),ie(c.id)});return e.jsx(t,{ref:v.innerRef,...v.draggableProps,style:v.draggableProps.style,children:e.jsxs(tt,{onSwiper:l=>ee(c.id,l),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(l,d)=>d.stopPropagation(),onTouchEnd:l=>f(c.id,l),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{...s,...r,sx:{display:"grid",gridTemplateColumns:B?"1fr":"1fr 1fr 1fr 1fr 0.3fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:re===c.id?"none":"pan-y",cursor:"grab"},children:[e.jsx(t,{children:e.jsx(ge,{label:c.name,size:"small",sx:{backgroundColor:c.pointType==="得点"?C.scoreColor:C.lossColor,border:`1px solid ${c.pointType==="得点"?C.scoreColor:C.lossColor}`,color:"#fff"}})}),!B&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:c.pointType}),e.jsx(t,{children:c.pointUnitType}),e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:(c.tags||[]).map(l=>{const d=M.find(Y=>Y.id===l),R=(d==null?void 0:d.color)||xe;return e.jsx(ge,{label:(d==null?void 0:d.name)||l,size:"small",sx:{backgroundColor:R,color:"#fff"}},l)})}),e.jsx(t,{sx:{display:"flex",alignItems:"center"},children:c.visible===!1?e.jsx(Ke,{}):e.jsx(Ge,{})})]})]})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>p(S),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>J(S),children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})};return e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(V,{onClick:g,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})}),e.jsx(Ye,{component:qe,storageKey:"play-category-grid",sx:{maxWidth:1024,mx:"auto"},children:w?e.jsx(Be,{onDragEnd:F,children:e.jsx(Re,{droppableId:"play-categories",children:c=>e.jsxs(t,{ref:c.innerRef,...c.droppableProps,children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:B?"1fr":"1fr 1fr 1fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:[e.jsx(t,{children:"プレー区分"}),!B&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"ラリー区分タグ"}),e.jsx(t,{children:"表示"})]})]}),j.map((S,v)=>e.jsx(_e,{draggableId:S.id,index:v,children:T=>e.jsx(he,{p:S,idx:v,dragProvided:T})},S.id)),c.placeholder]})})}):e.jsxs(Xe,{size:"small",sx:{minWidth:600},children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:c=>c.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{sx:{width:48}}),e.jsx(h,{children:"プレー区分"}),$s,_.showRallyIcons&&e.jsx(h,{children:"アイコン"}),e.jsx(h,{children:"タグ"}),e.jsx(h,{children:"表示"}),e.jsx(h,{})]})}),e.jsx(Be,{onDragEnd:F,children:e.jsx(Re,{droppableId:"play-categories",children:c=>e.jsxs(Qe,{ref:c.innerRef,...c.droppableProps,children:[j.map((S,v)=>e.jsx(_e,{draggableId:S.id,index:v,children:T=>e.jsxs(ye,{ref:T.innerRef,...T.draggableProps,"data-index":v,onClick:()=>y(v),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",sx:{width:48},children:e.jsx(t,{onClick:u=>u.stopPropagation(),...T.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:e.jsx(ge,{label:S.name,size:"small",variant:"outlined",sx:{backgroundColor:"transparent",borderColor:S.color,color:S.color}})}),$s,_.showRallyIcons&&e.jsx(h,{children:I(S)}),e.jsx(h,{children:(S.tags||[]).map(u=>{const s=N.find(l=>l.id===u),r=(s==null?void 0:s.color)||xe;return e.jsx(ge,{label:(s==null?void 0:s.name)||u,size:"small",sx:{mr:.5,mb:.5,backgroundColor:r,color:"#fff"}},u)})}),e.jsx(h,{children:S.visible===!1?e.jsx(Ke,{}):e.jsx(Ge,{})}),e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:u=>u.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:S.id==="init-serve"?void 0:()=>L(v),disabled:S.id==="init-serve",sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:S.id==="init-serve"?"disabled":"error"})})})})]})},S.id)),c.placeholder]})})})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1,mt:2},children:e.jsx(V,{onClick:K,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})}),e.jsx(Ye,{component:qe,storageKey:"play-detail-grid",sx:{maxWidth:1024,mx:"auto"},children:w?e.jsx(Be,{onDragEnd:U,children:e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:B?"1fr":"1fr 1fr 1fr 1fr 0.3fr",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:[e.jsx(t,{children:"プレー詳細"}),!B&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"得点区分"}),e.jsx(t,{children:"得失点単位区分"}),e.jsx(t,{children:"タグ"}),e.jsx(t,{children:"表示"})]})]}),j.map(c=>{const S=z.map((v,T)=>({d:v,i:T})).filter(({d:v})=>v.playCategoryId===c.id);return e.jsxs(Dt.Fragment,{children:[e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",px:1,borderBottom:1,borderColor:"divider",...Se},children:c.name}),e.jsx(Re,{droppableId:`play-details-${c.id}`,children:v=>e.jsxs(t,{ref:v.innerRef,...v.droppableProps,children:[S.map(({d:T,i:u},s)=>e.jsx(_e,{draggableId:T.id,index:s,children:r=>e.jsx(ke,{d:T,i:u,dragProvided:r})},T.id)),v.placeholder]})})]},c.id)})]})}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:c=>c.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{}),e.jsx(h,{children:"プレー詳細"}),e.jsx(h,{children:"得点区分"}),e.jsx(h,{children:"得失点単位区分"}),e.jsx(h,{children:"タグ"}),e.jsx(h,{children:"表示"}),e.jsx(h,{})]})}),e.jsx(Be,{onDragEnd:U,children:e.jsx(Re,{droppableId:"play-details",children:c=>e.jsxs(Qe,{ref:c.innerRef,...c.droppableProps,children:[j.map(S=>e.jsxs(Dt.Fragment,{children:[e.jsx(ye,{sx:{backgroundColor:v=>v.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:e.jsx(h,{colSpan:7,children:S.name})}),z.map((v,T)=>({d:v,i:T})).filter(({d:v})=>v.playCategoryId===S.id).map(({d:v,i:T})=>{const u=pe++;return e.jsx(_e,{draggableId:v.id,index:u,children:s=>e.jsxs(ye,{ref:s.innerRef,...s.draggableProps,"data-index":T,onClick:()=>p(T),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:r=>r.stopPropagation(),...s.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:e.jsx(ge,{label:v.name,size:"small",sx:{backgroundColor:v.pointType==="得点"?C.scoreColor:C.lossColor,border:`1px solid ${v.pointType==="得点"?C.scoreColor:C.lossColor}`,color:"#fff"}})}),e.jsx(h,{children:v.pointType}),e.jsx(h,{children:v.pointUnitType}),e.jsx(h,{children:(v.tags||[]).map(r=>{const l=M.find(R=>R.id===r),d=(l==null?void 0:l.color)||xe;return e.jsx(ge,{label:(l==null?void 0:l.name)||r,size:"small",sx:{mr:.5,mb:.5,backgroundColor:d,color:"#fff"}},r)})}),e.jsx(h,{children:v.visible===!1?e.jsx(Ke,{}):e.jsx(Ge,{})}),e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:r=>r.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:()=>J(T),sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:"error"})})})})]})},v.id)})]},S.id)),c.placeholder]})})})]})})]})}var ys={},Tl=be;Object.defineProperty(ys,"__esModule",{value:!0});var ts=ys.default=void 0,Rl=Tl(Ce()),_l=e;ts=ys.default=(0,Rl.default)((0,_l.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy");function Dl({open:g,playCategories:j,playDetails:O,initial:y,onSave:_,onClose:I}){const[N,L]=o.useState(""),[K,z]=o.useState(""),[G,p]=o.useState(""),[C,M]=o.useState("");o.useEffect(()=>{if(y){const w=O.find(f=>f.id===y.sourceDetailId),B=O.find(f=>f.id===y.targetDetailId);L((w==null?void 0:w.playCategoryId)||""),z(y.sourceDetailId),p((B==null?void 0:B.playCategoryId)||""),M(y.targetDetailId)}else L(""),z(""),p(""),M("")},[y,O]);const J=()=>{_({enabled:(y==null?void 0:y.enabled)??!0,sourceDetailId:K,targetDetailId:C})},F=O.filter(w=>w.playCategoryId===N&&w.visible!==!1),b=O.filter(w=>w.playCategoryId===G&&w.visible!==!1),U=!K||!C;return e.jsxs(ut,{open:g,onClose:I,fullWidth:!0,children:[e.jsxs(Pe,{children:["組み合わせ",y?"編集":"追加"]}),e.jsxs(Me,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(t,{sx:{display:"flex",gap:2},children:[e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"source-cat",children:"自チームプレー区分"}),e.jsx(Oe,{labelId:"source-cat",value:N,label:"自チームプレー区分",onChange:w=>{L(w.target.value),z("")},children:j.filter(w=>w.visible!==!1).map(w=>e.jsx(oe,{value:w.id,children:w.name},w.id))})]}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"target-cat",children:"相手プレー区分"}),e.jsx(Oe,{labelId:"target-cat",value:G,label:"相手プレー区分",onChange:w=>{p(w.target.value),M("")},children:j.filter(w=>w.visible!==!1).map(w=>e.jsx(oe,{value:w.id,children:w.name},w.id))})]})]}),e.jsxs(t,{sx:{display:"flex",gap:2},children:[e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"source-detail",children:"自チームプレー詳細"}),e.jsx(Oe,{labelId:"source-detail",value:K,label:"自チームプレー詳細",onChange:w=>z(w.target.value),children:F.map(w=>e.jsx(oe,{value:w.id,children:w.name},w.id))})]}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"target-detail",children:"相手プレー詳細"}),e.jsx(Oe,{labelId:"target-detail",value:C,label:"相手プレー詳細",onChange:w=>M(w.target.value),children:b.map(w=>e.jsx(oe,{value:w.id,children:w.name},w.id))})]})]})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:I,color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:()=>{J(),I()},disabled:U,children:"保存"})]})]})}function Ol({playCombinationSetting:g,onChange:j,playCategories:O,playDetails:y,showSnackbar:_}){const[I,N]=o.useState([...g.pairs]),[L,K]=o.useState(g.enabled),[z,G]=o.useState(!1),[p,C]=o.useState(null),M=Vs(),J=Fe("md"),{handleTouchEnd:F,setSwiperRef:b,getSwiperRef:U}=at(3),[w,B]=o.useState(""),f=(u,s=L)=>{K(s),typeof u=="function"?N(r=>{const l=u(r);return j({enabled:s,pairs:l}),l}):(N(u),j({enabled:s,pairs:u}))},ee=u=>{if(w){const l=U(w);l&&(l.allowTouchMove=!0),B("")}if(!u.destination)return;const s=Array.from(I),[r]=s.splice(u.source.index,1);s.splice(u.destination.index,0,r),f(s)},X=u=>{f([...I,u])},re=(u,s)=>{const r=[...I];r[u]=s,f(r)},ie=u=>{const s=I[u];f(I.filter((r,l)=>l!==u)),_("組み合わせを削除しました","success",{actionLabel:"元に戻す",onAction:()=>f(r=>{const l=[...r];return l.splice(u,0,s),l}),autoHideDuration:5e3})},pe=u=>{f([...I,{...I[u]}])},he=({p:u,idx:s,sDetail:r,tDetail:l,prov:d})=>{var R,Y,Z,q;return e.jsxs(t,{ref:d.innerRef,...d.draggableProps,onClick:()=>{C(s),G(!0)},sx:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",alignItems:"center",p:1,borderBottom:1,borderColor:"divider",cursor:"pointer"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,minWidth:0},children:[e.jsx(t,{...d.dragHandleProps,sx:{display:"flex",alignItems:"center"},children:e.jsx(st,{})}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ot,{label:v((r==null?void 0:r.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(R=S((r==null?void 0:r.playCategoryId)||""))==null?void 0:R.color,borderColor:(Y=S((r==null?void 0:r.playCategoryId)||""))==null?void 0:Y.color}}),e.jsx(ot,{label:(r==null?void 0:r.name)||"",sx:{bgcolor:T(r),color:"common.white"}})]})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ot,{label:v((l==null?void 0:l.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(Z=S((l==null?void 0:l.playCategoryId)||""))==null?void 0:Z.color,borderColor:(q=S((l==null?void 0:l.playCategoryId)||""))==null?void 0:q.color}}),e.jsx(ot,{label:(l==null?void 0:l.name)||"",sx:{bgcolor:T(l),color:"common.white"}})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"flex-start",justifySelf:"flex-start",width:1,minWidth:0},children:[e.jsx(it,{sx:{ml:0},checked:u.enabled,onChange:ne=>{const fe=[...I];fe[s]={...u,enabled:ne.target.checked},f(fe)}}),e.jsx(le,{size:"small",sx:{ml:"auto"},onClick:ne=>{ne.stopPropagation(),pe(s)},children:e.jsx(ts,{fontSize:"small"})}),e.jsx(le,{size:"small",onClick:ne=>{ne.stopPropagation(),ie(s)},children:e.jsx(Ie,{fontSize:"small",color:"error"})})]})]})},ke=({p:u,idx:s,sDetail:r,tDetail:l,prov:d})=>{var k,W,E,H;const R=String(s),Y=o.useRef(null),[Z,q]=o.useState(0);o.useLayoutEffect(()=>{var te;const se=((te=Y.current)==null?void 0:te.offsetHeight)??0;se&&se!==Z&&q(se)},[r,l,Z]);const ne=d.dragHandleProps,{onPointerDown:fe,...n}=ne||{},x=nt(se=>{fe==null||fe(se);const te=U(R);te&&(te.allowTouchMove=!1),B(R)});return e.jsx(t,{ref:d.innerRef,...d.draggableProps,children:e.jsxs(tt,{onSwiper:se=>b(R,se),threshold:20,slidesPerView:"auto",style:{overflow:"hidden",height:Z||void 0},onTouchStart:(se,te)=>te.stopPropagation(),onTouchEnd:se=>F(R,se),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{ref:Y,...n,...x,sx:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",alignItems:"center",p:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:w===R?"none":"pan-y",cursor:"grab"},children:[e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ot,{label:v((r==null?void 0:r.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(k=S((r==null?void 0:r.playCategoryId)||""))==null?void 0:k.color,borderColor:(W=S((r==null?void 0:r.playCategoryId)||""))==null?void 0:W.color}}),e.jsx(ot,{label:(r==null?void 0:r.name)||"",sx:{bgcolor:T(r),color:"common.white"}})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"flex-start",minWidth:0},children:[e.jsx(ot,{label:v((l==null?void 0:l.playCategoryId)||""),variant:"outlined",sx:{bgcolor:"transparent",color:(E=S((l==null?void 0:l.playCategoryId)||""))==null?void 0:E.color,borderColor:(H=S((l==null?void 0:l.playCategoryId)||""))==null?void 0:H.color}}),e.jsx(ot,{label:(l==null?void 0:l.name)||"",sx:{bgcolor:T(l),color:"common.white"}})]}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-start",justifySelf:"flex-start",width:1,minWidth:0},children:e.jsx(it,{sx:{ml:0},checked:u.enabled,onChange:se=>{const te=[...I];te[s]={...u,enabled:se.target.checked},f(te)}})})]})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto",height:Z||void 0},children:e.jsx(t,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>{C(s),G(!0)},children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto",height:Z||void 0},children:e.jsx(t,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"secondary.main"},children:e.jsx(le,{size:"small",onClick:()=>{pe(s)},children:e.jsx(ts,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto",height:Z||void 0},children:e.jsx(t,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>{ie(s)},children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},c=u=>y.find(s=>s.id===u),S=u=>O.find(s=>s.id===u),v=u=>{var s;return((s=S(u))==null?void 0:s.name)||""},T=u=>(u==null?void 0:u.pointType)==="得点"?M.palette.success.main:(u==null?void 0:u.pointType)==="失点"?M.palette.error.main:void 0;return e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",flexDirection:"row",gap:.5,mb:1,maxWidth:1024,justifyContent:"space-between",margin:"auto"},children:[e.jsxs(t,{children:[e.jsx(it,{checked:L,onChange:u=>f(I,u.target.checked)}),"自動反映"]}),e.jsx(V,{onClick:()=>{C(null),G(!0)},variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})]}),e.jsx(Ye,{component:qe,storageKey:"play-combination-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:ee,children:e.jsx(Re,{droppableId:"pairs",children:u=>e.jsxs(t,{ref:u.innerRef,...u.droppableProps,children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",borderTopLeftRadius:s=>s.shape.borderRadius,borderTopRightRadius:s=>s.shape.borderRadius,...Se},children:[e.jsx(t,{sx:{minWidth:0,pl:J?0:4},children:"入力"}),e.jsx(t,{sx:{minWidth:0},children:"相手"}),e.jsx(t,{sx:{minWidth:0},children:"ON/OFF"})]}),I.map((s,r)=>{const l=c(s.sourceDetailId),d=c(s.targetDetailId);return e.jsx(_e,{draggableId:`pc-${r}`,index:r,children:R=>J?e.jsx(ke,{p:s,idx:r,sDetail:l,tDetail:d,prov:R}):e.jsx(he,{p:s,idx:r,sDetail:l,tDetail:d,prov:R})},r)}),u.placeholder]})})})}),e.jsx(gt,{severity:"info",sx:{mt:2,maxWidth:1024,mx:"auto"},children:"「プレー組み合わせ」機能を有効にすると、片方のチームでプレー詳細を選択した際に、ここで有効化した組み合わせに従って相手側のプレーが自動入力されます。"}),e.jsx(Dl,{open:z,playCategories:O,playDetails:y,initial:p!==null?I[p]:void 0,onSave:u=>{p===null?X(u):re(p,u)},onClose:()=>G(!1)})]})}const Ns=!1,Ls=!1,Bs=!1;function Pl({tags:g,setTags:j,rallyCategoryTags:O,setRallyCategoryTags:y,rallyDetailTags:_,setRallyDetailTags:I,setMatches:N,setPlayCategories:L,setPlayDetails:K,showSnackbar:z}){const[G,p]=o.useState(null),[C,M]=o.useState(""),[J,F]=o.useState(xe),[b,U]=o.useState(!1),[w,B]=o.useState(null),[f,ee]=o.useState(""),[X,re]=o.useState(xe),[ie,pe]=o.useState(!1),[he,ke]=o.useState(null),[c,S]=o.useState(""),[v,T]=o.useState(xe),[u,s]=o.useState(!1),r=Fe("md"),{handleTouchEnd:l,setSwiperRef:d,getSwiperRef:R}=at(2),{handleTouchEnd:Y,setSwiperRef:Z,getSwiperRef:q}=at(2),{handleTouchEnd:ne,setSwiperRef:fe,getSwiperRef:n}=at(2),[x,k]=o.useState(""),[W,E]=o.useState(""),[H,se]=o.useState(""),te=a=>{if(x){const P=R(x);P&&(P.allowTouchMove=!0),k("")}if(!a.destination)return;const m=Array.from(g),[$]=m.splice(a.source.index,1);m.splice(a.destination.index,0,$),j(m)},ae=a=>{if(W){const P=q(W);P&&(P.allowTouchMove=!0),E("")}if(!a.destination)return;const m=Array.from(O),[$]=m.splice(a.source.index,1);m.splice(a.destination.index,0,$),y(m)},Je=a=>{if(H){const P=n(H);P&&(P.allowTouchMove=!0),se("")}if(!a.destination)return;const m=Array.from(_),[$]=m.splice(a.source.index,1);m.splice(a.destination.index,0,$),I(m)},Ct=()=>{p(-1),M(""),F(xe),U(!0)},vt=a=>{p(a),M(g[a].name),F(g[a].color),U(!0)},ft=()=>{G===-1?j(a=>[...a,{id:crypto.randomUUID(),name:C,color:J}]):G!==null&&j(a=>a.map((m,$)=>$===G?{...m,name:C,color:J}:m)),U(!1)},$e=()=>{U(!1)},Ue=a=>{const m=g[a];let $=[];j(P=>P.filter((A,de)=>de!==a)),N(P=>($=P.map(A=>({...A,tags:[...A.tags]})),P.map(A=>({...A,tags:A.tags.filter(de=>de!==m.id)})))),z("試合タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{j(P=>{const A=[...P];return A.splice(a,0,m),A}),N(()=>$)},autoHideDuration:5e3})},dt=()=>{B(-1),ee(""),re(xe),pe(!0)},It=a=>{B(a),ee(O[a].name),re(O[a].color),pe(!0)},rt=()=>{w===-1?y(a=>[...a,{id:crypto.randomUUID(),name:f,color:X}]):w!==null&&y(a=>a.map((m,$)=>$===w?{...m,name:f,color:X}:m)),pe(!1)},wt=()=>{pe(!1)},Ne=a=>{const m=O[a];let $=[];y(P=>P.filter((A,de)=>de!==a)),L(P=>($=P.map(A=>({...A,tags:[...A.tags||[]]})),P.map(A=>({...A,tags:(A.tags||[]).filter(de=>de!==m.id)})))),z("プレー区分タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{y(P=>{const A=[...P];return A.splice(a,0,m),A}),L(()=>$)},autoHideDuration:5e3})},Mt=()=>{ke(-1),S(""),T(xe),s(!0)},Le=a=>{ke(a),S(_[a].name),T(_[a].color),s(!0)},Et=()=>{he===-1?I(a=>[...a,{id:crypto.randomUUID(),name:c,color:v}]):he!==null&&I(a=>a.map((m,$)=>$===he?{...m,name:c,color:v}:m)),s(!1)},Ve=()=>{s(!1)},St=a=>{const m=_[a];let $=[];I(P=>P.filter((A,de)=>de!==a)),K(P=>($=P.map(A=>({...A,tags:[...A.tags||[]]})),P.map(A=>({...A,tags:(A.tags||[]).filter(de=>de!==m.id)})))),z("プレー詳細タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{I(P=>{const A=[...P];return A.splice(a,0,m),A}),K(()=>$)},autoHideDuration:5e3})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"試合タグ"}),e.jsx(V,{onClick:Ct,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})]}),e.jsx(Ye,{component:qe,storageKey:"match-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:te,children:r?e.jsx(Re,{droppableId:"match-tags",children:a=>e.jsxs(t,{ref:a.innerRef,...a.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})}),g.map((m,$)=>e.jsx(_e,{draggableId:m.id,index:$,children:P=>{const A=P.dragHandleProps,{onPointerDown:de,...xt}=A||{},ht=nt(ue=>{de==null||de(ue);const me=R(m.id);me&&(me.allowTouchMove=!1),k(m.id)});return e.jsx(t,{ref:P.innerRef,...P.draggableProps,style:P.draggableProps.style,children:e.jsxs(tt,{onSwiper:ue=>d(m.id,ue),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(ue,me)=>me.stopPropagation(),onTouchEnd:ue=>l(m.id,ue),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...xt,...ht,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:x===m.id?"none":"pan-y"},children:e.jsx(t,{sx:{flexGrow:1},children:e.jsx(ge,{label:m.name,size:"small",sx:{backgroundColor:m.color,border:`1px solid ${m.color}`,color:"#fff"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>vt($),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>Ue($),children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})}},m.id)),a.placeholder]})}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:a=>a.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{}),e.jsx(h,{children:"タグ名称"}),Ns,e.jsx(h,{})]})}),e.jsx(Re,{droppableId:"match-tags",children:a=>e.jsxs(Qe,{ref:a.innerRef,...a.droppableProps,children:[g.map((m,$)=>e.jsx(_e,{draggableId:m.id,index:$,children:P=>e.jsxs(ye,{ref:P.innerRef,...P.draggableProps,"data-index":$,onClick:()=>vt($),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:A=>A.stopPropagation(),...P.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:e.jsx(ge,{label:m.name,size:"small",sx:{backgroundColor:m.color,border:`1px solid ${m.color}`,color:"#fff"}})}),Ns,e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:A=>A.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:()=>Ue($),sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:"error"})})})})]})},m.id)),a.placeholder]})})]})})}),e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,mt:2},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"プレー区分タグ"}),e.jsx(V,{onClick:dt,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})]}),e.jsx(Ye,{component:qe,storageKey:"play-category-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:ae,children:r?e.jsx(Re,{droppableId:"rally-category-tags",children:a=>e.jsxs(t,{ref:a.innerRef,...a.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})}),O.map((m,$)=>e.jsx(_e,{draggableId:m.id,index:$,children:P=>{const A=P.dragHandleProps,{onPointerDown:de,...xt}=A||{},ht=nt(ue=>{de==null||de(ue);const me=q(m.id);me&&(me.allowTouchMove=!1),E(m.id)});return e.jsx(t,{ref:P.innerRef,...P.draggableProps,style:P.draggableProps.style,children:e.jsxs(tt,{onSwiper:ue=>Z(m.id,ue),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(ue,me)=>me.stopPropagation(),onTouchEnd:ue=>Y(m.id,ue),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...xt,...ht,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:W===m.id?"none":"pan-y"},children:e.jsx(t,{sx:{flexGrow:1},children:e.jsx(ge,{label:m.name,size:"small",sx:{backgroundColor:m.color,border:`1px solid ${m.color}`,color:"#fff"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>It($),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>Ne($),children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})}},m.id)),a.placeholder]})}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:a=>a.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{}),e.jsx(h,{children:"タグ名称"}),Ls,e.jsx(h,{})]})}),e.jsx(Re,{droppableId:"rally-category-tags",children:a=>e.jsxs(Qe,{ref:a.innerRef,...a.droppableProps,children:[O.map((m,$)=>e.jsx(_e,{draggableId:m.id,index:$,children:P=>e.jsxs(ye,{ref:P.innerRef,...P.draggableProps,"data-index":$,onClick:()=>It($),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:A=>A.stopPropagation(),...P.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:e.jsx(ge,{label:m.name,size:"small",sx:{backgroundColor:m.color,border:`1px solid ${m.color}`,color:"#fff"}})}),Ls,e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:A=>A.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:()=>Ne($),sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:"error"})})})})]})},m.id)),a.placeholder]})})]})})}),e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,mt:2},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"プレー詳細タグ"}),e.jsx(V,{onClick:Mt,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})]}),e.jsx(Ye,{component:qe,storageKey:"play-detail-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Be,{onDragEnd:Je,children:r?e.jsx(Re,{droppableId:"rally-detail-tags",children:a=>e.jsxs(t,{ref:a.innerRef,...a.droppableProps,children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})}),_.map((m,$)=>e.jsx(_e,{draggableId:m.id,index:$,children:P=>{const A=P.dragHandleProps,{onPointerDown:de,...xt}=A||{},ht=nt(ue=>{de==null||de(ue);const me=n(m.id);me&&(me.allowTouchMove=!1),se(m.id)});return e.jsx(t,{ref:P.innerRef,...P.draggableProps,style:P.draggableProps.style,children:e.jsxs(tt,{onSwiper:ue=>fe(m.id,ue),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(ue,me)=>me.stopPropagation(),onTouchEnd:ue=>ne(m.id,ue),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...xt,...ht,sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"grab",touchAction:H===m.id?"none":"pan-y"},children:e.jsx(t,{sx:{flexGrow:1},children:e.jsx(ge,{label:m.name,size:"small",sx:{backgroundColor:m.color,border:`1px solid ${m.color}`,color:"#fff"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>Le($),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>St($),children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})}},m.id)),a.placeholder]})}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:a=>a.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{}),e.jsx(h,{children:"タグ名称"}),Bs,e.jsx(h,{})]})}),e.jsx(Re,{droppableId:"rally-detail-tags",children:a=>e.jsxs(Qe,{ref:a.innerRef,...a.droppableProps,children:[_.map((m,$)=>e.jsx(_e,{draggableId:m.id,index:$,children:P=>e.jsxs(ye,{ref:P.innerRef,...P.draggableProps,"data-index":$,onClick:()=>Le($),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:A=>A.stopPropagation(),...P.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:e.jsx(ge,{label:m.name,size:"small",sx:{backgroundColor:m.color,border:`1px solid ${m.color}`,color:"#fff"}})}),Bs,e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:A=>A.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:()=>St($),sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:"error"})})})})]})},m.id)),a.placeholder]})})]})})})]}),e.jsxs(ct,{open:b,onClose:$e,children:[e.jsxs(Pe,{children:["タグ",G===-1?"追加":"編集"]}),e.jsxs(Me,{sx:{mt:2},children:[e.jsx(ve,{label:"タグ名称",value:C,onChange:a=>M(a.target.value),fullWidth:!0,margin:"dense"}),e.jsx(ve,{label:"色",type:"color",value:J,onChange:a=>F(a.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:$e,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:ft,disabled:C.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(ct,{open:ie,onClose:wt,children:[e.jsxs(Pe,{children:["タグ",w===-1?"追加":"編集"]}),e.jsxs(Me,{sx:{mt:2},children:[e.jsx(ve,{label:"タグ名称",value:f,onChange:a=>ee(a.target.value),fullWidth:!0,margin:"dense"}),e.jsx(ve,{label:"色",type:"color",value:X,onChange:a=>re(a.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:wt,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:rt,disabled:f.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(ct,{open:u,onClose:Ve,children:[e.jsxs(Pe,{children:["タグ",he===-1?"追加":"編集"]}),e.jsxs(Me,{sx:{mt:2},children:[e.jsx(ve,{label:"タグ名称",value:c,onChange:a=>S(a.target.value),fullWidth:!0,margin:"dense"}),e.jsx(ve,{label:"色",type:"color",value:v,onChange:a=>T(a.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:Ve,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:Et,disabled:c.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}const Ml=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function El({statsSettings:g,setStatsSettings:j,playCategories:O,playDetails:y,rallyCategoryTags:_,rallyDetailTags:I,showSnackbar:N}){const[L,K]=o.useState(null),[z,G]=o.useState(""),[p,C]=o.useState(""),[M,J]=o.useState([]),[F,b]=o.useState([]),[U,w]=o.useState(""),[B,f]=o.useState(""),[ee,X]=o.useState("合算"),[re,ie]=o.useState(!1),pe=Fe("md"),he=Fe("sm"),{handleTouchEnd:ke,setSwiperRef:c,getSwiperRef:S}=at(2),[v,T]=o.useState(""),u=n=>{if(v){const W=S(v);W&&(W.allowTouchMove=!0),T("")}if(!n.destination)return;const x=Array.from(g),[k]=x.splice(n.source.index,1);x.splice(n.destination.index,0,k),j(x)},s=n=>{var x;return((x=O.find(k=>k.id===n))==null?void 0:x.name)||""},r=n=>{var x;return((x=y.find(k=>k.id===n))==null?void 0:x.name)||""},l=n=>{const x=n.playCategoryId?s(n.playCategoryId):n.playCategoryTags?n.playCategoryTags.map(se=>{var te;return((te=_.find(ae=>ae.id===se))==null?void 0:te.name)||se}).join(", "):"",k=n.playDetailId?r(n.playDetailId):n.playDetailTags?n.playDetailTags.map(se=>{var te;return((te=I.find(ae=>ae.id===se))==null?void 0:te.name)||se}).join(", "):"",W=n.pointType||"",E=n.pointUnitType||"",H=n.aggregateType||"合算";return[x,k,W,E,H].filter(se=>se).join(", ")},d=()=>{K(-1),G(""),C(""),J([]),b([]),w(""),f(""),X("合算"),ie(!0)},R=n=>{const x=g[n];K(n),G(x.playCategoryId||""),C(x.playDetailId||""),J(x.playCategoryTags||[]),b(x.playDetailTags||[]),w(x.pointType||""),f(x.pointUnitType||""),X(x.aggregateType||"合算"),ie(!0)},Y=()=>{const n=z!=="",x=p!=="",k=M.length>0,W=F.length>0,E=U!=="",H=B!=="";return n&&!x&&!k&&!W&&!E&&!H||n&&x&&!k&&!W&&!E&&!H||n&&!x&&!k&&!W&&E&&!H||n&&!x&&!k&&!W&&!E&&H||n&&!x&&!k&&!W&&E&&H||!n&&!x&&!k&&!W&&E&&!H||!n&&!x&&!k&&!W&&E&&H||!n&&!x&&!k&&!W&&!E&&H||k&&!n&&!x&&!W&&!E&&!H||k&&W&&!n&&!x&&!E&&!H||k&&W&&!n&&!x&&E&&!H||k&&W&&!n&&!x&&!E&&H||k&&W&&!n&&!x&&E&&H||k&&!n&&!x&&E&&!H||k&&!n&&!x&&!E&&H||k&&!n&&!x&&E&&H||W&&!n&&!x&&!k&&!E&&!H||W&&!n&&!x&&!k&&E&&!H||W&&!n&&!x&&!k&&!E&&H||W&&!n&&!x&&!k&&E&&H},Z=()=>{const n={id:L===-1?Ml():g[L].id,playCategoryId:z||void 0,playDetailId:p||void 0,playCategoryTags:z===""&&M.length>0?M:void 0,playDetailTags:p===""&&F.length>0?F:void 0,pointType:p?void 0:U||void 0,pointUnitType:p?void 0:B||void 0,aggregateType:ee};L===-1?j(x=>[...x,n]):L!==null&&j(x=>x.map((k,W)=>W===L?n:k)),ie(!1)},q=()=>{ie(!1)},ne=n=>{const x=g[n];j(k=>k.filter((W,E)=>E!==n)),N("スタッツを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{j(k=>{const W=[...k];return W.splice(n,0,x),W})},autoHideDuration:5e3})},fe=({s:n,idx:x,dragProvided:k})=>{const W=k.dragHandleProps,{onPointerDown:E,...H}=W||{},se=nt(te=>{E==null||E(te);const ae=S(n.id);ae&&(ae.allowTouchMove=!1),T(n.id)});return e.jsx(t,{ref:k.innerRef,...k.draggableProps,style:k.draggableProps.style,children:e.jsxs(tt,{onSwiper:te=>c(n.id,te),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(te,ae)=>ae.stopPropagation(),onTouchEnd:te=>ke(n.id,te),children:[e.jsx(ce,{style:{width:"100%",flex:"0 0 auto"},children:e.jsx(t,{...H,...se,sx:{display:"grid",gridTemplateColumns:he?"1fr":"repeat(5, 1fr)",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",touchAction:v===n.id?"none":"pan-y",cursor:"grab"},children:he?e.jsx(t,{children:l(n)}):e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{pr:1},children:n.playCategoryId?s(n.playCategoryId):n.playCategoryTags&&n.playCategoryTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.playCategoryTags.map(te=>{const ae=_.find(Je=>Je.id===te);return e.jsx(ge,{label:(ae==null?void 0:ae.name)||te,size:"small",sx:{backgroundColor:(ae==null?void 0:ae.color)||xe,color:"#fff"}},te)})}):""}),e.jsx(t,{sx:{pr:1},children:n.playDetailId?r(n.playDetailId):n.playDetailTags&&n.playDetailTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.playDetailTags.map(te=>{const ae=I.find(Je=>Je.id===te);return e.jsx(ge,{label:(ae==null?void 0:ae.name)||te,size:"small",sx:{backgroundColor:(ae==null?void 0:ae.color)||xe,color:"#fff"}},te)})}):""}),e.jsx(t,{sx:{pr:1},children:n.pointType||""}),e.jsx(t,{sx:{pr:1},children:n.pointUnitType||""}),e.jsx(t,{children:n.aggregateType||"合算"})]})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:e.jsx(le,{size:"small",onClick:()=>R(x),children:e.jsx(lt,{fontSize:"small",sx:{color:"common.white"}})})})}),e.jsx(ce,{style:{width:we,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(le,{size:"small",onClick:()=>ne(x),children:e.jsx(Ie,{fontSize:"small",sx:{color:"common.white"}})})})})]})})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(V,{onClick:d,variant:"contained",startIcon:e.jsx(et,{}),children:"追加"})}),e.jsx(Ye,{component:qe,storageKey:"stats-grid",sx:{maxWidth:1024,mx:"auto"},children:pe?e.jsx(Be,{onDragEnd:u,children:e.jsx(Re,{droppableId:"stats-settings",children:n=>e.jsxs(t,{ref:n.innerRef,...n.droppableProps,children:[e.jsx(t,{sx:{display:"grid",gridTemplateColumns:he?"1fr":"repeat(5, 1fr)",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:he?e.jsx(t,{children:"スタッツ"}):e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"プレー区分"}),e.jsx(t,{children:"プレー詳細"}),e.jsx(t,{children:"得点区分"}),e.jsx(t,{children:"得失点単位区分"}),e.jsx(t,{children:"集計方法"})]})}),g.map((x,k)=>e.jsx(_e,{draggableId:x.id,index:k,children:W=>e.jsx(fe,{s:x,idx:k,dragProvided:W})},x.id)),n.placeholder]})})}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:n=>n.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{padding:"checkbox",sx:{width:48}}),e.jsx(h,{children:"プレー区分"}),e.jsx(h,{children:"プレー詳細"}),e.jsx(h,{children:"得点区分"}),e.jsx(h,{children:"得失点単位区分"}),e.jsx(h,{children:"集計方法"}),e.jsx(h,{})]})}),e.jsx(Be,{onDragEnd:u,children:e.jsx(Re,{droppableId:"stats-settings",children:n=>e.jsxs(Qe,{ref:n.innerRef,...n.droppableProps,children:[g.map((x,k)=>e.jsx(_e,{draggableId:x.id,index:k,children:W=>e.jsxs(ye,{ref:W.innerRef,...W.draggableProps,"data-index":k,onClick:()=>R(k),sx:{cursor:"pointer",height:50},children:[e.jsx(h,{padding:"checkbox",sx:{width:48},children:e.jsx(t,{onClick:E=>E.stopPropagation(),...W.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(st,{})})}),e.jsx(h,{children:x.playCategoryId?s(x.playCategoryId):x.playCategoryTags&&x.playCategoryTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:x.playCategoryTags.map(E=>{const H=_.find(se=>se.id===E);return e.jsx(ge,{label:(H==null?void 0:H.name)||E,size:"small",sx:{backgroundColor:(H==null?void 0:H.color)||xe,color:"#fff"}},E)})}):""}),e.jsx(h,{children:x.playDetailId?r(x.playDetailId):x.playDetailTags&&x.playDetailTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:x.playDetailTags.map(E=>{const H=I.find(se=>se.id===E);return e.jsx(ge,{label:(H==null?void 0:H.name)||E,size:"small",sx:{backgroundColor:(H==null?void 0:H.color)||xe,color:"#fff"}},E)})}):""}),e.jsx(h,{children:x.pointType||""}),e.jsx(h,{children:x.pointUnitType||""}),e.jsx(h,{children:x.aggregateType||"合算"}),e.jsx(h,{padding:"checkbox",children:e.jsx(t,{onClick:E=>E.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(le,{size:"small",onClick:()=>ne(k),sx:{width:24,height:24},children:e.jsx(Ie,{fontSize:"small",color:"error"})})})})]})},x.id)),n.placeholder]})})})]})})]}),e.jsxs(ct,{open:re,onClose:q,children:[e.jsxs(Pe,{children:["スタッツ設定",L===-1?"追加":"編集"]}),e.jsxs(Me,{children:[e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"stat-category-label",children:"プレー区分"}),e.jsxs(Oe,{labelId:"stat-category-label",value:z,label:"プレー区分",onChange:n=>{G(n.target.value),C(""),J([]),b([])},disabled:M.length>0||F.length>0,children:[e.jsx(oe,{value:"",children:"なし"}),O.map(n=>e.jsx(oe,{value:n.id,children:n.name},n.id))]})]}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"stat-detail-label",children:"プレー詳細"}),e.jsxs(Oe,{labelId:"stat-detail-label",value:p,label:"プレー詳細",onChange:n=>{C(n.target.value),w(""),f(""),J([]),b([])},disabled:U!==""||B!==""||M.length>0||F.length>0,children:[e.jsx(oe,{value:"",children:"なし"}),y.filter(n=>n.playCategoryId===z).map(n=>e.jsx(oe,{value:n.id,children:n.name},n.id))]})]}),e.jsx(Pt,{multiple:!0,options:_,getOptionLabel:n=>n.name,value:_.filter(n=>M.includes(n.id)),onChange:(n,x)=>{J(x.map(k=>k.id)),x.length>0&&(G(""),C(""))},disabled:z!==""||p!=="",renderTags:(n,x)=>n.map((k,W)=>{const{key:E,...H}=x({index:W});return e.jsx(ge,{...H,label:k.name,size:"small",sx:{backgroundColor:k.color||xe,color:"#fff"}},E)}),renderInput:n=>e.jsx(ve,{...n,label:"プレー区分タグ",margin:"dense"}),fullWidth:!0}),e.jsx(Pt,{multiple:!0,options:I,getOptionLabel:n=>n.name,value:I.filter(n=>F.includes(n.id)),onChange:(n,x)=>{b(x.map(k=>k.id)),x.length>0&&(G(""),C(""))},disabled:z!==""||p!=="",renderTags:(n,x)=>n.map((k,W)=>{const{key:E,...H}=x({index:W});return e.jsx(ge,{...H,label:k.name,size:"small",sx:{backgroundColor:k.color||xe,color:"#fff"}},E)}),renderInput:n=>e.jsx(ve,{...n,label:"プレー詳細タグ",margin:"dense"}),fullWidth:!0}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"stat-point-label",children:"得点区分"}),e.jsxs(Oe,{labelId:"stat-point-label",value:U,label:"得点区分",onChange:n=>{w(n.target.value),n.target.value!==""&&C("")},disabled:p!=="",children:[e.jsx(oe,{value:"",children:"なし"}),e.jsx(oe,{value:"得点",children:"得点"}),e.jsx(oe,{value:"失点",children:"失点"})]})]}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"stat-unit-label",children:"得失点単位区分"}),e.jsxs(Oe,{labelId:"stat-unit-label",value:B,label:"得失点単位区分",onChange:n=>{f(n.target.value),n.target.value!==""&&C("")},disabled:p!=="",children:[e.jsx(oe,{value:"",children:"なし"}),e.jsx(oe,{value:"メンバー",children:"メンバー"}),e.jsx(oe,{value:"チーム",children:"チーム"})]})]}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"stat-aggregate-label",children:"集計方法"}),e.jsxs(Oe,{labelId:"stat-aggregate-label",value:ee,label:"集計方法",onChange:n=>X(n.target.value),children:[e.jsx(oe,{value:"合算",children:"合算"}),e.jsx(oe,{value:"セット平均",children:"セット平均"})]})]})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:q,color:"inherit",startIcon:e.jsx(Ae,{}),children:"キャンセル"}),e.jsx(V,{onClick:Z,disabled:!Y(),startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}const Zt=[{id:"light1",name:"ライトモード１",setting:{mode:"light",appBarColor:"#F5F5F5",appBarTextColor:"#000000",buttonColor:"#1C8139",scoreColor:"#1C8139",lossColor:"#D21972"}},{id:"light2",name:"ライトモード２",setting:{mode:"light",appBarColor:"#F2EDE3",appBarTextColor:"#000000",buttonColor:"#48A588",scoreColor:"#48A588",lossColor:"#CE5164"}},{id:"dark1",name:"ダークモード１",setting:{mode:"dark",appBarColor:"#333333",appBarTextColor:"#FFFFFF",buttonColor:"#90CAF9",scoreColor:"#90CAF9",lossColor:"#F48FB1"}},{id:"dark2",name:"ダークモード２",setting:{mode:"dark",appBarColor:"#121212",appBarTextColor:"#FFFFFF",buttonColor:"#BB86FC",scoreColor:"#419552",lossColor:"#C77584"}}];function zl({theme:g,onThemeChange:j}){var _;const O=(_=Zt.find(I=>I.name===g.name))==null?void 0:_.id,y=(I,N)=>{if(!N)return;const L=Zt.find(K=>K.id===N);L&&j({name:L.name,...L.setting})};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxWidth:1024,width:"100%",mx:"auto"},children:[e.jsxs(t,{sx:{display:"none",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"アプリカラー"}),e.jsx("input",{type:"color",value:g.appBarColor,onChange:I=>j({...g,appBarColor:I.target.value}),title:"背景色"}),e.jsx("input",{type:"color",value:g.appBarTextColor,onChange:I=>j({...g,appBarTextColor:I.target.value}),title:"文字色",style:{marginLeft:8}})]}),e.jsxs(t,{sx:{display:"none",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"ボタンカラー"}),e.jsx("input",{type:"color",value:g.buttonColor,onChange:I=>j({...g,buttonColor:I.target.value})})]}),e.jsxs(t,{sx:{display:"none",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"得点カラー"}),e.jsx("input",{type:"color",value:g.scoreColor,onChange:I=>j({...g,scoreColor:I.target.value})})]}),e.jsxs(t,{sx:{display:"none",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"失点カラー"}),e.jsx("input",{type:"color",value:g.lossColor,onChange:I=>j({...g,lossColor:I.target.value})})]}),e.jsx(pt,{orientation:"vertical",exclusive:!0,value:O,onChange:y,sx:{"& .MuiToggleButton-root":{justifyContent:"flex-start"}},children:Zt.map(I=>e.jsxs(We,{value:I.id,sx:{textAlign:"left"},children:[e.jsx(gs,{sx:{mr:1}}),I.name,O===I.id&&e.jsx(ze,{sx:{ml:"auto"}})]},I.id))})]})}var bs={},Hl=be;Object.defineProperty(bs,"__esModule",{value:!0});var tn=bs.default=void 0,Al=Hl(Ce()),Wl=e;tn=bs.default=(0,Al.default)((0,Wl.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");function $l({scoreInput:g,onScoreInputChange:j,dashboardVisible:O,onDashboardVisibleChange:y,showSnackbar:_}){const[I,N]=o.useState(!1),L=()=>{try{const p=[];for(let C=0;C<localStorage.length;C++){const M=localStorage.key(C);M&&M.startsWith("tutorial-")&&p.push(M)}p.forEach(C=>localStorage.removeItem(C)),_("ガイド表示済み状態をクリアしました","success")}catch(p){console.error(p),_("ガイド表示済み状態のクリアに失敗しました","error")}},K=()=>N(!0),z=()=>N(!1),G=()=>{N(!1),L()};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",mt:1,maxWidth:1024,width:"100%",mx:"auto"},children:[e.jsx(mt,{control:e.jsx(it,{checked:g.rallyMemberRequired,onChange:p=>j({...g,rallyMemberRequired:p.target.checked})}),label:"ラリー結果メンバー選択必須",sx:{mb:1}}),e.jsx(mt,{control:e.jsx(it,{checked:g.showRallyIcons,onChange:p=>j({...g,showRallyIcons:p.target.checked})}),label:"ラリー結果アイコン表示",sx:{mb:1}}),e.jsx(mt,{control:e.jsx(it,{checked:g.showScoreProgressArea,onChange:p=>j({...g,showScoreProgressArea:p.target.checked})}),label:"得点推移エリア表示",sx:{mb:1}}),e.jsx(mt,{control:e.jsx(it,{checked:g.showGridScrollHint,onChange:p=>j({...g,showGridScrollHint:p.target.checked})}),label:"グリッド横スクロール表記表示",sx:{mb:1}}),e.jsx(mt,{control:e.jsx(it,{checked:O,onChange:p=>y(p.target.checked)}),label:"ダッシュボード表示",sx:{mb:1,display:"none"}}),e.jsx(V,{variant:"contained",startIcon:e.jsx(tn,{}),onClick:K,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"},alignSelf:"flex-start",mt:2},children:"ガイド再表示"}),e.jsxs(ut,{open:I,onClose:z,children:[e.jsx(Pe,{children:"確認"}),e.jsx(Me,{sx:{mt:2},children:"ガイドを再表示しますか？"}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:z,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:G,startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}var Cs={},Nl=be;Object.defineProperty(Cs,"__esModule",{value:!0});var ss=Cs.default=void 0,Ll=Nl(Ce()),Bl=e;ss=Cs.default=(0,Ll.default)((0,Bl.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen");function Fl({teams:g,matches:j,tags:O,matchLocks:y,setMatchLocks:_,lockGroupBy:I,setLockGroupBy:N}){const L=Fe("md"),K=Fe("sm"),z=F=>{var b;return((b=g.find(U=>U.id===F))==null?void 0:b.name)||""},G=K?"32px 100px 1fr 100px":"32px 100px 1fr 170px 210px 60px",p=I,C=En(j,p),M=F=>F.map(b=>{const U=b.sets.filter(f=>f.my>f.opponent).length,w=b.sets.filter(f=>f.my<f.opponent).length,B=y[b.id];return e.jsxs(ye,{sx:{height:50},children:[e.jsx(h,{padding:"checkbox",sx:{width:32},children:e.jsx(le,{size:"small",onClick:()=>_(f=>({...f,[b.id]:!f[b.id]})),children:B?e.jsx(Qt,{sx:{color:"#D21972"}}):e.jsx(ss,{sx:{color:"#1C8139"}})})}),e.jsx(h,{sx:{width:100},children:b.date}),e.jsx(h,{children:b.matchName}),e.jsx(h,{sx:{width:170},children:`${z(b.teamA)} - ${z(b.teamB)}`}),e.jsx(h,{sx:{width:210},children:b.tags.map(f=>{const ee=O.find(re=>re.id===f),X=(ee==null?void 0:ee.color)||xe;return e.jsx(ge,{label:(ee==null?void 0:ee.name)||f,size:"small",sx:{mr:.5,mb:.5,backgroundColor:X,color:"#fff"}},f)})}),e.jsxs(h,{sx:{width:60,textAlign:"left"},children:[U,"-",w]})]},b.id)}),J=F=>F.map(b=>{const U=b.sets.filter(f=>f.my>f.opponent).length,w=b.sets.filter(f=>f.my<f.opponent).length,B=y[b.id];return e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:G,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider"},children:[e.jsx(t,{children:e.jsx(le,{size:"small",onClick:()=>_(f=>({...f,[b.id]:!f[b.id]})),children:B?e.jsx(Qt,{sx:{color:"#D21972"}}):e.jsx(ss,{sx:{color:"#1C8139"}})})}),e.jsx(t,{children:b.date}),e.jsx(t,{children:b.matchName}),e.jsx(t,{children:K?e.jsxs(e.Fragment,{children:[e.jsx(t,{children:z(b.teamA)}),e.jsx(t,{children:z(b.teamB)})]}):`${z(b.teamA)} - ${z(b.teamB)}`}),!K&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:b.tags.map(f=>{const ee=O.find(re=>re.id===f),X=(ee==null?void 0:ee.color)||xe;return e.jsx(ge,{label:(ee==null?void 0:ee.name)||f,size:"small",sx:{mr:.5,mb:.5,backgroundColor:X,color:"#fff"}},f)})}),e.jsxs(t,{sx:{textAlign:"left"},children:[U,"-",w]})]})]},b.id)});return e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto"},children:L?e.jsx(De,{size:"small",margin:"dense",children:e.jsxs(Oe,{value:I,onChange:F=>N(F.target.value),children:[e.jsx(oe,{value:"none",children:"グルーピングなし"}),e.jsx(oe,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(oe,{value:"card",children:"対戦カード"})]})}):e.jsxs(pt,{exclusive:!0,value:I,onChange:(F,b)=>{b!==null&&N(b)},sx:{mb:1},children:[e.jsx(We,{value:"none",children:"グルーピングなし"}),e.jsx(We,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(We,{value:"card",children:"対戦カード"})]})}),e.jsx(Ye,{component:qe,storageKey:"match-lock-grid",sx:{maxWidth:1024,mx:"auto"},children:L?e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:G,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:[e.jsx(t,{}),e.jsx(t,{children:"日付"}),e.jsx(t,{children:"試合名"}),e.jsx(t,{children:"対戦カード"}),!K&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"タグ"}),e.jsx(t,{sx:{textAlign:"left"},children:"セット"})]})]}),p==="none"?J(C.all||[]):Object.entries(C).map(([F,b])=>{const U=p==="card"?zs(b[0].teamA,b[0].teamB,g):F;return e.jsxs(t,{children:[e.jsx(t,{sx:{display:"grid",gridTemplateColumns:G,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Se},children:e.jsx(t,{sx:{gridColumn:"1 / -1"},children:U})}),J(b)]},F)})]}):e.jsxs(Xe,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(ye,{sx:{backgroundColor:F=>F.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(h,{padding:"checkbox",sx:{width:32}}),e.jsx(h,{sx:{width:100,...Se},children:"日付"}),e.jsx(h,{sx:Se,children:"試合名"}),e.jsx(h,{sx:{width:170,...Se},children:"対戦カード"}),e.jsx(h,{sx:{width:210,...Se},children:"タグ"}),e.jsx(h,{sx:{width:60,textAlign:"left",...Se},children:"セット"})]})}),e.jsx(Qe,{children:p==="none"?M(C.all||[]):Object.entries(C).map(([F,b])=>{const U=p==="card"?zs(b[0].teamA,b[0].teamB,g):F;return e.jsxs(o.Fragment,{children:[e.jsx(ye,{sx:{height:50},children:e.jsx(h,{colSpan:6,sx:Se,children:U})}),M(b)]},F)})})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",mt:1},children:e.jsx(gt,{severity:"info",children:"試合をロックすると、この試合は削除できなくなり閲覧のみとなります。ロック解除で編集・削除が可能です。"})})]})}var vs={},Ul=be;Object.defineProperty(vs,"__esModule",{value:!0});var sn=vs.default=void 0,Vl=Ul(Ce()),Gl=e;sn=vs.default=(0,Vl.default)((0,Gl.jsx)("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 12H4V8h16z"}),"FolderOpen");var Is={},Kl=be;Object.defineProperty(Is,"__esModule",{value:!0});var ns=Is.default=void 0,ql=Kl(Ce()),Yl=e;ns=Is.default=(0,ql.default)((0,Yl.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");var ws={},Jl=be;Object.defineProperty(ws,"__esModule",{value:!0});var nn=ws.default=void 0,Xl=Jl(Ce()),Zl=e;nn=ws.default=(0,Xl.default)((0,Zl.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload");const Ql=`[team]
サンプルチーム

[member]
サンプルチーム,1,バレーボーラー

[rally-play-category]
スパイク

[rally-play-detail]
スパイク,イン,得点,メンバー
スパイク,アウト,失点,メンバー
スパイク,アウト,失点,メンバー`,ls=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36),er=g=>({id:crypto.randomUUID(),name:g}),tr=g=>({id:ls(),name:g,color:xe,iconType:"none",tags:[],visible:!0});function sr({onDeleteData:g,onImportData:j,onExportData:O,showSnackbar:y,teams:_,setTeams:I,setMembers:N,playCategories:L,setPlayCategories:K,setPlayDetails:z}){const[G,p]=o.useState(!1),[C,M]=o.useState(null),[J,F]=o.useState(!1),[b,U]=o.useState(!1),[w,B]=o.useState(Ql),f=()=>{p(!0)},ee=async()=>{p(!1);try{await g(),y("全データを削除しました","success")}catch(T){console.error(T),y("全データの削除に失敗しました","error")}},X=()=>{p(!1)},re=T=>{M(T.target.files&&T.target.files[0]?T.target.files[0]:null)},ie=()=>{F(!0)},pe=async()=>{F(!1);const T=C;M(null);try{T&&await j(T),y("インポートが完了しました","success")}catch(u){console.error(u),y("インポートに失敗しました","error")}},he=()=>{F(!1)},ke=async()=>{try{await O(),y("エクスポートが完了しました","success")}catch(T){console.error(T),y("エクスポートに失敗しました","error")}},c=()=>{U(!0)},S=()=>{U(!1);try{const T=w.replace(/\r\n/g,`
`).split(`
`);let u="";const s=[],r={},l=[],d=[];for(const R of T){const Y=R.trim();if(Y!==""){if(Y.startsWith("[")&&Y.endsWith("]")){u=Y.toLowerCase();continue}switch(u){case"[team]":s.push(er(Y));break;case"[member]":{const[Z,q,ne]=Y.split(",").map(fe=>fe.trim());if(Z&&q&&ne){const fe=[..._,...s].find(n=>n.name===Z);if(fe){const n={id:ls(),no:Number(q),name:ne,positions:[],visible:!0};r[fe.id]||(r[fe.id]=[]),r[fe.id].push(n)}}break}case"[rally-play-category]":l.push(tr(Y));break;case"[rally-play-detail]":{const[Z,q,ne,fe]=Y.split(",").map(n=>n.trim());if(Z&&q&&ne&&fe){const n=[...L,...l].find(x=>x.name===Z);n&&d.push({id:ls(),playCategoryId:n.id,name:q,pointType:ne,pointUnitType:fe,tags:[],visible:!0})}break}default:break}}}s.length&&I(R=>[...R,...s]),Object.keys(r).length&&N(R=>{const Y={...R};for(const[Z,q]of Object.entries(r))Y[Z]=[...Y[Z]||[],...q];return Y}),l.length&&K(R=>[...R,...l]),d.length&&z(R=>[...R,...d]),s.length||Object.keys(r).length||l.length||d.length?(y("一括登録が完了しました","success"),B("")):y("登録対象のデータがありません","error")}catch(T){console.error(T),y("一括登録に失敗しました","error")}},v=()=>{U(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{maxWidth:1024,width:"100%",mx:"auto",textAlign:"left",display:"flex",flexDirection:"column",gap:1,alignItems:"flex-start"},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"データエクスポート"}),e.jsx(t,{children:e.jsx(V,{variant:"contained",startIcon:e.jsx(nn,{}),onClick:ke,children:"エクスポート"})}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"データインポート"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(V,{variant:"outlined",component:"label",startIcon:e.jsx(sn,{}),children:["ファイル選択",e.jsx("input",{type:"file",accept:".zip",hidden:!0,onChange:re})]}),e.jsx(V,{variant:"contained",startIcon:e.jsx(ns,{}),onClick:ie,disabled:!C,children:"インポート"})]}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"一括登録"}),e.jsx(ve,{value:w,onChange:T=>B(T.target.value),multiline:!0,minRows:10,fullWidth:!0}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:e.jsx(V,{variant:"contained",startIcon:e.jsx(ns,{}),onClick:c,children:"一括登録"})}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"データ削除"}),e.jsx(V,{variant:"contained",color:"error",startIcon:e.jsx(Ie,{}),onClick:f,children:"全データ削除"})]}),e.jsxs(ut,{open:G,onClose:X,children:[e.jsx(Pe,{children:"削除確認"}),e.jsx(Me,{sx:{mt:2},children:"全データを削除しますか？"}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:X,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:ee,color:"error",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(ut,{open:J,onClose:he,children:[e.jsx(Pe,{children:"確認"}),e.jsx(Me,{sx:{mt:2},children:"データをインポートしますか？"}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:he,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:pe,disabled:!C,startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(ut,{open:b,onClose:v,children:[e.jsx(Pe,{children:"確認"}),e.jsx(Me,{sx:{mt:2},children:"一括登録を実行しますか？"}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:v,startIcon:e.jsx(Ae,{}),color:"inherit",children:"キャンセル"}),e.jsx(V,{onClick:S,startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}var Ss={},nr=be;Object.defineProperty(Ss,"__esModule",{value:!0});var ln=Ss.default=void 0,lr=nr(Ce()),rr=e;ln=Ss.default=(0,lr.default)((0,rr.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");const or=`MIT License

Copyright (c) 2025 shinya_sun_sun

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
`;function ir(g){if(!g)return"";let j=g.replace(/^git\+/,"");const O=j.match(/^git@github\.com:(.+)$/);O&&(j=`https://github.com/${O[1]}`);const y=j.match(/^git:\/\/github\.com\/(.+)$/);y&&(j=`https://github.com/${y[1]}`);const _=j.match(/^ssh:\/\/git@github\.com\/(.+)$/);return _&&(j=`https://github.com/${_[1]}`),j.startsWith("github.com/")&&(j=`https://${j}`),/^[a-zA-Z]+:\/\//.test(j)||(/^[^/]+\/[^/]+$/.test(j)?j=`https://github.com/${j}`:j=`https://${j}`),j=j.replace(/\.git$/,""),j}function ar(){const[g,j]=o.useState(""),[O,y]=o.useState([]),[_,I]=o.useState(!0),[N,L]=o.useState({}),K={MIT:"https://opensource.org/license/mit/"};o.useEffect(()=>{zn(()=>import("./licenses-uPPrrUXe.js"),[]).then(p=>y(p.licenses)).finally(()=>I(!1))},[]);const z=o.useMemo(()=>O.filter(p=>p.name.toLowerCase().includes(g.toLowerCase())),[g,O]),G=async p=>{if(!N[p])try{const C=await fetch(`https://raw.githubusercontent.com/spdx/license-list-data/main/text/${p}.txt`);if(!C.ok)throw new Error("not ok");const M=await C.text();L(J=>({...J,[p]:M}))}catch{L(C=>({...C,[p]:""}))}};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(bt,{variant:"h6",sx:{mb:1},children:"BreakPoint MIT License"}),e.jsx(t,{component:"pre",sx:{p:1,backgroundColor:p=>p.palette.mode==="dark"?"#343A42":"#f5f5f5",color:p=>p.palette.text.primary,whiteSpace:"pre-wrap",minHeight:128,overflow:"auto"},children:or}),e.jsx(ve,{label:"検索",value:g,onChange:p=>j(p.target.value),sx:{my:2}}),e.jsx(t,{sx:{flexGrow:1,overflow:"auto"},children:_?e.jsx(t,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(kn,{})}):z.map(p=>{const C=p.license;return e.jsxs(Tn,{onChange:(M,J)=>{J&&G(C)},children:[e.jsxs(Rn,{expandIcon:e.jsx(ln,{}),children:[e.jsx(bt,{sx:{flexGrow:1},children:p.name}),e.jsx(bt,{variant:"body2",sx:{ml:2},children:C})]}),e.jsxs(_n,{children:[(()=>{const M=ir(p.url);return M&&e.jsx(Ot,{href:M,target:"_blank",rel:"noopener",sx:{display:"block",mb:1,wordBreak:"break-all"},children:M})})(),p.license.startsWith("CC")&&p.attribution&&e.jsx(bt,{variant:"body2",sx:{mb:1,whiteSpace:"pre-wrap"},children:p.attribution}),N[C]!==void 0&&(N[C]?e.jsx(t,{component:"pre",sx:{p:1,backgroundColor:M=>M.palette.mode==="dark"?"#343A42":"#f5f5f5",color:M=>M.palette.text.primary,whiteSpace:"pre-wrap",maxHeight:300,overflow:"auto"},children:N[C]}):e.jsx(Ot,{href:K[C]||`https://spdx.org/licenses/${C}.html`,target:"_blank",rel:"noopener",sx:{wordBreak:"break-all"},children:K[C]||`https://spdx.org/licenses/${C}.html`}))]})]},p.name)})})]})}const cr=Nn.create(t),Fs=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function Us(g){if(typeof window>"u")return g;try{const O=new DOMParser().parseFromString(g,"image/svg+xml"),y=new Set(["svg","g","path","circle","rect","line","polygon","polyline","text","defs","use"]),_=I=>{[...I.children].forEach(N=>{if(y.has(N.tagName))[...N.attributes].forEach(L=>{L.name.startsWith("on")&&N.removeAttribute(L.name)}),_(N);else{const L=document.createTextNode(N.outerHTML);N.replaceWith(L)}})};return _(O.documentElement),O.documentElement.outerHTML}catch{return""}}function dr({src:g,cropX:j,cropY:O,onChange:y}){const _=o.useRef(null),I=o.useRef(null),[N,L]=o.useState(!1),[K,z]=o.useState({x:0,y:0}),G=()=>_.current?{sx:_.current.clientWidth/_.current.naturalWidth,sy:_.current.clientHeight/_.current.naturalHeight}:{sx:1,sy:1},p=b=>{b.preventDefault(),b.stopPropagation();const U=I.current.getBoundingClientRect();z({x:b.clientX-U.left,y:b.clientY-U.top}),L(!0)},C=b=>{if(!N||!_.current)return;const U=_.current.getBoundingClientRect(),{sx:w,sy:B}=G(),f=b.clientX-U.left-K.x,ee=b.clientY-U.top-K.y,X=Math.min(Math.max(0,f/w),_.current.naturalWidth-64),re=Math.min(Math.max(0,ee/B),_.current.naturalHeight-64);y(Math.round(X),Math.round(re))},M=()=>L(!1),{sx:J,sy:F}=G();return e.jsxs(t,{sx:{position:"relative",display:"inline-block"},onMouseMove:C,onMouseUp:M,onMouseLeave:M,children:[e.jsx("img",{src:g,ref:_,style:{maxWidth:256}}),e.jsx(t,{ref:I,sx:{position:"absolute",left:j*J,top:O*F,width:64,height:64,border:"1px solid red",cursor:"move"},onMouseDown:p})]})}function xr({name:g}){const j=o.useRef(null),[O,y]=o.useState(1);return o.useEffect(()=>{const _=j.current;if(!_)return;const I=_.getBBox().width;y(I>64?64/I:1)},[g]),e.jsx("svg",{width:64,height:64,children:e.jsx("g",{transform:`scale(${O})`,children:e.jsx("text",{ref:j,x:32/O,y:32/O,textAnchor:"middle",dominantBaseline:"middle",fontSize:8,children:g})})})}function yr({matches:g,teams:j,teamMembers:O,playCategories:y,playDetails:_,statsSettings:I,tags:N,rallyCategoryTags:L,rallyDetailTags:K,themeSetting:z,scoreInputSetting:G,onSave:p,onDirtyChange:C,onDeleteData:M,onImportData:J,onExportData:F,showSnackbar:b,dashboardVisible:U,onDashboardVisibleChange:w,setAppBarLeftAction:B}){var Es;const[f,ee]=o.useState("teams");o.useEffect(()=>{window.scrollTo(0,0)},[f]);const[X,re]=o.useState([...j]),[ie,pe]=o.useState({...O}),[he,ke]=o.useState(((Es=j[0])==null?void 0:Es.id)||""),[c,S]=o.useState([...y]),[v,T]=o.useState(null),[u,s]=o.useState(""),[r,l]=o.useState(xe),[d,R]=o.useState("設定なし"),[Y,Z]=o.useState(""),[q,ne]=o.useState(""),[fe,n]=o.useState(0),[x,k]=o.useState(0),[W,E]=o.useState([]),[H,se]=o.useState(!0),[te,ae]=o.useState(!1),[Je,Ct]=o.useState(null),[vt,ft]=o.useState(!1),[$e,Ue]=o.useState([..._]),[dt,It]=o.useState([...I]),[rt,wt]=o.useState([...N]),[Ne,Mt]=o.useState([...L]),[Le,Et]=o.useState([...K]),[Ve,St]=o.useState({...z}),[a,m]=o.useState({...G}),[$,P]=o.useState([...g]),[A,de]=o.useState(()=>{const i={};return g.forEach(D=>{i[D.id]=!!D.locked}),i}),[xt,ht]=o.useState("none"),ue=!0,me=On(),kt=Pn();o.useEffect(()=>{if(!me.pathname.startsWith("/settings"))return;me.pathname.split("/")[2]},[ue,me.pathname,kt]),o.useEffect(()=>{const D=me.pathname.split("/")[2];ee(D??null)},[me.pathname,ue]);const[jt,ks]=o.useState(null),[zt,Ht]=o.useState(""),[Tt,At]=o.useState(""),[Wt,$t]=o.useState("得点"),[Nt,Lt]=o.useState("メンバー"),[Bt,Ft]=o.useState([]),[Ut,Vt]=o.useState(!0),[rn,Rt]=o.useState(!1),[Ts,Rs]=o.useState(null),[on,Gt]=o.useState(!1),an=i=>({id:crypto.randomUUID(),name:i}),cn=i=>({id:Fs(),name:i,color:xe,iconType:"none",tags:[],visible:!0}),_t=o.useMemo(()=>{const i=g.some(D=>!!D.locked!==A[D.id]);return JSON.stringify(X)!==JSON.stringify(j)||JSON.stringify(ie)!==JSON.stringify(O)||JSON.stringify(c)!==JSON.stringify(y)||JSON.stringify($e)!==JSON.stringify(_)||JSON.stringify(dt)!==JSON.stringify(I)||JSON.stringify(rt)!==JSON.stringify(N)||JSON.stringify(Ne)!==JSON.stringify(L)||JSON.stringify(Le)!==JSON.stringify(K)||JSON.stringify(Ve)!==JSON.stringify(z)||JSON.stringify(a)!==JSON.stringify(G)||i},[X,ie,c,$e,dt,rt,Ne,Le,Ve,a,A,j,O,y,_,I,N,L,K,z,G,g]),dn=o.useMemo(()=>[{key:"teams",label:"チーム",icon:e.jsx(Ks,{})},{key:"members",label:"メンバー",icon:e.jsx(qs,{})},{key:"scores",label:"ラリー",icon:e.jsx(Ys,{})},{key:"playCombinations",label:"プレー組み合わせ",icon:e.jsx(en,{})},{key:"tags",label:"タグ",icon:e.jsx(Js,{})},{key:"stats",label:"スタッツ",icon:e.jsx(An,{})},{key:"locks",label:"試合ロック",icon:e.jsx(Qt,{})},{key:"theme",label:"テーマ",icon:e.jsx(gs,{})},{key:"display",label:"表示・操作",icon:e.jsx(Xs,{})},{key:"data",label:"データ",icon:e.jsx(Zs,{})},{key:"license",label:"ライセンス",icon:e.jsx(Wn,{})},{key:"version",label:"バージョン",icon:e.jsx(Qs,{})}],[]),xn=o.useMemo(()=>[["teams","members","scores","playCombinations","tags","stats"],["display","theme"],["locks","data"],["license"],["version"]],[]),_s=o.useCallback(()=>{const i=$.map(D=>({...D,locked:A[D.id]}));p(X,ie,c,$e,dt,rt,Ne,Le,Ve,a,i,!0)},[c,$e,A,$,p,X,ie,dt,rt,Ne,Le,Ve,a]),hn=()=>{T(-1),s(""),l(xe),R("設定なし"),Z(""),ne(""),n(0),k(0),E([]),se(!0),ae(!0)},un=i=>{T(i),s(c[i].name),l(c[i].color||xe);const D=c[i];R(D.iconType==="svg"?"SVG":D.iconType==="image"?"画像":"設定なし"),Z(D.svg||""),ne(D.image||""),n(D.cropX||0),k(D.cropY||0),E(D.tags||[]),se(D.visible!==!1),ae(!0)},gn=()=>{const i=d==="SVG"?"svg":d==="画像"?"image":"none",D=i==="svg"?{iconType:i,svg:Y}:i==="image"?{iconType:i,image:q,cropX:fe,cropY:x}:{iconType:i};v===-1?S(Q=>[...Q,{...cn(u),...D,color:r,tags:W,visible:H}]):v!==null&&S(Q=>Q.map((je,Te)=>Te===v?{...je,name:u,...D,color:r,tags:W,visible:H}:je)),ae(!1)},Ds=()=>{ae(!1)},pn=i=>{Ct(i),ft(!0)},fn=()=>{if(Je!==null&&c[Je].id!=="init-serve"){const i=Je,D=c[i];S(Q=>Q.filter((je,Te)=>Te!==i)),b("プレー区分を削除しました","success",{actionLabel:"元に戻す",onAction:()=>{S(Q=>{const je=[...Q];return je.splice(i,0,D),je})},autoHideDuration:5e3})}ft(!1),Ct(null)},Os=()=>{ft(!1)},jn=()=>{var i;ks(-1),Ht(((i=c.find(D=>D.visible!==!1))==null?void 0:i.id)||""),At(""),$t("得点"),Lt("メンバー"),Ft([]),Vt(!0),Rt(!0)},mn=i=>{const D=$e[i];ks(i),Ht(D.playCategoryId),At(D.name),$t(D.pointType),Lt(D.pointUnitType),Ft(D.tags||[]),Vt(D.visible!==!1),Rt(!0)},yn=()=>{jt===-1?Ue(i=>[...i,{id:Fs(),playCategoryId:zt,name:Tt,pointType:Wt,pointUnitType:Nt,tags:Bt,visible:Ut}]):jt!==null&&Ue(i=>i.map((D,Q)=>Q===jt?{...D,playCategoryId:zt,name:Tt,pointType:Wt,pointUnitType:Nt,tags:Bt,visible:Ut}:D)),Rt(!1)},Ps=()=>{Rt(!1)},bn=i=>{Rs(i),Gt(!0)},Cn=()=>{if(Ts!==null){const i=Ts,D=$e[i];Ue(Q=>Q.filter((je,Te)=>Te!==i)),b("プレー詳細を削除しました","success",{actionLabel:"元に戻す",onAction:()=>{Ue(Q=>{const je=[...Q];return je.splice(i,0,D),je})},autoHideDuration:5e3})}Gt(!1),Rs(null)},Ms=()=>{Gt(!1)};o.useEffect(()=>(B(f?e.jsx(le,{onClick:()=>kt("/settings"),size:"small",children:e.jsx(Gs,{})}):null),()=>B(null)),[B,ue,f,kt]),o.useEffect(()=>(C==null||C(_t),()=>C==null?void 0:C(!1)),[_t,C]),o.useEffect(()=>{_t&&_s()},[_t,_s]);const vn=i=>i.iconType==="svg"&&i.svg?e.jsx(t,{sx:{width:64,height:64},dangerouslySetInnerHTML:{__html:Us(i.svg)}}):i.iconType==="image"&&i.image?e.jsx(t,{component:"img",src:i.image,sx:{width:64,height:64,objectFit:"none",objectPosition:`-${i.cropX||0}px -${i.cropY||0}px`}}):e.jsx(xr,{name:i.name});return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",height:f!==null?"auto":"100dvh",...f!==null?{overflowY:"auto"}:{}},children:[f===null?e.jsx(t,{children:xn.map((i,D)=>e.jsx(Dn,{orientation:"vertical",fullWidth:!0,variant:"outlined",sx:{mb:2,"& .MuiButton-root":{justifyContent:"flex-start",color:Q=>Q.palette.text.secondary,height:50,textAlign:"left"},"& .MuiButton-root .MuiButton-startIcon":{mr:1},"& .MuiButton-root .MuiButton-endIcon":{marginLeft:"auto"},"& .MuiButtonGroup-grouped":{borderColor:"divider"}},children:i.map(Q=>{const je=dn.find(Te=>Te.key===Q);return je?e.jsxs(V,{onClick:Q==="version"?void 0:()=>kt(`/settings/${Q}`),disableRipple:Q==="version",startIcon:je.icon,endIcon:Q==="version"?void 0:Q==="theme"?e.jsxs(t,{sx:{display:"flex",alignItems:"center",color:Te=>Te.palette.text.secondary},children:[e.jsx(t,{component:"span",sx:{mr:1,typography:"button"},children:Ve.name}),e.jsx(es,{})]}):e.jsx(es,{sx:{color:Te=>Te.palette.text.secondary}}),children:[je.label,Q==="version"&&e.jsx(t,{component:"span",sx:{ml:"auto",color:Te=>Te.palette.text.secondary},children:"0.0.1"})]},Q):null})},D))}):null,f!==null&&e.jsx(t,{sx:{mt:0,flexGrow:1,overflowY:"visible"},children:e.jsx($n,{mode:"wait",children:f&&e.jsxs(cr,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[f==="teams"&&e.jsx(Il,{teams:X,setTeams:re,setMembers:pe,selectedTeam:he,setSelectedTeam:ke,createTeam:an,showSnackbar:b}),f==="members"&&(X.length===0?e.jsxs(gt,{severity:"info",children:["チームを登録するとメンバーを設定できるようになります",e.jsx("br",{}),e.jsx(Ot,{component:Mn,to:"/settings/teams",children:"チーム設定へ"})]}):he&&e.jsx(Sl,{teams:X,members:ie,setMembers:pe,selectedTeam:he,setSelectedTeam:ke,showSnackbar:b})),f==="scores"&&e.jsx(kl,{openAddPlayDialog:hn,playCategories:c,setPlayCategories:S,openEditPlayDialog:un,scoreInput:a,renderIcon:vn,rallyCategoryTags:Ne,handlePlayDelete:pn,openAddDetailDialog:jn,playDetails:$e,setPlayDetails:Ue,openEditDetailDialog:mn,theme:Ve,rallyDetailTags:Le,handleDetailDelete:bn}),f==="playCombinations"&&e.jsx(Ol,{playCombinationSetting:a.playCombinationSetting,onChange:i=>m(D=>({...D,playCombinationSetting:i})),playCategories:c,playDetails:$e,showSnackbar:b}),f==="stats"&&e.jsx(El,{statsSettings:dt,setStatsSettings:It,playCategories:c,playDetails:$e,rallyCategoryTags:Ne,rallyDetailTags:Le,showSnackbar:b}),f==="tags"&&e.jsx(Pl,{tags:rt,setTags:wt,rallyCategoryTags:Ne,setRallyCategoryTags:Mt,rallyDetailTags:Le,setRallyDetailTags:Et,setMatches:P,setPlayCategories:S,setPlayDetails:Ue,showSnackbar:b}),f==="locks"&&e.jsx(Fl,{teams:X,matches:$,tags:rt,matchLocks:A,setMatchLocks:de,lockGroupBy:xt,setLockGroupBy:ht}),f==="theme"&&e.jsx(zl,{theme:Ve,onThemeChange:St}),f==="display"&&e.jsx($l,{scoreInput:a,onScoreInputChange:m,dashboardVisible:U,onDashboardVisibleChange:w,showSnackbar:b}),f==="data"&&e.jsx(sr,{onDeleteData:M,onImportData:J,onExportData:F,showSnackbar:b,teams:X,setTeams:re,setMembers:pe,playCategories:c,setPlayCategories:S,setPlayDetails:Ue}),f==="license"&&e.jsx(ar,{})]},f)})}),e.jsxs(ct,{open:te,onClose:Ds,children:[e.jsxs(Pe,{children:["プレー区分",v===-1?"追加":"編集"]}),e.jsxs(Me,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[e.jsx(ve,{label:"プレー区分",value:u,onChange:i=>s(i.target.value),fullWidth:!0,margin:"dense"}),e.jsx(ve,{label:"色",type:"color",value:r,onChange:i=>l(i.target.value),margin:"dense",InputLabelProps:{shrink:!0},fullWidth:!0}),e.jsx(Pt,{multiple:!0,options:Ne,getOptionLabel:i=>i.name,value:Ne.filter(i=>W.includes(i.id)),onChange:(i,D)=>E(D.map(Q=>Q.id)),renderTags:(i,D)=>i.map((Q,je)=>{const{key:Te,...Kt}=D({index:je});return e.jsx(ge,{...Kt,label:Q.name,size:"small",sx:{backgroundColor:Q.color||xe,color:"#fff"}},Te)}),renderInput:i=>e.jsx(ve,{...i,label:"タグ",margin:"dense"})}),e.jsxs(gt,{severity:"info",children:["プレー区分タグは設定＞タグメニューにて追加できます",e.jsx("br",{}),"プレー区分にタグを設定することにより、プレー区分を横串で集計することが可能となります"]}),e.jsxs(pt,{exclusive:!0,value:H?"表示":"非表示",onChange:(i,D)=>D&&se(D==="表示"),fullWidth:!0,children:[e.jsxs(We,{value:"表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Ge,{sx:{mr:1}}),"表示"]}),e.jsxs(We,{value:"非表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Ke,{sx:{mr:1}}),"非表示"]})]}),a.showRallyIcons&&e.jsxs(e.Fragment,{children:[e.jsxs(pt,{exclusive:!0,value:d,onChange:(i,D)=>D&&R(D),children:[e.jsx(We,{value:"設定なし",children:"設定なし"}),e.jsx(We,{value:"SVG",children:"SVG"}),e.jsx(We,{value:"画像",children:"画像"})]}),d==="SVG"&&e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{width:64,height:64},dangerouslySetInnerHTML:{__html:Us(Y)}}),e.jsx(ve,{multiline:!0,minRows:10,label:"SVG",value:Y,onChange:i=>Z(i.target.value),fullWidth:!0,margin:"dense"})]}),d==="画像"&&e.jsxs(e.Fragment,{children:[q&&e.jsx(dr,{src:q,cropX:fe,cropY:x,onChange:(i,D)=>{n(i),k(D)}}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/bmp,image/tiff,image/gif",onChange:i=>{var je;const D=(je=i.target.files)==null?void 0:je[0];if(!D)return;const Q=new FileReader;Q.onload=()=>{ne(Q.result)},Q.readAsDataURL(D)}})]})]})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:Ds,color:"inherit",startIcon:e.jsx(Ae,{}),children:"キャンセル"}),e.jsx(V,{onClick:gn,disabled:u.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(ct,{open:rn,onClose:Ps,children:[e.jsxs(Pe,{children:["プレー詳細",jt===-1?"追加":"編集"]}),e.jsxs(Me,{children:[e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"detail-category-label",children:"プレー区分"}),e.jsx(Oe,{labelId:"detail-category-label",value:zt,label:"プレー区分",onChange:i=>Ht(i.target.value),children:c.map(i=>e.jsx(oe,{value:i.id,children:i.name},i.id))})]}),e.jsx(ve,{fullWidth:!0,label:"プレー詳細",value:Tt,onChange:i=>At(i.target.value),margin:"dense"}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"detail-point-label",children:"得点区分"}),e.jsxs(Oe,{labelId:"detail-point-label",value:Wt,label:"得点区分",onChange:i=>$t(i.target.value),children:[e.jsx(oe,{value:"得点",children:"得点"}),e.jsx(oe,{value:"失点",children:"失点"})]})]}),e.jsxs(De,{fullWidth:!0,margin:"dense",children:[e.jsx(He,{id:"detail-point-unit-label",children:"得失点単位区分"}),e.jsxs(Oe,{labelId:"detail-point-unit-label",value:Nt,label:"得失点単位区分",onChange:i=>Lt(i.target.value),disabled:jt!==-1,children:[e.jsx(oe,{value:"メンバー",children:"メンバー"}),e.jsx(oe,{value:"チーム",children:"チーム"})]})]}),e.jsx(gt,{severity:"warning",sx:{whiteSpace:"pre-line",mt:1},children:`得失点単位区分は追加時にのみ設定でき、後から変更できません
再設定する場合はプレー詳細を作り直してください`}),e.jsx(Pt,{multiple:!0,options:Le,getOptionLabel:i=>i.name,value:Le.filter(i=>Bt.includes(i.id)),onChange:(i,D)=>Ft(D.map(Q=>Q.id)),renderTags:(i,D)=>i.map((Q,je)=>{const Te=Q.color||xe,{key:Kt,...In}=D({index:je});return e.jsx(ge,{...In,label:Q.name,size:"small",sx:{backgroundColor:Te,color:"#fff"}},Kt)}),renderInput:i=>e.jsx(ve,{...i,label:"タグ",margin:"dense"})}),e.jsxs(gt,{severity:"info",sx:{mt:1},children:["プレー詳細タグは設定＞タグメニューにて追加できます",e.jsx("br",{}),"プレー詳細にタグを設定することにより、プレー詳細を横串で集計することが可能となります"]}),e.jsxs(pt,{exclusive:!0,value:Ut?"表示":"非表示",onChange:(i,D)=>D&&Vt(D==="表示"),fullWidth:!0,sx:{mt:2},children:[e.jsxs(We,{value:"表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Ge,{sx:{mr:1}}),"表示"]}),e.jsxs(We,{value:"非表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Ke,{sx:{mr:1}}),"非表示"]})]})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:Ps,color:"inherit",startIcon:e.jsx(Ae,{}),children:"キャンセル"}),e.jsx(V,{onClick:yn,disabled:Tt.trim()==="",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(ut,{open:vt,onClose:Os,children:[e.jsx(Pe,{children:"削除確認"}),e.jsxs(Me,{sx:{mt:2},children:["このプレー区分を削除しますか？",e.jsx(t,{sx:{mt:1},children:"削除すると、すでに入力されている試合のスコアや分析に影響が出る可能性があります。"})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:Os,color:"inherit",startIcon:e.jsx(Ae,{}),children:"キャンセル"}),e.jsx(V,{onClick:fn,color:"error",startIcon:e.jsx(ze,{}),children:"OK"})]})]}),e.jsxs(ut,{open:on,onClose:Ms,children:[e.jsx(Pe,{children:"削除確認"}),e.jsxs(Me,{sx:{mt:2},children:["このプレー詳細を削除しますか？",e.jsx(t,{sx:{mt:1},children:"削除すると、すでに入力されている試合のスコアや分析に影響が出る可能性があります。"})]}),e.jsxs(Ee,{children:[e.jsx(V,{onClick:Ms,color:"inherit",startIcon:e.jsx(Ae,{}),children:"キャンセル"}),e.jsx(V,{onClick:Cn,color:"error",startIcon:e.jsx(ze,{}),children:"OK"})]})]})]})}export{yr as default};
