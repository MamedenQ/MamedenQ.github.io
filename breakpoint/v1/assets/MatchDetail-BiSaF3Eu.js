import{i as Ce,j as e,B as n,v as qe,w as Ne,d as Ee,e as Oe,F as Se,z as Ae,S as we,M as re,x as Ke,m as xe,a as gt,E as Is,g as vt,G as ft,H as Je,Z as Ge,s as ye,L as Xe,f as Le,J as at,K as ot,N as Ie,O as b,Q as dt,I as ze,C as Pe,R as wt,U as fe,A as ns,V as ut,W as Bs,b as Ds,X as Ms,Y as $s,_ as ks,$ as Ct,a0 as Tt,a1 as St,D as At}from"./mui-vendor-ZDpZWGIz.js";import{r as m,f as _s,u as Ps}from"./react-vendor-QLNaZ7XN.js";import{r as Te,u as it,R as xt,d as Ye,a as Qe,b as bt,c as $t,S as nt,e as Ve,f as Re,g as kt,h as ct,D as _t,i as He,A as Rs}from"./index-Cn5cO1ka.js";import{d as zs,a as Fs}from"./QueryStatsOutlined-DAUBhuq5.js";import{d as es}from"./SpaceDashboardOutlined-9ILAlm33.js";import{D as ht,C as Ze,P as et,d as We}from"./DragIndicator-DvNqw2ai.js";import{m as Os,A as Hs}from"./motion-vendor-dPyzewEM.js";import"./chart-vendor-CRzMDpO4.js";var Pt={},Ws=Ce;Object.defineProperty(Pt,"__esModule",{value:!0});var is=Pt.default=void 0,Es=Ws(Te()),Ls=e;is=Pt.default=(0,Es.default)((0,Ls.jsx)("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"}),"PersonOutlineOutlined");var Rt={},Us=Ce;Object.defineProperty(Rt,"__esModule",{value:!0});var ls=Rt.default=void 0,Vs=Us(Te()),qs=e;ls=Rt.default=(0,Vs.default)((0,qs.jsx)("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2zm1-9h1V4H2v1h1zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2zm5-6v2h14V5zm0 14h14v-2H7zm0-6h14v-2H7z"}),"FormatListNumberedOutlined");var zt={},Ns=Ce;Object.defineProperty(zt,"__esModule",{value:!0});var rs=zt.default=void 0,Ks=Ns(Te()),Js=e;rs=zt.default=(0,Ks.default)((0,Js.jsx)("path",{d:"M9 13.75c-2.34 0-7 1.17-7 3.5V19h14v-1.75c0-2.33-4.66-3.5-7-3.5M4.34 17c.84-.58 2.87-1.25 4.66-1.25s3.82.67 4.66 1.25zM9 12c1.93 0 3.5-1.57 3.5-3.5S10.93 5 9 5 5.5 6.57 5.5 8.5 7.07 12 9 12m0-5c.83 0 1.5.67 1.5 1.5S9.83 10 9 10s-1.5-.67-1.5-1.5S8.17 7 9 7m7.04 6.81c1.16.84 1.96 1.96 1.96 3.44V19h4v-1.75c0-2.02-3.5-3.17-5.96-3.44M15 12c1.93 0 3.5-1.57 3.5-3.5S16.93 5 15 5c-.54 0-1.04.13-1.5.35.63.89 1 1.98 1 3.15s-.37 2.26-1 3.15c.46.22.96.35 1.5.35"}),"GroupOutlined");var Ft={},Gs=Ce;Object.defineProperty(Ft,"__esModule",{value:!0});var as=Ft.default=void 0,Xs=Gs(Te()),Ys=e;as=Ft.default=(0,Xs.default)((0,Ys.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V5h14zm-7-2h2V7h-4v2h2z"}),"LooksOneOutlined");var Ot={},Qs=Ce;Object.defineProperty(Ot,"__esModule",{value:!0});var os=Ot.default=void 0,Zs=Qs(Te()),en=e;os=Ot.default=(0,Zs.default)((0,en.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V5h14zm-4-4h-4v-2h2c1.1 0 2-.89 2-2V9c0-1.11-.9-2-2-2H9v2h4v2h-2c-1.1 0-2 .89-2 2v4h6z"}),"LooksTwoOutlined");var Ht={},tn=Ce;Object.defineProperty(Ht,"__esModule",{value:!0});var ds=Ht.default=void 0,sn=tn(Te()),nn=e;ds=Ht.default=(0,sn.default)((0,nn.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V5h14zm-4-4v-1.5c0-.83-.67-1.5-1.5-1.5.83 0 1.5-.67 1.5-1.5V9c0-1.11-.9-2-2-2H9v2h4v2h-2v2h2v2H9v2h4c1.1 0 2-.89 2-2"}),"Looks3Outlined");var Wt={},ln=Ce;Object.defineProperty(Wt,"__esModule",{value:!0});var cs=Wt.default=void 0,rn=ln(Te()),an=e;cs=Wt.default=(0,rn.default)((0,an.jsx)("path",{d:"M19.04 3h-14c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16h-14V5h14zm-6-2h2V7h-2v4h-2V7h-2v6h4z"}),"Looks4Outlined");var Et={},on=Ce;Object.defineProperty(Et,"__esModule",{value:!0});var us=Et.default=void 0,dn=on(Te()),cn=e;us=Et.default=(0,dn.default)((0,cn.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V5h14zm-4-4v-2c0-1.11-.9-2-2-2h-2V9h4V7H9v6h4v2H9v2h4c1.1 0 2-.89 2-2"}),"Looks5Outlined");var Lt={},un=Ce;Object.defineProperty(Lt,"__esModule",{value:!0});var xs=Lt.default=void 0,xn=un(Te()),hn=e;xs=Lt.default=(0,xn.default)((0,hn.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");var Ut={},mn=Ce;Object.defineProperty(Ut,"__esModule",{value:!0});var It=Ut.default=void 0,pn=mn(Te()),fn=e;It=Ut.default=(0,pn.default)((0,fn.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"}),"UndoOutlined");var Vt={},jn=Ce;Object.defineProperty(Vt,"__esModule",{value:!0});var Bt=Vt.default=void 0,gn=jn(Te()),bn=e;Bt=Vt.default=(0,gn.default)((0,bn.jsx)("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7z"}),"RedoOutlined");var qt={},yn=Ce;Object.defineProperty(qt,"__esModule",{value:!0});var Dt=qt.default=void 0,vn=yn(Te()),Cn=e;Dt=qt.default=(0,vn.default)((0,Cn.jsx)("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4z"}),"ArrowRightAlt");function Tn(s){if(typeof window>"u")return s;try{const j=new DOMParser().parseFromString(s,"image/svg+xml"),T=new Set(["svg","g","path","circle","rect","line","polygon","polyline","text","defs","use"]),h=c=>{[...c.children].forEach(r=>{if(T.has(r.tagName))[...r.attributes].forEach($=>{$.name.startsWith("on")&&r.removeAttribute($.name)}),h(r);else{const $=document.createTextNode(r.outerHTML);r.replaceWith($)}})};return h(j.documentElement),j.documentElement.outerHTML}catch{return""}}function Sn({name:s}){const g=m.useRef(null),[j,T]=m.useState(1);return m.useEffect(()=>{const h=g.current;if(!h)return;const c=h.getBBox().width;T(c>64?64/c:1)},[s]),e.jsx("svg",{width:64,height:64,children:e.jsx("g",{transform:`scale(${j})`,children:e.jsx("text",{ref:g,x:32/j,y:32/j,textAnchor:"middle",dominantBaseline:"central",fontSize:8,children:s})})})}function jt({category:s,borderColor:g}){const j=g?{border:"1px solid",borderColor:g,boxSizing:"border-box"}:{};return s.iconType==="svg"&&s.svg?e.jsx(n,{sx:{width:64,height:64,...j},dangerouslySetInnerHTML:{__html:Tn(s.svg)}}):s.iconType==="image"&&s.image?e.jsx(n,{component:"img",src:s.image,sx:{width:64,height:64,objectFit:"none",objectPosition:`-${s.cropX||0}px -${s.cropY||0}px`,...j}}):e.jsx(n,{sx:{width:64,height:64,display:"flex",...j},children:e.jsx(Sn,{name:s.name})})}function An(s,g,j){const T=m.useCallback(r=>{let $=0,y=0;r.rallies.forEach(P=>{if(P.timeoutTeam||P.substitutionTeam)return;const R=g.find(V=>V.id===P.teamAPlayDetail),Z=g.find(V=>V.id===P.teamBPlayDetail);(R==null?void 0:R.pointType)==="得点"||(Z==null?void 0:Z.pointType)==="失点"?$+=1:((Z==null?void 0:Z.pointType)==="得点"||(R==null?void 0:R.pointType)==="失点")&&(y+=1)}),r.my=$,r.opponent=y},[g]),h=m.useCallback(r=>{const $=[...s.rallies,r],y={...s,rallies:$};T(y),j(y)},[s,T,j]),c=m.useCallback(r=>{const $=s.rallies.filter((P,R)=>R!==r),y={...s,rallies:$};T(y),j(y)},[s,T,j]);return{addRally:h,deleteRally:c,calculateScores:T}}const wn=m.forwardRef(function({setScore:g,playDetails:j,playCategories:T,teamAMembers:h,teamBMembers:c,teamAName:r,teamBName:$,scoreInputSetting:y,themeSetting:P,locked:R=!1,onAdd:Z,onEdit:V},N){var I,F,w,i,p,k,L,W;const E=it("sm"),[ae,se]=m.useState(!1),[Y,ee]=m.useState("teamA"),[C,ce]=m.useState(""),[de,oe]=m.useState(""),[f,te]=m.useState(""),[G,S]=m.useState(""),[v,_]=m.useState(""),[D,O]=m.useState(""),[Q,me]=m.useState(""),[ne,be]=m.useState(""),[je,ke]=m.useState(null),_e=()=>{if(R)return;ke(null);const t=[...g.rallies].reverse().find(q=>!q.timeoutTeam&&!q.substitutionTeam);let x="teamA";if(t){const q=j.find(H=>H.id===t.teamAPlayDetail),K=j.find(H=>H.id===t.teamBPlayDetail);(q==null?void 0:q.pointType)==="得点"||(K==null?void 0:K.pointType)==="失点"?x="teamA":((K==null?void 0:K.pointType)==="得点"||(q==null?void 0:q.pointType)==="失点")&&(x="teamB")}ee(x),ce(""),oe(""),te(""),S(""),_(""),O(""),me(""),be(""),se(!0)},ge=t=>{var q,K;if(R)return;const x=g.rallies[t];ke(t),ee(x.serverTeam||"teamA"),ce(x.server&&(x.serverTeam==="teamA"?h.some(H=>H.id===x.server):c.some(H=>H.id===x.server))?x.server:""),oe(((q=j.find(H=>H.id===x.teamAPlayDetail))==null?void 0:q.playCategoryId)||""),S(x.teamAPlayDetail||""),O(h.some(H=>H.id===x.teamAMember)&&x.teamAMember||""),te(((K=j.find(H=>H.id===x.teamBPlayDetail))==null?void 0:K.playCategoryId)||""),_(x.teamBPlayDetail||""),me(c.some(H=>H.id===x.teamBMember)&&x.teamBMember||""),be(x.timeoutTeam||""),se(!0)};m.useImperativeHandle(N,()=>({openAddDialog:_e,openEditDialog:ge}));const Be=()=>{var H,l;if(ne)return!0;if(y.rallyMemberRequired&&!C||de&&!G||f&&!v||!!!(de&&G)&&!!!(f&&v))return!1;const q=(H=j.find(a=>a.id===G))==null?void 0:H.pointUnitType;if(y.rallyMemberRequired&&G&&q==="メンバー"&&!D)return!1;const K=(l=j.find(a=>a.id===v))==null?void 0:l.pointUnitType;return!(y.rallyMemberRequired&&v&&K==="メンバー"&&!Q)},o=t=>ne?{id:t??crypto.randomUUID(),timeoutTeam:ne}:{id:t??crypto.randomUUID(),serverTeam:Y,server:C||void 0,teamAPlayDetail:G||void 0,teamAMember:D||void 0,teamBPlayDetail:v||void 0,teamBMember:Q||void 0},u=()=>{if(je===null)Z(o());else{const t=g.rallies[je].id;V(je,o(t))}se(!1)};return e.jsxs(xt,{open:ae,onClose:()=>se(!1),children:[e.jsx(qe,{children:je===null?"ラリー追加":"ラリー編集"}),e.jsxs(Ne,{sx:{display:"flex",flexDirection:"column"},children:[e.jsxs(Ee,{exclusive:!0,value:Y,onChange:(t,x)=>x&&ee(x),fullWidth:!0,disabled:!!ne,sx:{mb:1},children:[e.jsx(Oe,{value:"teamA",sx:{flex:1},children:e.jsx(n,{sx:{whiteSpace:"pre-line",textAlign:"center"},children:`${r||"チームA"}
サーブ`})}),e.jsx(Oe,{value:"teamB",sx:{flex:1},children:e.jsx(n,{sx:{whiteSpace:"pre-line",textAlign:"center"},children:`${$||"チームB"}
サーブ`})})]}),e.jsxs(Se,{fullWidth:!0,margin:"dense",required:y.rallyMemberRequired,disabled:!!ne,children:[e.jsx(Ae,{id:"server",children:"サーバー"}),e.jsx(we,{labelId:"server",value:C,label:"サーバー",onChange:t=>ce(t.target.value),children:(Y==="teamA"?h:c).map(t=>e.jsx(re,{value:t.id,children:t.name},t.id))})]}),E?e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(n,{sx:{flex:1,display:"flex",flexDirection:"column",gap:1},children:[e.jsx(Ee,{sx:{mt:2,mb:1},orientation:"vertical",exclusive:!0,value:de,onChange:(t,x)=>{de===x||x===null?(oe(""),S("")):(oe(x),S(""))},disabled:!!ne,children:T.filter(t=>t.visible!==!1).map(t=>e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap"},children:t.name},t.id))}),e.jsx(Ee,{orientation:"vertical",exclusive:!0,value:G,onChange:(t,x)=>{S(G===x||x===null?"":x)},disabled:!!ne,children:j.filter(t=>t.playCategoryId===de&&t.visible!==!1).map(t=>{const x=t.pointType==="得点"?P.scoreColor:P.lossColor;return e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap",color:x,"&.Mui-selected":{color:x}},children:t.name},t.id)})}),e.jsxs(Se,{fullWidth:!0,margin:"dense",required:y.rallyMemberRequired&&((I=j.find(t=>t.id===G))==null?void 0:I.pointUnitType)==="メンバー",disabled:!!ne,children:[e.jsx(Ae,{id:"amem",children:`${r||"チームA"}メンバー`}),e.jsxs(we,{labelId:"amem",value:D,label:`${r||"チームA"}メンバー`,onChange:t=>O(t.target.value),disabled:((F=j.find(t=>t.id===G))==null?void 0:F.pointUnitType)!=="メンバー",children:[e.jsx(re,{value:"",children:e.jsx("em",{children:"なし"})}),h.map(t=>e.jsx(re,{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs(n,{sx:{flex:1,display:"flex",flexDirection:"column",gap:1},children:[e.jsx(Ee,{orientation:"vertical",exclusive:!0,value:f,onChange:(t,x)=>{f===x||x===null?(te(""),_("")):(te(x),_(""))},disabled:!!ne,children:T.filter(t=>t.visible!==!1).map(t=>e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap"},children:t.name},t.id))}),e.jsx(Ee,{orientation:"vertical",exclusive:!0,value:v,onChange:(t,x)=>{_(v===x||x===null?"":x)},sx:{mt:1},disabled:!!ne,children:j.filter(t=>t.playCategoryId===f&&t.visible!==!1).map(t=>{const x=t.pointType==="得点"?P.scoreColor:P.lossColor;return e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap",color:x,"&.Mui-selected":{color:x}},children:t.name},t.id)})}),e.jsxs(Se,{fullWidth:!0,margin:"dense",required:y.rallyMemberRequired&&((w=j.find(t=>t.id===v))==null?void 0:w.pointUnitType)==="メンバー",disabled:!!ne,children:[e.jsx(Ae,{id:"bmem",children:`${$||"チームB"}メンバー`}),e.jsxs(we,{labelId:"bmem",value:Q,label:`${$||"チームB"}メンバー`,onChange:t=>me(t.target.value),disabled:((i=j.find(t=>t.id===v))==null?void 0:i.pointUnitType)!=="メンバー",children:[e.jsx(re,{value:"",children:e.jsx("em",{children:"なし"})}),c.map(t=>e.jsx(re,{value:t.id,children:t.name},t.id))]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{display:"flex",gap:2,mt:1},children:[e.jsx(Ee,{orientation:"vertical",exclusive:!0,value:de,onChange:(t,x)=>{de===x||x===null?(oe(""),S("")):(oe(x),S(""))},disabled:!!ne,sx:{flex:"1 1 25%"},children:T.filter(t=>t.visible!==!1).map(t=>e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap"},children:t.name},t.id))}),e.jsx(Ee,{orientation:"vertical",exclusive:!0,value:G,onChange:(t,x)=>{S(G===x||x===null?"":x)},disabled:!!ne,sx:{flex:"1 1 25%"},children:j.filter(t=>t.playCategoryId===de&&t.visible!==!1).map(t=>{const x=t.pointType==="得点"?P.scoreColor:P.lossColor;return e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap",color:x,"&.Mui-selected":{color:x}},children:t.name},t.id)})}),e.jsx(Ee,{orientation:"vertical",exclusive:!0,value:f,onChange:(t,x)=>{f===x||x===null?(te(""),_("")):(te(x),_(""))},disabled:!!ne,sx:{flex:"1 1 25%"},children:T.filter(t=>t.visible!==!1).map(t=>e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap"},children:t.name},t.id))}),e.jsx(Ee,{orientation:"vertical",exclusive:!0,value:v,onChange:(t,x)=>{_(v===x||x===null?"":x)},disabled:!!ne,sx:{flex:"1 1 25%"},children:j.filter(t=>t.playCategoryId===f&&t.visible!==!1).map(t=>{const x=t.pointType==="得点"?P.scoreColor:P.lossColor;return e.jsx(Oe,{value:t.id,sx:{whiteSpace:"nowrap",color:x,"&.Mui-selected":{color:x}},children:t.name},t.id)})})]}),e.jsxs(n,{sx:{display:"flex",gap:2,mt:1},children:[e.jsxs(Se,{fullWidth:!0,margin:"dense",required:y.rallyMemberRequired&&((p=j.find(t=>t.id===G))==null?void 0:p.pointUnitType)==="メンバー",disabled:!!ne,sx:{flex:1},children:[e.jsx(Ae,{id:"amem",children:`${r||"チームA"}メンバー`}),e.jsxs(we,{labelId:"amem",value:D,label:`${r||"チームA"}メンバー`,onChange:t=>O(t.target.value),disabled:((k=j.find(t=>t.id===G))==null?void 0:k.pointUnitType)!=="メンバー",children:[e.jsx(re,{value:"",children:e.jsx("em",{children:"なし"})}),h.map(t=>e.jsx(re,{value:t.id,children:t.name},t.id))]})]}),e.jsxs(Se,{fullWidth:!0,margin:"dense",required:y.rallyMemberRequired&&((L=j.find(t=>t.id===v))==null?void 0:L.pointUnitType)==="メンバー",disabled:!!ne,sx:{flex:1},children:[e.jsx(Ae,{id:"bmem",children:`${$||"チームB"}メンバー`}),e.jsxs(we,{labelId:"bmem",value:Q,label:`${$||"チームB"}メンバー`,onChange:t=>me(t.target.value),disabled:((W=j.find(t=>t.id===v))==null?void 0:W.pointUnitType)!=="メンバー",children:[e.jsx(re,{value:"",children:e.jsx("em",{children:"なし"})}),c.map(t=>e.jsx(re,{value:t.id,children:t.name},t.id))]})]})]})]})]}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:()=>se(!1),color:"inherit",startIcon:e.jsx(Ye,{}),children:"キャンセル"}),e.jsx(xe,{onClick:u,disabled:!Be(),startIcon:e.jsx(Qe,{}),children:"OK"})]})]})});var Nt={},In=Ce;Object.defineProperty(Nt,"__esModule",{value:!0});var hs=Nt.default=void 0,Bn=In(Te()),Dn=e;hs=Nt.default=(0,Bn.default)((0,Dn.jsx)("path",{d:"M16 17.01V10h-2v7.01h-3L15 21l4-3.99zM9 3 5 6.99h3V14h2V6.99h3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99zM9 3 5 6.99h3V14h2V6.99h3z"}),"SwapVertOutlined");const Mn=m.forwardRef(function({teamAMembers:g,teamBMembers:j,onSave:T},h){const[c,r]=m.useState(!1),[$,y]=m.useState("teamA"),[P,R]=m.useState(""),[Z,V]=m.useState(""),[N,E]=m.useState(null),ae=C=>{y(C),R(""),V(""),E(null),r(!0)},se=(C,ce,de,oe)=>{y(ce),R(de),V(oe),E(C),r(!0)};m.useImperativeHandle(h,()=>({openAddDialog:ae,openEditDialog:se}));const Y=()=>{r(!1),E(null)},ee=()=>{T($,P,Z,N),r(!1),E(null)};return e.jsxs(xt,{open:c,onClose:Y,children:[e.jsx(qe,{children:"選手交代"}),e.jsx(Ne,{children:e.jsxs(n,{component:"form",sx:{mt:2},children:[e.jsxs(Se,{fullWidth:!0,sx:{mb:2},children:[e.jsx(Ae,{id:"out-member",children:"OUT"}),e.jsx(we,{labelId:"out-member",value:P,label:"OUT",onChange:C=>R(C.target.value),children:($==="teamA"?g:j).map(C=>e.jsx(re,{value:C.id,children:`${C.no}:${C.name}`},C.id))})]}),e.jsx(n,{sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsx(hs,{sx:{width:32,height:32}})}),e.jsxs(Se,{fullWidth:!0,children:[e.jsx(Ae,{id:"in-member",children:"IN"}),e.jsx(we,{labelId:"in-member",value:Z,label:"IN",onChange:C=>V(C.target.value),children:($==="teamA"?g:j).map(C=>e.jsx(re,{value:C.id,children:`${C.no}:${C.name}`},C.id))})]})]})}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:Y,color:"inherit",startIcon:e.jsx(Ye,{}),children:"キャンセル"}),e.jsx(xe,{onClick:ee,disabled:!P||!Z,startIcon:e.jsx(Qe,{}),children:"OK"})]})]})});var Kt={},$n=Ce;Object.defineProperty(Kt,"__esModule",{value:!0});var ms=Kt.default=void 0,kn=$n(Te()),_n=e;ms=Kt.default=(0,kn.default)((0,_n.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"}),"AccessTimeOutlined");var Jt={},Pn=Ce;Object.defineProperty(Jt,"__esModule",{value:!0});var ps=Jt.default=void 0,Rn=Pn(Te()),zn=e;ps=Jt.default=(0,Rn.default)((0,zn.jsx)("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99zM21 9l-3.99-4v3H10v2h7.01v3z"}),"SwapHorizOutlined");function Fn({teamAName:s,teamBName:g,locked:j,disableTimeoutA:T,disableTimeoutB:h,onTimeout:c,onSubstitution:r,onAddRally:$}){const y=gt(),[P,R]=m.useState(!1),[Z,V]=m.useState(!1),N="tutorial-settab-add-rally",[E,ae]=m.useState(()=>!localStorage.getItem(N));return j?null:e.jsxs(Is,{children:[e.jsxs(vt,{ariaLabel:"substitution actions",direction:"left",icon:e.jsx(ps,{}),onOpen:()=>V(!0),onClose:()=>V(!1),open:Z,FabProps:{size:"large"},sx:{position:"fixed",right:35,bottom:200},children:[e.jsx(ft,{icon:e.jsx(e.Fragment,{children:g||"チームB"}),tooltipTitle:"",FabProps:{variant:"extended",size:"small"},onClick:()=>{r("teamB"),V(!1)}}),e.jsx(ft,{icon:e.jsx(e.Fragment,{children:s||"チームA"}),tooltipTitle:"",FabProps:{variant:"extended",size:"small"},onClick:()=>{r("teamA"),V(!1)}})]}),e.jsxs(vt,{ariaLabel:"timeout actions",direction:"left",icon:e.jsx(ms,{}),onOpen:()=>R(!0),onClose:()=>R(!1),open:P,FabProps:{size:"large"},sx:{position:"fixed",right:35,bottom:140},children:[e.jsx(ft,{icon:e.jsx(e.Fragment,{children:g||"チームB"}),tooltipTitle:"",FabProps:{variant:"extended",size:"small",disabled:h},onClick:()=>{c("teamB"),R(!1)}}),e.jsx(ft,{icon:e.jsx(e.Fragment,{children:s||"チームA"}),tooltipTitle:"",FabProps:{variant:"extended",size:"small",disabled:T},onClick:()=>{c("teamA"),R(!1)}})]}),e.jsx(Je,{open:E,onClose:()=>ae(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"left",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${y.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${y.palette.text.secondary}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsx(ye,{variant:"body2",children:"ラリー結果、タイムアウト、メンバー交代を追加できます"}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem(N,"1"),ae(!1)},children:"了解した"})})]}),children:e.jsx(vt,{ariaLabel:"rally actions",direction:"left",icon:e.jsx(bt,{}),FabProps:{size:"large",onClick:$},sx:{position:"fixed",right:35,bottom:80}})})]})}function On({setScore:s,playDetails:g,playCategories:j,teamAMembers:T,teamBMembers:h,teamAName:c,teamBName:r,onChange:$,locked:y=!1,scoreInputSetting:P,themeSetting:R,showSnackbar:Z}){const V=gt(),[N,E]=m.useState(!1),{addRally:ae,deleteRally:se,calculateScores:Y}=An(s,g,$),ee=m.useRef(null),{handleTouchEnd:C,setSwiperRef:ce}=$t(),de=it("md"),f=!it("sm")&&P.showRallyIcons,te=!de&&P.showScoreProgressArea,G=j.find(l=>l.id==="init-serve"),S=s.rallies.filter(l=>l.timeoutTeam==="teamA").length,v=s.rallies.filter(l=>l.timeoutTeam==="teamB").length,_=S>=2,D=v>=2,O=m.useRef({}),[Q,me]=m.useState({});m.useLayoutEffect(()=>{const l={};s.rallies.forEach(a=>{const A=O.current[a.id];A&&(l[a.id]=A.offsetHeight)}),me(l)},[s.rallies]);const ne=l=>{if(!l)return;const a=g.find(A=>A.id===l);return j.find(A=>A.id===(a==null?void 0:a.playCategoryId))},be=(l,a)=>{if(!a)return"－";const M=(l==="teamA"?T:h).find(J=>J.id===a);return M?`${M.no}:${M.name}`:"－"},je=m.useRef(null),ke=l=>{const a=!localStorage.getItem("tutorial-rally-row");ae(l),a&&E(!0)},_e=(l,a)=>{const A=[...s.rallies];A[l]=a;const M={...s,rallies:A};Y(M),$(M)},ge=l=>{if(y||l==="teamA"&&_||l==="teamB"&&D)return;const a=!localStorage.getItem("tutorial-rally-row");ae({id:crypto.randomUUID(),timeoutTeam:l}),a&&E(!0)},Be=l=>{var a;y||(a=ee.current)==null||a.openAddDialog(l)},o=l=>{var A;if(y)return;const a=s.rallies[l];a.substitutionTeam&&((A=ee.current)==null||A.openEditDialog(l,a.substitutionTeam,a.outMember||"",a.inMember||""))},u=(l,a,A,M)=>{if(y)return;const J=!localStorage.getItem("tutorial-rally-row"),U=[...s.rallies];M!==null?U[M]={...U[M],substitutionTeam:l,outMember:a,inMember:A}:U.push({id:crypto.randomUUID(),substitutionTeam:l,outMember:a,inMember:A});const ie={...s,rallies:U};Y(ie),$(ie),J&&E(!0)},I=l=>{if(!l.destination||y)return;const a=Array.from(s.rallies),[A]=a.splice(l.source.index,1);a.splice(l.destination.index,0,A);const M={...s,rallies:a};Y(M),$(M)},F=l=>{if(y)return;const a={...s,rallies:[...s.rallies]};se(l),Z("ラリーを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{const A={...a,rallies:[...a.rallies]};Y(A),$(A)},autoHideDuration:5e3})},w=l=>{let a=0,A=0,M=null;s.rallies.slice(0,l+1).forEach(ie=>{if(ie.timeoutTeam||ie.substitutionTeam)return;const De=g.find(Fe=>Fe.id===ie.teamAPlayDetail),Me=g.find(Fe=>Fe.id===ie.teamBPlayDetail);(De==null?void 0:De.pointType)==="得点"||(Me==null?void 0:Me.pointType)==="失点"?(a+=1,M="A"):(Me==null?void 0:Me.pointType)==="得点"||(De==null?void 0:De.pointType)==="失点"?(A+=1,M="B"):M=null});const J=V.palette.text.primary,U=V.palette.mode==="dark"?"#343A42":"#D3D3D3";return e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:M==="A"?J:U},children:String(a).padStart(2,"0")}),e.jsx("span",{style:{color:U},children:" - "}),e.jsx("span",{style:{color:M==="B"?J:U},children:String(A).padStart(2,"0")})]})},i=[],p=[];let k=0,L=0;s.rallies.forEach(l=>{if(l.timeoutTeam||l.substitutionTeam)return;const a=g.find(M=>M.id===l.teamAPlayDetail),A=g.find(M=>M.id===l.teamBPlayDetail);(a==null?void 0:a.pointType)==="得点"||(A==null?void 0:A.pointType)==="失点"?(k+=1,p.push("A")):(A==null?void 0:A.pointType)==="得点"||(a==null?void 0:a.pointType)==="失点"?(L+=1,p.push("B")):p.push(null),i.push({a:k,b:L})});const W=40,t=[];for(let l=0;l<p.length-1;l++){const a=p[l],A=p[l+1];a&&A&&a!==A&&t.push({from:a,index:l})}const x=p.map((l,a)=>l&&a>0&&l===p[a-1]),q=i.length*W,K=(l,a,A)=>{var De;if(!l)return e.jsx(e.Fragment,{});const M=ne(l),J=g.find(Me=>Me.id===l),U=A==="A"?T:h,ie=(J==null?void 0:J.pointType)==="得点"?R.scoreColor:(J==null?void 0:J.pointType)==="失点"?R.lossColor:void 0;return e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[M?e.jsx(Pe,{label:M.name,size:"small",sx:{bgcolor:M.color,color:"common.white",mb:.5,height:20,fontSize:"0.75rem","& .MuiChip-label":{px:.5}}}):null,J?e.jsx(Pe,{label:J.name,size:"small",sx:{bgcolor:ie,color:"common.white",mb:.5,height:20,fontSize:"0.75rem","& .MuiChip-label":{px:.5}}}):null,e.jsx(ye,{variant:"caption",noWrap:!0,sx:{width:"100%",textAlign:"center"},children:(J==null?void 0:J.pointUnitType)==="メンバー"&&((De=U.find(Me=>Me.id===a))==null?void 0:De.name)||"－"})]})},H=(l,a,A)=>{var M,J;return e.jsx(n,{ref:A.innerRef,...A.draggableProps,"data-index":a,sx:{mb:.5},children:e.jsxs(kt,{onSwiper:U=>ce(l.id,U),threshold:20,slidesPerView:"auto",style:{overflow:"hidden",height:Q[l.id]},onTouchStart:(U,ie)=>ie.stopPropagation(),onTouchEnd:U=>C(l.id,U),children:[e.jsx(ct,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(n,{ref:U=>{O.current[l.id]=U},onClick:()=>{var U;y||(l.substitutionTeam?o(a):l.timeoutTeam||(U=je.current)==null||U.openEditDialog(a))},sx:{display:"grid",gridTemplateColumns:"6% 16% 20% 22% 20% 16%",alignItems:"center",cursor:y||l.timeoutTeam?"default":"pointer",backgroundColor:U=>l.timeoutTeam||l.substitutionTeam?U.palette.mode==="dark"?"#343A42":"#f5f5f5":void 0},children:[e.jsx(n,{...A.dragHandleProps,onClick:U=>U.stopPropagation(),sx:{cursor:y?"default":"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(We,{fontSize:"small"})}),l.timeoutTeam?e.jsxs(n,{gridColumn:"2 / 7",sx:{...Ve,display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:[l.timeoutTeam==="teamA"?c||"チームA":r||"チームB","タイムアウト"]}):l.substitutionTeam?e.jsxs(n,{gridColumn:"2 / 7",sx:{...Ve,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[e.jsxs("span",{children:[l.substitutionTeam==="teamA"?c||"チームA":r||"チームB","選手交代"]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx("span",{children:be(l.substitutionTeam,l.outMember)}),e.jsx(Dt,{fontSize:"small",sx:{mx:1}}),e.jsx("span",{children:be(l.substitutionTeam,l.inMember)})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{children:l.serverTeam==="teamA"?e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[f&&(G?e.jsx(jt,{category:G}):e.jsxs("svg",{width:64,height:64,children:[e.jsx("rect",{width:64,height:64,fill:"none",stroke:"currentColor"}),e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"central",fontSize:"12",children:"サーブ"})]})),e.jsx(ye,{variant:"caption",noWrap:!0,sx:{width:"100%",textAlign:"center"},children:((M=T.find(U=>U.id===l.server))==null?void 0:M.name)||"－"})]}):null}),e.jsx(n,{children:K(l.teamAPlayDetail,l.teamAMember,"A")}),e.jsx(n,{sx:{fontSize:"2em",display:"flex",justifyContent:"center"},children:w(a)}),e.jsx(n,{children:K(l.teamBPlayDetail,l.teamBMember,"B")}),e.jsx(n,{children:l.serverTeam==="teamB"?e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[f&&(G?e.jsx(jt,{category:G}):e.jsxs("svg",{width:64,height:64,children:[e.jsx("rect",{width:64,height:64,fill:"none",stroke:"currentColor"}),e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"central",fontSize:"12",children:"サーブ"})]})),e.jsx(ye,{variant:"caption",noWrap:!0,sx:{width:"100%",textAlign:"center"},children:((J=h.find(U=>U.id===l.server))==null?void 0:J.name)||"－"})]}):null})]})]})}),e.jsx(ct,{style:{width:_t,flex:"0 0 auto"},children:e.jsx(n,{sx:{height:Q[l.id],display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(ze,{size:"small",onClick:()=>F(a),children:e.jsx(Re,{fontSize:"small",sx:{color:"common.white"}})})})})]})})};return e.jsxs(n,{sx:{position:"relative",display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(n,{sx:{display:"flex",gap:2,flex:1,minHeight:0},children:[te&&e.jsxs(n,{sx:{flex:"0 0 20%",overflowY:"auto",height:"100%",position:"relative"},children:[i.map((l,a)=>{const A=a===0?{a:0,b:0}:i[a-1],M=l.a!==A.a&&l.a!==0,J=l.b!==A.b&&l.b!==0,U=M&&x[a],ie=J&&x[a];return e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",alignItems:"center",py:.5,height:`${W}px`,position:"relative",zIndex:1},children:[e.jsx(n,{}),e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{display:"flex",justifyContent:"center"},children:M?e.jsx(n,{sx:{width:32,height:32,border:"1px solid",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:24,borderColor:U?"red":"currentColor",backgroundColor:U?"#ffebee":"#fff",color:"black"},children:l.a}):null}),e.jsx(n,{}),e.jsx(n,{sx:{display:"flex",justifyContent:"center"},children:J?e.jsx(n,{sx:{width:32,height:32,border:"1px solid",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:24,borderColor:ie?"red":"currentColor",backgroundColor:ie?"#ffebee":"#fff",color:"black"},children:l.b}):null})]}),e.jsx(n,{})]},a)}),e.jsx("svg",{viewBox:`0 0 100 ${q}`,style:{position:"absolute",left:0,top:0,width:"100%",height:q,zIndex:0},preserveAspectRatio:"none",pointerEvents:"none",children:t.map(l=>{const a=l.index*W+W/2,A=(l.index+1)*W+W/2,M=l.from==="A"?30:70,J=l.from==="A"?70:30;return e.jsx("line",{x1:M,y1:a,x2:J,y2:A,stroke:"currentColor",strokeWidth:1},l.index)})})]}),e.jsx(n,{sx:{flex:1,overflowY:"auto",height:"100%",maxWidth:1024,width:"100%",mx:"auto",mb:2},children:e.jsx(Je,{open:N,onClose:()=>E(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${V.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${V.palette.text.secondary}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsxs(ye,{variant:"body2",children:["行をタップすることでラリー結果を編集できます",e.jsx("br",{}),"左端の",e.jsx(We,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"をドラッグすることでラリー結果の順番を入れ替えることができます",e.jsx("br",{}),"右端の",e.jsx(Re,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"をタップすることでラリー結果を削除することができます"]}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem("tutorial-rally-row","1"),E(!1)},children:"了解した"})})]}),children:e.jsx(n,{children:e.jsxs(ht,{onDragEnd:I,children:[de&&e.jsx(nt,{component:Le,storageKey:"set-tab",children:e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"6% 16% 20% 22% 20% 16%",textAlign:"center",alignItems:"center",...Ve},children:[e.jsx(n,{}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("span",{children:c||"チームA"}),e.jsx("span",{children:"サーブ"})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("span",{children:c||"チームA"}),e.jsx("span",{children:"ラリー結果"})]}),e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:"得点"}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("span",{children:r||"チームB"}),e.jsx("span",{children:"ラリー結果"})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("span",{children:r||"チームB"}),e.jsx("span",{children:"サーブ"})]})]}),e.jsx(Ze,{droppableId:"rallies",children:l=>e.jsxs(n,{ref:l.innerRef,...l.droppableProps,children:[s.rallies.map((a,A)=>e.jsx(et,{draggableId:a.id,index:A,isDragDisabled:y,children:M=>H(a,A,M)},a.id)),l.placeholder]})})]})}),!de&&e.jsx(nt,{component:Le,storageKey:"set-tab",children:e.jsxs(at,{size:"small",sx:{tableLayout:"fixed","& th, & td":{textAlign:"center",verticalAlign:"middle"}},children:[e.jsx(ot,{children:e.jsxs(Ie,{sx:{...Ve},children:[e.jsx(b,{sx:{width:"6%"}}),e.jsx(b,{sx:{width:"16%"},children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:c||"チームA"}),e.jsx("span",{children:"サーブ"})]})}),e.jsx(b,{sx:{width:"18%"},children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:c||"チームA"}),e.jsx("span",{children:"ラリー結果"})]})}),e.jsx(b,{sx:{width:"20%",display:"flex",justifyContent:"center",alignItems:"center"},children:"得点"}),e.jsx(b,{sx:{width:"18%"},children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:r||"チームB"}),e.jsx("span",{children:"ラリー結果"})]})}),e.jsx(b,{sx:{width:"16%"},children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:r||"チームB"}),e.jsx("span",{children:"サーブ"})]})}),e.jsx(b,{sx:{width:"6%"}})]})}),e.jsx(Ze,{droppableId:"rallies",children:l=>e.jsxs(dt,{ref:l.innerRef,...l.droppableProps,children:[s.rallies.map((a,A)=>e.jsx(et,{draggableId:a.id,index:A,isDragDisabled:y,children:M=>{var J,U;return e.jsxs(Ie,{ref:M.innerRef,...M.draggableProps,"data-index":A,onClick:()=>{var ie;y||(a.substitutionTeam?o(A):a.timeoutTeam||(ie=je.current)==null||ie.openEditDialog(A))},sx:{cursor:y||a.timeoutTeam?"default":"pointer",backgroundColor:ie=>a.timeoutTeam||a.substitutionTeam?ie.palette.mode==="dark"?"#343A42":"#f5f5f5":void 0},children:[e.jsx(b,{padding:"checkbox",sx:{width:"6%"},children:e.jsx(n,{onClick:ie=>ie.stopPropagation(),...M.dragHandleProps,sx:{cursor:y?"default":"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(We,{fontSize:"small"})})}),a.timeoutTeam?e.jsx(b,{colSpan:5,sx:{width:"88%"},children:e.jsxs(n,{sx:{...Ve,display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:[a.timeoutTeam==="teamA"?c||"チームA":r||"チームB","タイムアウト"]})}):a.substitutionTeam?e.jsx(b,{colSpan:5,sx:{width:"88%"},children:e.jsxs(n,{sx:{...Ve,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[e.jsxs("span",{children:[a.substitutionTeam==="teamA"?c||"チームA":r||"チームB","選手交代"]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx("span",{children:be(a.substitutionTeam,a.outMember)}),e.jsx(Dt,{fontSize:"small",sx:{mx:1}}),e.jsx("span",{children:be(a.substitutionTeam,a.inMember)})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(b,{sx:{width:"16%"},children:a.serverTeam==="teamA"?e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[f&&(G?e.jsx(jt,{category:G}):e.jsxs("svg",{width:64,height:64,children:[e.jsx("rect",{width:64,height:64,fill:"none",stroke:"currentColor"}),e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"central",fontSize:"12",children:"サーブ"})]})),e.jsx(ye,{variant:"caption",noWrap:!0,sx:{width:"100%",textAlign:"center"},children:((J=T.find(ie=>ie.id===a.server))==null?void 0:J.name)||"－"})]}):null}),e.jsx(b,{sx:{width:"18%"},children:K(a.teamAPlayDetail,a.teamAMember,"A")}),e.jsx(b,{sx:{width:"20%",fontSize:"2em",textAlign:"center"},children:w(A)}),e.jsx(b,{sx:{width:"18%"},children:K(a.teamBPlayDetail,a.teamBMember,"B")}),e.jsx(b,{sx:{width:"16%"},children:a.serverTeam==="teamB"?e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[f&&(G?e.jsx(jt,{category:G}):e.jsxs("svg",{width:64,height:64,children:[e.jsx("rect",{width:64,height:64,fill:"none",stroke:"currentColor"}),e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"central",fontSize:"12",children:"サーブ"})]})),e.jsx(ye,{variant:"caption",noWrap:!0,sx:{width:"100%",textAlign:"center"},children:((U=h.find(ie=>ie.id===a.server))==null?void 0:U.name)||"－"})]}):null})]}),e.jsx(b,{padding:"checkbox",sx:{width:"6%"},children:e.jsx(n,{onClick:ie=>ie.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ze,{size:"small",onClick:y?void 0:()=>F(A),disabled:y,sx:{width:24,height:24},children:e.jsx(Re,{fontSize:"small",color:y?"disabled":"error"})})})})]})}},a.id)),l.placeholder]})})]})})]})})})})]}),e.jsx(Fn,{teamAName:c,teamBName:r,locked:y,disableTimeoutA:_,disableTimeoutB:D,onTimeout:ge,onSubstitution:Be,onAddRally:()=>{var l;return(l=je.current)==null?void 0:l.openAddDialog()}}),e.jsx(wn,{ref:je,setScore:s,playDetails:g,playCategories:j,teamAMembers:T,teamBMembers:h,teamAName:c,teamBName:r,scoreInputSetting:P,themeSetting:R,locked:y,onAdd:ke,onEdit:_e}),e.jsx(Mn,{ref:ee,teamAMembers:T,teamBMembers:h,onSave:u})]})}const Hn=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function Wn({statsSettings:s,onChange:g,playCategories:j,playDetails:T,rallyCategoryTags:h,rallyDetailTags:c,disabled:r,showSnackbar:$}){const y=o=>{if(!o.destination)return;const u=Array.from(s),[I]=u.splice(o.source.index,1);u.splice(o.destination.index,0,I),g(u)},P=o=>{var u;return((u=j.find(I=>I.id===o))==null?void 0:u.name)||""},R=o=>{var u;return((u=T.find(I=>I.id===o))==null?void 0:u.name)||""},Z=o=>{const u=o.playCategoryId?P(o.playCategoryId):o.playCategoryTags?o.playCategoryTags.map(p=>{var k;return((k=h.find(L=>L.id===p))==null?void 0:k.name)||p}).join(", "):"",I=o.playDetailId?R(o.playDetailId):o.playDetailTags?o.playDetailTags.map(p=>{var k;return((k=c.find(L=>L.id===p))==null?void 0:k.name)||p}).join(", "):"",F=o.pointType||"",w=o.pointUnitType||"",i=o.aggregateType||"合算";return[u,I,F,w,i].filter(p=>p).join(", ")},[V,N]=m.useState(!1),[E,ae]=m.useState(null),[se,Y]=m.useState(""),[ee,C]=m.useState(""),[ce,de]=m.useState([]),[oe,f]=m.useState([]),[te,G]=m.useState(""),[S,v]=m.useState(""),[_,D]=m.useState("合算"),O=it("md"),Q=it("sm"),{handleTouchEnd:me,setSwiperRef:ne}=$t(),be=()=>{r||(ae(-1),Y(""),C(""),de([]),f([]),G(""),v(""),D("合算"),N(!0))},je=o=>{if(r)return;const u=s[o];ae(o),Y(u.playCategoryId||""),C(u.playDetailId||""),de(u.playCategoryTags||[]),f(u.playDetailTags||[]),G(u.pointType||""),v(u.pointUnitType||""),D(u.aggregateType||"合算"),N(!0)},ke=()=>{const o=se!=="",u=ee!=="",I=ce.length>0,F=oe.length>0,w=te!=="",i=S!=="";return o&&!u&&!I&&!F&&!w&&!i||o&&u&&!I&&!F&&!w&&!i||o&&!u&&!I&&!F&&w&&!i||o&&!u&&!I&&!F&&!w&&i||o&&!u&&!I&&!F&&w&&i||!o&&!u&&!I&&!F&&w&&!i||!o&&!u&&!I&&!F&&w&&i||!o&&!u&&!I&&!F&&!w&&i||I&&!o&&!u&&!F&&!w&&!i||I&&F&&!o&&!u&&!w&&!i||I&&F&&!o&&!u&&w&&!i||I&&F&&!o&&!u&&!w&&i||I&&F&&!o&&!u&&w&&i||I&&!o&&!u&&w&&!i||I&&!o&&!u&&!w&&i||I&&!o&&!u&&w&&i||F&&!o&&!u&&!I&&!w&&!i||F&&!o&&!u&&!I&&w&&!i||F&&!o&&!u&&!I&&!w&&i||F&&!o&&!u&&!I&&w&&i},_e=()=>{const o={id:E===-1?Hn():s[E].id,playCategoryId:se||void 0,playDetailId:ee||void 0,playCategoryTags:se===""&&ce.length>0?ce:void 0,playDetailTags:ee===""&&oe.length>0?oe:void 0,pointType:ee?void 0:te||void 0,pointUnitType:ee?void 0:S||void 0,aggregateType:_};E===-1?g([...s,o]):E!==null&&g(s.map((u,I)=>I===E?o:u)),N(!1)},ge=()=>{N(!1)},Be=o=>{if(r)return;const u=[...s];g(s.filter((I,F)=>F!==o)),$("スタッツ設定を削除しました","success",{actionLabel:"元に戻す",onAction:()=>g(u),autoHideDuration:5e3})};return e.jsxs(n,{children:[e.jsxs(n,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(n,{sx:{fontWeight:"bold"},children:"スタッツ設定"}),e.jsx(xe,{onClick:be,variant:"contained",size:"medium",startIcon:e.jsx(bt,{}),disabled:r,children:"追加"})]}),e.jsx(nt,{component:Le,storageKey:"match-stats-grid",sx:{maxWidth:1024,mx:"auto"},children:O?e.jsx(ht,{onDragEnd:y,children:e.jsx(Ze,{droppableId:"stats-settings",children:o=>e.jsxs(n,{ref:o.innerRef,...o.droppableProps,children:[e.jsx(n,{sx:{display:"grid",gridTemplateColumns:Q?"32px 1fr":"50px 150px 1fr 110px 130px 110px",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ve},children:Q?e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{width:32}}),e.jsx(n,{children:"分析項目"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{width:50}}),e.jsx(n,{children:"プレー区分"}),e.jsx(n,{children:"プレー詳細"}),e.jsx(n,{children:"得点区分"}),e.jsx(n,{children:"得失点単位区分"}),e.jsx(n,{children:"集計方法"})]})}),s.map((u,I)=>e.jsx(et,{draggableId:u.id,index:I,isDragDisabled:r,children:F=>e.jsx(n,{ref:F.innerRef,...F.draggableProps,style:F.draggableProps.style,children:e.jsxs(kt,{onSwiper:w=>ne(u.id,w),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(w,i)=>i.stopPropagation(),onTouchEnd:w=>me(u.id,w),children:[e.jsx(ct,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(n,{onClick:()=>je(I),sx:{display:"grid",gridTemplateColumns:Q?"32px 1fr":"50px 150px 1fr 110px 130px 110px",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:r?"default":"pointer"},children:[e.jsx(n,{...F.dragHandleProps,onClick:w=>w.stopPropagation(),sx:{cursor:r?"default":"grab",display:"flex",touchAction:"none",width:Q?32:50,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(We,{fontSize:"small"})}),Q?e.jsx(n,{children:Z(u)}):e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{pr:1},children:u.playCategoryId?P(u.playCategoryId):u.playCategoryTags&&u.playCategoryTags.length>0?e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.playCategoryTags.map(w=>{const i=h.find(p=>p.id===w);return e.jsx(Pe,{label:(i==null?void 0:i.name)||w,size:"small",sx:{backgroundColor:(i==null?void 0:i.color)||He,color:"#fff"}},w)})}):""}),e.jsx(n,{sx:{pr:1},children:u.playDetailId?R(u.playDetailId):u.playDetailTags&&u.playDetailTags.length>0?e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.playDetailTags.map(w=>{const i=c.find(p=>p.id===w);return e.jsx(Pe,{label:(i==null?void 0:i.name)||w,size:"small",sx:{backgroundColor:(i==null?void 0:i.color)||He,color:"#fff"}},w)})}):""}),e.jsx(n,{sx:{pr:1},children:u.pointType||""}),e.jsx(n,{sx:{pr:1},children:u.pointUnitType||""}),e.jsx(n,{children:u.aggregateType||"合算"})]})]})}),e.jsx(ct,{style:{width:_t,flex:"0 0 auto"},children:e.jsx(n,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(ze,{size:"small",onClick:()=>Be(I),disabled:r,children:e.jsx(Re,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},u.id)),o.placeholder]})})}):e.jsxs(at,{size:"small",children:[e.jsx(ot,{children:e.jsxs(Ie,{sx:{backgroundColor:o=>o.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(b,{}),e.jsx(b,{children:"プレー区分"}),e.jsx(b,{children:"プレー詳細"}),e.jsx(b,{children:"得点区分"}),e.jsx(b,{children:"得失点単位区分"}),e.jsx(b,{children:"集計方法"}),e.jsx(b,{})]})}),e.jsx(ht,{onDragEnd:y,children:e.jsx(Ze,{droppableId:"stats-settings",children:o=>e.jsxs(dt,{ref:o.innerRef,...o.droppableProps,children:[s.map((u,I)=>e.jsx(et,{draggableId:u.id,index:I,isDragDisabled:r,children:F=>e.jsxs(Ie,{ref:F.innerRef,...F.draggableProps,onClick:()=>je(I),sx:{cursor:r?"default":"pointer",height:50},children:[e.jsx(b,{padding:"checkbox",sx:{width:48},children:e.jsx(n,{...F.dragHandleProps,onClick:w=>w.stopPropagation(),sx:{cursor:r?"default":"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(We,{})})}),e.jsx(b,{children:u.playCategoryId?P(u.playCategoryId):u.playCategoryTags&&u.playCategoryTags.length>0?e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.playCategoryTags.map(w=>{const i=h.find(p=>p.id===w);return e.jsx(Pe,{label:(i==null?void 0:i.name)||w,size:"small",sx:{backgroundColor:(i==null?void 0:i.color)||He,color:"#fff"}},w)})}):""}),e.jsx(b,{children:u.playDetailId?R(u.playDetailId):u.playDetailTags&&u.playDetailTags.length>0?e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:u.playDetailTags.map(w=>{const i=c.find(p=>p.id===w);return e.jsx(Pe,{label:(i==null?void 0:i.name)||w,size:"small",sx:{backgroundColor:(i==null?void 0:i.color)||He,color:"#fff"}},w)})}):""}),e.jsx(b,{children:u.pointType||""}),e.jsx(b,{children:u.pointUnitType||""}),e.jsx(b,{children:u.aggregateType||"合算"}),e.jsx(b,{padding:"checkbox",children:e.jsx(ze,{size:"small",onClick:w=>{w.stopPropagation(),Be(I)},disabled:r,children:e.jsx(Re,{fontSize:"small"})})})]})},u.id)),o.placeholder]})})})]})}),e.jsxs(xt,{open:V,onClose:ge,children:[e.jsxs(qe,{children:["スタッツ設定",E===-1?"追加":"編集"]}),e.jsxs(Ne,{children:[e.jsxs(Se,{fullWidth:!0,margin:"dense",children:[e.jsx(Ae,{id:"stat-category-label",children:"プレー区分"}),e.jsxs(we,{labelId:"stat-category-label",value:se,label:"プレー区分",onChange:o=>{Y(o.target.value),C(""),de([]),f([])},disabled:ce.length>0||oe.length>0,children:[e.jsx(re,{value:"",children:"なし"}),j.map(o=>e.jsx(re,{value:o.id,children:o.name},o.id))]})]}),e.jsxs(Se,{fullWidth:!0,margin:"dense",children:[e.jsx(Ae,{id:"stat-detail-label",children:"プレー詳細"}),e.jsxs(we,{labelId:"stat-detail-label",value:ee,label:"プレー詳細",onChange:o=>{C(o.target.value),G(""),v(""),de([]),f([])},disabled:te!==""||S!==""||ce.length>0||oe.length>0,children:[e.jsx(re,{value:"",children:"なし"}),T.filter(o=>o.playCategoryId===se).map(o=>e.jsx(re,{value:o.id,children:o.name},o.id))]})]}),e.jsx(wt,{multiple:!0,options:h,getOptionLabel:o=>o.name,value:h.filter(o=>ce.includes(o.id)),onChange:(o,u)=>{de(u.map(I=>I.id)),u.length>0&&(Y(""),C(""))},disabled:se!==""||ee!=="",renderTags:(o,u)=>o.map((I,F)=>e.jsx(Pe,{...u({index:F}),label:I.name,size:"small",sx:{backgroundColor:I.color||He,color:"#fff"}})),renderInput:o=>e.jsx(fe,{...o,label:"プレー区分タグ",margin:"dense"}),fullWidth:!0}),e.jsx(wt,{multiple:!0,options:c,getOptionLabel:o=>o.name,value:c.filter(o=>oe.includes(o.id)),onChange:(o,u)=>{f(u.map(I=>I.id)),u.length>0&&(Y(""),C(""))},disabled:se!==""||ee!=="",renderTags:(o,u)=>o.map((I,F)=>e.jsx(Pe,{...u({index:F}),label:I.name,size:"small",sx:{backgroundColor:I.color||He,color:"#fff"}})),renderInput:o=>e.jsx(fe,{...o,label:"プレー詳細タグ",margin:"dense"}),fullWidth:!0}),e.jsxs(n,{children:[e.jsxs(Se,{fullWidth:!0,margin:"dense",children:[e.jsx(Ae,{id:"stat-point-label",children:"得点区分"}),e.jsxs(we,{labelId:"stat-point-label",value:te,label:"得点区分",onChange:o=>{G(o.target.value),o.target.value!==""&&C("")},disabled:ee!=="",children:[e.jsx(re,{value:"",children:"なし"}),e.jsx(re,{value:"得点",children:"得点"}),e.jsx(re,{value:"失点",children:"失点"})]})]}),e.jsxs(Se,{fullWidth:!0,margin:"dense",children:[e.jsx(Ae,{id:"stat-unit-label",children:"得失点単位区分"}),e.jsxs(we,{labelId:"stat-unit-label",value:S,label:"得失点単位区分",onChange:o=>{v(o.target.value),o.target.value!==""&&C("")},disabled:ee!=="",children:[e.jsx(re,{value:"",children:"なし"}),e.jsx(re,{value:"メンバー",children:"メンバー"}),e.jsx(re,{value:"チーム",children:"チーム"})]})]})]}),e.jsxs(Se,{fullWidth:!0,margin:"dense",children:[e.jsx(Ae,{id:"stat-aggregate-label",children:"集計方法"}),e.jsxs(we,{labelId:"stat-aggregate-label",value:_,label:"集計方法",onChange:o=>D(o.target.value),children:[e.jsx(re,{value:"合算",children:"合算"}),e.jsx(re,{value:"セット平均",children:"セット平均"})]})]})]}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:ge,color:"inherit",startIcon:e.jsx(Ye,{}),children:"キャンセル"}),e.jsx(xe,{onClick:_e,disabled:!ke(),startIcon:e.jsx(Qe,{}),children:"OK"})]})]})]})}function ts(s,g,j){var h,c;if(!s)return!1;const T=g.get(s.playCategoryId);return!(j.playDetailId&&s.id!==j.playDetailId||j.playCategoryId&&s.playCategoryId!==j.playCategoryId||j.playCategoryTags&&j.playCategoryTags.length>0&&!((h=T==null?void 0:T.tags)!=null&&h.some(r=>j.playCategoryTags.includes(r)))||j.playDetailTags&&j.playDetailTags.length>0&&!((c=s.tags)!=null&&c.some(r=>j.playDetailTags.includes(r)))||j.pointType&&s.pointType!==j.pointType||j.pointUnitType&&s.pointUnitType!==j.pointUnitType)}function ss(s,g,j,T){const h=T.map(()=>({teamA:0,teamB:0}));return s.forEach(c=>{c.rallies.forEach(r=>{T.forEach(($,y)=>{const P=r.teamAPlayDetail?g.get(r.teamAPlayDetail):void 0;ts(P,j,$)&&(h[y].teamA+=1);const R=r.teamBPlayDetail?g.get(r.teamBPlayDetail):void 0;ts(R,j,$)&&(h[y].teamB+=1)})})}),h}function En(s,g){const j=[];let T=0,h=0,c=0,r=0;return s.forEach(y=>{let P=0,R=0,Z=0,V=0;y.rallies.forEach(N=>{if(N.timeoutTeam||N.substitutionTeam||!N.serverTeam)return;const E=N.teamAPlayDetail?g.get(N.teamAPlayDetail):void 0,ae=N.teamBPlayDetail?g.get(N.teamBPlayDetail):void 0;N.serverTeam==="teamA"?(R+=1,(E&&E.pointType==="得点"||ae&&ae.pointType==="失点")&&(P+=1)):(V+=1,(ae&&ae.pointType==="得点"||E&&E.pointType==="失点")&&(Z+=1))}),T+=P,h+=R,c+=Z,r+=V,j.push({teamA:R?`${Math.round(P/R*100)}%`:"-",teamB:V?`${Math.round(Z/V*100)}%`:"-"})}),{overall:{teamA:h?`${Math.round(T/h*100)}%`:"-",teamB:r?`${Math.round(c/r*100)}%`:"-"},perSet:j}}function Ln(s,g){const j=[];let T=0,h=0,c=0,r=0;return s.forEach(y=>{let P=0,R=0,Z=0,V=0;y.rallies.forEach(N=>{if(N.timeoutTeam||N.substitutionTeam||!N.serverTeam)return;const E=N.teamAPlayDetail?g.get(N.teamAPlayDetail):void 0,ae=N.teamBPlayDetail?g.get(N.teamBPlayDetail):void 0;N.serverTeam==="teamB"?(R+=1,(E&&E.pointType==="得点"||ae&&ae.pointType==="失点")&&(P+=1)):(V+=1,(ae&&ae.pointType==="得点"||E&&E.pointType==="失点")&&(Z+=1))}),T+=P,h+=R,c+=Z,r+=V,j.push({teamA:R?`${Math.round(P/R*100)}%`:"-",teamB:V?`${Math.round(Z/V*100)}%`:"-"})}),{overall:{teamA:h?`${Math.round(T/h*100)}%`:"-",teamB:r?`${Math.round(c/r*100)}%`:"-"},perSet:j}}function Un({sets:s,playDetails:g,playCategories:j,statsSettings:T,matchStatsSettings:h,onMatchStatsSettingsChange:c,rallyCategoryTags:r,rallyDetailTags:$,teamAName:y,teamBName:P,locked:R,showSnackbar:Z}){const V=new Map(g.map(S=>[S.id,S])),N=new Map(j.map(S=>[S.id,S])),E=S=>{var v;return((v=j.find(_=>_.id===S))==null?void 0:v.name)||""},ae=S=>{var v;return((v=g.find(_=>_.id===S))==null?void 0:v.name)||""},se=[...T,...h],Y=ss(s,V,N,se),ee=s.map(S=>ss([S],V,N,se)),C=Y.map((S,v)=>{if(se[v].aggregateType==="セット平均"){const D=s.length||1;return{teamA:(S.teamA/D).toFixed(1),teamB:(S.teamB/D).toFixed(1)}}return S}),ce=ee.map(S=>se.reduce((v,_,D)=>(_.aggregateType!=="セット平均"&&v.push(S[D]),v),[])),de=se.filter(S=>S.aggregateType!=="セット平均"),oe=En(s,V),f=Ln(s,V),te=S=>{const v=[];S.playCategoryId?v.push(e.jsx("span",{children:E(S.playCategoryId)},"cat")):S.playCategoryTags&&S.playCategoryTags.length>0&&v.push(e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",mt:.5},children:S.playCategoryTags.map(D=>{const O=r.find(Q=>Q.id===D);return e.jsx(Pe,{label:(O==null?void 0:O.name)||D,size:"small",sx:{mr:.5,mb:.5,backgroundColor:(O==null?void 0:O.color)||He,color:"#fff"}},D)})},"catTags")),S.playDetailId?v.push(e.jsx("span",{children:ae(S.playDetailId)},"detail")):S.playDetailTags&&S.playDetailTags.length>0&&v.push(e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",mt:.5},children:S.playDetailTags.map(D=>{const O=$.find(Q=>Q.id===D);return e.jsx(Pe,{label:(O==null?void 0:O.name)||D,size:"small",sx:{mr:.5,mb:.5,backgroundColor:(O==null?void 0:O.color)||He,color:"#fff"}},D)})},"detailTags"));const _=[];return S.pointType&&_.push(S.pointType),S.pointUnitType&&_.push(S.pointUnitType),_.length>0&&v.push(e.jsx("span",{children:_.join(",")},"point")),v.push(e.jsxs("span",{children:["(",S.aggregateType||"合算",")"]},"agg")),e.jsx(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:v.map((D,O)=>e.jsx(n,{sx:{display:"flex",justifyContent:"center"},children:D},O))})},G=(S,v,_,D,O)=>e.jsx(nt,{component:Le,storageKey:O,sx:{mb:2},children:e.jsxs(at,{size:"small",sx:{"& th, & td":{textAlign:"center",verticalAlign:"middle"}},children:[e.jsx(ot,{children:e.jsxs(Ie,{sx:{backgroundColor:Q=>Q.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(b,{children:y||"チームA"}),e.jsx(b,{children:"項目"}),e.jsx(b,{children:P||"チームB"})]})}),e.jsxs(dt,{children:[e.jsxs(Ie,{sx:{height:50},children:[e.jsx(b,{children:v.teamA}),e.jsx(b,{children:"ブレイク率"}),e.jsx(b,{children:v.teamB})]},"break-rate"),e.jsxs(Ie,{sx:{height:50},children:[e.jsx(b,{children:_.teamA}),e.jsx(b,{children:"サイドアウト率"}),e.jsx(b,{children:_.teamB})]},"sideout-rate"),D.map((Q,me)=>e.jsxs(Ie,{sx:{height:50},children:[e.jsx(b,{children:S[me].teamA}),e.jsx(b,{children:te(Q)}),e.jsx(b,{children:S[me].teamB})]},Q.id))]})]})});return e.jsxs(n,{sx:{display:"grid",gap:2,gridTemplateColumns:{xs:"1fr",md:"repeat(2, 1fr)"},maxWidth:1024,width:"100%",mx:"auto"},children:[e.jsxs(n,{children:[e.jsx(ye,{variant:"h6",sx:{mb:1},children:"試合全体のスタッツ"}),G(C,oe.overall,f.overall,se,"stats-overall")]}),s.map((S,v)=>e.jsxs(n,{children:[e.jsx(ye,{variant:"h6",sx:{mb:1},children:`${v+1}セット目(${S.my}-${S.opponent})のスタッツ`}),G(ce[v],oe.perSet[v],f.perSet[v],de,`stats-set-${v}`)]},S.id)),e.jsxs(n,{sx:{gridColumn:"1 / -1"},children:[e.jsx(Wn,{statsSettings:h,onChange:c,playCategories:j,playDetails:g,rallyCategoryTags:r,rallyDetailTags:$,disabled:R,showSnackbar:Z}),e.jsxs(ns,{severity:"info",sx:{mt:1},children:["本設定は試合内のみでの設定となります",e.jsx("br",{}),"各試合共通でのスタッツ項目の設定は設定＞スタッツメニューから設定してください"]})]})]})}var Gt={},Vn=Ce;Object.defineProperty(Gt,"__esModule",{value:!0});var Mt=Gt.default=void 0,qn=Vn(Te()),Nn=e;Mt=Gt.default=(0,qn.default)((0,Nn.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd");const Kn=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function Jn({match:s,setMatch:g,teamAName:j,teamBName:T,teamMembers:h,onAddMember:c,locked:r,showSnackbar:$}){const y=gt(),P=it("md"),R=it("sm"),{handleTouchEnd:Z,setSwiperRef:V}=$t(),N="tutorial-member-select",[E,ae]=m.useState(()=>!localStorage.getItem(N)),se="tutorial-member-row",[Y,ee]=m.useState(null),[C,ce]=m.useState(!1),[de,oe]=m.useState(!1),[f,te]=m.useState(""),[G,S]=m.useState(""),[v,_]=m.useState([]),[D,O]=m.useState("teamA"),[Q,me]=m.useState([]),ne=i=>{if(!i.destination||i.source.droppableId!==i.destination.droppableId||r)return;const p=i.source.droppableId==="teamA"?"teamAMembers":"teamBMembers",k=Array.from(s[p]),[L]=k.splice(i.source.index,1);k.splice(i.destination.index,0,L),g(W=>({...W,[p]:k}))},be=m.useMemo(()=>{const i=D==="teamA"?s.teamA:s.teamB,p=h[i]||[],k=D==="teamA"?s.teamAMembers:s.teamBMembers;return p.filter(L=>L.visible!==!1&&!k.some(W=>W.id===L.id))},[D,s,h]),je=i=>{O(i),me([]),ce(!0)},ke=i=>{me(p=>p.some(L=>L.id===i.id)?p.filter(L=>L.id!==i.id):[...p,i])},_e=()=>{const i=!localStorage.getItem(se);g(D==="teamA"?p=>({...p,teamAMembers:[...p.teamAMembers,...Q.map(k=>({...k,statuses:Array(p.sets.length).fill("")}))]}):p=>({...p,teamBMembers:[...p.teamBMembers,...Q.map(k=>({...k,statuses:Array(p.sets.length).fill("")}))]})),ce(!1),i&&ee(D)},ge=()=>{ce(!1)},Be=(i,p)=>{if(r)return;let k;const L=i==="teamA"?"teamAMembers":"teamBMembers";g(W=>{const t=[...W[L]];k=t[p];const x=t.filter((q,K)=>K!==p);return{...W,[L]:x}}),$("メンバーを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{k&&g(W=>{const t=[...W[L]];return t.splice(p,0,k),{...W,[L]:t}})},autoHideDuration:5e3})},o=()=>{r||(te(""),S(""),_([]),oe(!0))},u=()=>{const i=D==="teamA"?s.teamA:s.teamB;i&&c(i,{id:Kn(),no:Number(f),name:G,positions:v}),oe(!1)},I=()=>{oe(!1)},F=(i,p,k)=>{r||g(L=>{const W=i==="teamA"?"teamAMembers":"teamBMembers",t=[...L[W]],x={...t[p]},q=[...x.statuses||Array(L.sets.length).fill("")],K=q[k]||"";let H="";return K===""?H="starter":K==="starter"?H="libero":H="",q[k]=H,x.statuses=q,t[p]=x,{...L,[W]:t}})},w=i=>{const p=i==="teamA"?s.teamAMembers:s.teamBMembers,k=i,L=R?"32px 50px 1fr":`32px 40px 1fr ${s.sets.map(()=>"70px").join(" ")}`;return e.jsxs(n,{sx:{maxWidth:1024,mx:"auto",overflowX:"auto"},children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:L,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ve},children:[e.jsx(n,{}),e.jsx(n,{children:"番号"}),e.jsx(n,{children:"名前"}),!R&&s.sets.map((W,t)=>e.jsx(n,{textAlign:"center",children:t+1},t))]}),e.jsx(Ze,{droppableId:k,children:W=>e.jsxs(n,{ref:W.innerRef,...W.droppableProps,children:[p.map((t,x)=>e.jsx(et,{draggableId:`${k}-${t.id}`,index:x,isDragDisabled:r,children:q=>e.jsx(n,{ref:q.innerRef,...q.draggableProps,children:e.jsxs(kt,{onSwiper:K=>V(`${k}-${t.id}`,K),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(K,H)=>H.stopPropagation(),onTouchEnd:K=>Z(`${k}-${t.id}`,K),children:[e.jsx(ct,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:L,alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",backgroundColor:"background.paper"},children:[e.jsx(n,{onClick:K=>K.stopPropagation(),...q.dragHandleProps,sx:{cursor:r?"default":"grab",display:"flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(We,{})}),e.jsx(n,{children:t.no}),e.jsx(n,{children:t.name}),!R&&s.sets.map((K,H)=>{var l,a,A,M,J,U;return e.jsx(n,{sx:{textAlign:"center"},children:e.jsx(xe,{size:"small",variant:(l=t.statuses)!=null&&l[H]?"contained":"outlined",color:((a=t.statuses)==null?void 0:a[H])==="starter"?"primary":void 0,sx:{minWidth:32,width:32,p:0,...((A=t.statuses)==null?void 0:A[H])==="starter"?{backgroundColor:"primary.main",color:"#fff","&:hover":{backgroundColor:"primary.main"}}:((M=t.statuses)==null?void 0:M[H])==="libero"?{backgroundColor:"#FF9933",color:"#fff","&:hover":{backgroundColor:"#FF9933"},"&.Mui-focusVisible":{outline:"2px solid #FF9933"}}:{}},onClick:()=>F(i,x,H),disabled:r,children:((J=t.statuses)==null?void 0:J[H])==="starter"?"出":((U=t.statuses)==null?void 0:U[H])==="libero"?"リ":"不"})},H)})]})}),e.jsx(ct,{style:{width:_t,flex:"0 0 auto"},children:e.jsx(n,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(ze,{size:"small",onClick:()=>Be(i,x),children:e.jsx(Re,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},t.id)),W.placeholder]})})]})};return e.jsxs(ht,{onDragEnd:ne,children:[e.jsxs(ut,{container:!0,spacing:2,children:[e.jsxs(ut,{item:!0,xs:12,children:[e.jsxs(n,{sx:{maxWidth:1024,mx:"auto"},children:[e.jsx(ye,{variant:"h6",sx:{mb:1},children:j}),e.jsx(xe,{variant:"contained",size:"medium",sx:{mb:1},onClick:()=>je("teamA"),disabled:r,startIcon:e.jsx(Mt,{}),children:"メンバー登録"})]}),e.jsx(Je,{open:E,onClose:()=>ae(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${y.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${y.palette.text.secondary}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsx(ye,{variant:"body2",children:"各セットのラリー結果を入力する際に選択するメンバーとして表示されますが、未登録の場合においてもラリー結果の入力自体は可能です"}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem(N,"1"),ae(!1)},children:"了解した"})})]}),children:e.jsx(n,{children:e.jsx(Je,{open:Y==="teamA",onClose:()=>ee(null),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${y.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${y.palette.text.secondary}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsxs(ye,{variant:"body2",children:["左側の",e.jsx(We,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"をドラッグすることで順番を入れ替えることができます",e.jsx("br",{}),"右側の",e.jsx(Re,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"をタップすることで削除ができます",e.jsx("br",{}),"各セットごとで出場設定をすることができますが、現状は何かに使われることはありません（今後の機能アップデートにて利用）"]}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem(se,"1"),ee(null)},children:"了解した"})})]}),children:e.jsx(n,{children:P?w("teamA"):e.jsx(nt,{component:Le,storageKey:"members-teamA",sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(at,{size:"small",children:[e.jsx(ot,{children:e.jsxs(Ie,{sx:{backgroundColor:i=>i.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(b,{}),e.jsx(b,{children:"番号"}),e.jsx(b,{children:"名前"}),e.jsx(b,{children:"ポジション"}),s.sets.map((i,p)=>e.jsx(b,{align:"center",children:p+1},p)),e.jsx(b,{})]})}),e.jsx(Ze,{droppableId:"teamA",children:i=>e.jsxs(dt,{ref:i.innerRef,...i.droppableProps,children:[s.teamAMembers.map((p,k)=>e.jsx(et,{draggableId:`teamA-${p.id}`,index:k,isDragDisabled:r,children:L=>e.jsxs(Ie,{ref:L.innerRef,...L.draggableProps,"data-index":k,sx:{cursor:r?"default":"pointer",height:50},children:[e.jsx(b,{padding:"checkbox",children:e.jsx(n,{onClick:W=>W.stopPropagation(),...L.dragHandleProps,sx:{cursor:r?"default":"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(We,{})})}),e.jsx(b,{children:p.no}),e.jsx(b,{children:p.name}),e.jsx(b,{children:(p.positions||[]).join(", ")}),s.sets.map((W,t)=>{var x,q,K,H,l,a;return e.jsx(b,{padding:"checkbox",align:"center",children:e.jsx(xe,{size:"small",variant:(x=p.statuses)!=null&&x[t]?"contained":"outlined",color:((q=p.statuses)==null?void 0:q[t])==="starter"?"primary":void 0,sx:{minWidth:32,width:32,p:0,...((K=p.statuses)==null?void 0:K[t])==="starter"?{backgroundColor:"primary.main",color:"#fff","&:hover":{backgroundColor:"primary.main"}}:((H=p.statuses)==null?void 0:H[t])==="libero"?{backgroundColor:"#FF9933",color:"#fff","&:hover":{backgroundColor:"#FF9933"},"&.Mui-focusVisible":{outline:"2px solid #FF9933"}}:{}},onClick:()=>F("teamA",k,t),disabled:r,children:((l=p.statuses)==null?void 0:l[t])==="starter"?"出":((a=p.statuses)==null?void 0:a[t])==="libero"?"リ":"不"})},t)}),e.jsx(b,{padding:"checkbox",children:e.jsx(n,{onClick:W=>W.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ze,{size:"small",onClick:r?void 0:()=>Be("teamA",k),disabled:r,sx:{width:24,height:24},children:e.jsx(Re,{fontSize:"small",color:r?"disabled":"error"})})})})]})},p.id)),i.placeholder]})})]})})})})})})]}),e.jsxs(ut,{item:!0,xs:12,children:[e.jsxs(n,{sx:{maxWidth:1024,mx:"auto"},children:[e.jsx(ye,{variant:"h6",sx:{mb:1},children:T}),e.jsx(xe,{variant:"contained",size:"medium",sx:{mb:1},onClick:()=>je("teamB"),disabled:r,startIcon:e.jsx(Mt,{}),children:"メンバー登録"})]}),e.jsx(Je,{open:Y==="teamB",onClose:()=>ee(null),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${y.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${y.palette.text.secondary}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsxs(ye,{variant:"body2",children:["左側の",e.jsx(We,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"をドラッグすることで順番を入れ替えることができます",e.jsx("br",{}),"右側の",e.jsx(Re,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"をタップすることで削除ができます",e.jsx("br",{}),"各セットごとで出場設定をすることができますが、現状は何かに使われることはありません（今後の機能アップデートにて利用）"]}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem(se,"1"),ee(null)},children:"了解した"})})]}),children:e.jsx(n,{children:P?w("teamB"):e.jsx(nt,{component:Le,storageKey:"members-teamB",sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(at,{size:"small",children:[e.jsx(ot,{children:e.jsxs(Ie,{sx:{backgroundColor:i=>i.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(b,{}),e.jsx(b,{children:"番号"}),e.jsx(b,{children:"名前"}),e.jsx(b,{children:"ポジション"}),s.sets.map((i,p)=>e.jsx(b,{align:"center",children:p+1},p)),e.jsx(b,{})]})}),e.jsx(Ze,{droppableId:"teamB",children:i=>e.jsxs(dt,{ref:i.innerRef,...i.droppableProps,children:[s.teamBMembers.map((p,k)=>e.jsx(et,{draggableId:`teamB-${p.id}`,index:k,isDragDisabled:r,children:L=>e.jsxs(Ie,{ref:L.innerRef,...L.draggableProps,"data-index":k,sx:{cursor:r?"default":"pointer",height:50},children:[e.jsx(b,{padding:"checkbox",children:e.jsx(n,{onClick:W=>W.stopPropagation(),...L.dragHandleProps,sx:{cursor:r?"default":"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(We,{})})}),e.jsx(b,{children:p.no}),e.jsx(b,{children:p.name}),e.jsx(b,{children:(p.positions||[]).join(", ")}),s.sets.map((W,t)=>{var x,q,K,H,l,a;return e.jsx(b,{padding:"checkbox",align:"center",children:e.jsx(xe,{size:"small",variant:(x=p.statuses)!=null&&x[t]?"contained":"outlined",color:((q=p.statuses)==null?void 0:q[t])==="starter"?"primary":void 0,sx:{minWidth:32,width:32,p:0,...((K=p.statuses)==null?void 0:K[t])==="starter"?{backgroundColor:"primary.main",color:"#fff","&:hover":{backgroundColor:"primary.main"}}:((H=p.statuses)==null?void 0:H[t])==="libero"?{backgroundColor:"#FF9933",color:"#fff","&:hover":{backgroundColor:"#FF9933"},"&.Mui-focusVisible":{outline:"2px solid #FF9933"}}:{}},onClick:()=>F("teamB",k,t),disabled:r,children:((l=p.statuses)==null?void 0:l[t])==="starter"?"出":((a=p.statuses)==null?void 0:a[t])==="libero"?"リ":"不"})},t)}),e.jsx(b,{padding:"checkbox",children:e.jsx(n,{onClick:W=>W.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ze,{size:"small",onClick:r?void 0:()=>Be("teamB",k),disabled:r,sx:{width:24,height:24},children:e.jsx(Re,{fontSize:"small",color:r?"disabled":"error"})})})})]})},p.id)),i.placeholder]})})]})})})})]})]}),e.jsxs(xt,{open:C,onClose:ge,children:[e.jsx(qe,{children:"メンバー選択"}),e.jsxs(Ne,{children:[e.jsx(n,{sx:{display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(xe,{onClick:o,variant:"contained",startIcon:e.jsx(bt,{}),disabled:r||!(D==="teamA"?s.teamA:s.teamB),children:"追加"})}),e.jsx(nt,{component:Le,storageKey:`members-select-${D}`,children:e.jsxs(at,{size:"small",children:[e.jsx(ot,{children:e.jsxs(Ie,{sx:{backgroundColor:i=>i.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(b,{padding:"checkbox"}),e.jsx(b,{children:"番号"}),e.jsx(b,{children:"名前"}),e.jsx(b,{children:"ポジション"})]})}),e.jsx(dt,{children:be.map(i=>{const p=Q.some(k=>k.id===i.id);return e.jsxs(Ie,{sx:{cursor:"pointer",height:50},children:[e.jsx(b,{padding:"checkbox",onClick:k=>k.stopPropagation(),children:e.jsx(Bs,{checked:p,onChange:()=>ke(i)})}),e.jsx(b,{children:i.no}),e.jsx(b,{children:i.name}),e.jsx(b,{children:(i.positions||[]).join(", ")})]},i.id)})})]})})]}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:ge,startIcon:e.jsx(Ye,{}),color:"inherit",children:"キャンセル"}),e.jsx(xe,{onClick:_e,disabled:Q.length===0,startIcon:e.jsx(Qe,{}),children:"OK"})]})]}),e.jsxs(xt,{open:de,onClose:I,children:[e.jsx(qe,{children:"メンバー追加"}),e.jsxs(Ne,{children:[e.jsx(fe,{label:"番号",type:"number",value:f,onChange:i=>te(i.target.value),fullWidth:!0,margin:"dense"}),e.jsx(fe,{label:"名前",value:G,onChange:i=>S(i.target.value),fullWidth:!0,margin:"dense"}),e.jsxs(Se,{fullWidth:!0,margin:"dense",children:[e.jsx(Ae,{id:"md-positions-label",children:"ポジション"}),e.jsxs(we,{labelId:"md-positions-label",multiple:!0,value:v,label:"ポジション",onChange:i=>_(typeof i.target.value=="string"?i.target.value.split(","):i.target.value),renderValue:i=>i.join(", "),children:[e.jsx(re,{value:"レフト",children:"レフト"}),e.jsx(re,{value:"センター",children:"センター"}),e.jsx(re,{value:"ライト",children:"ライト"}),e.jsx(re,{value:"セッター",children:"セッター"}),e.jsx(re,{value:"リベロ",children:"リベロ"})]})]})]}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:I,startIcon:e.jsx(Ye,{}),color:"inherit",children:"キャンセル"}),e.jsx(xe,{onClick:u,disabled:f==="",startIcon:e.jsx(Qe,{}),children:"OK"})]})]})]})}function Gn({match:s,setMatch:g,tags:j,onAddTag:T,locked:h}){return e.jsx(n,{sx:{maxWidth:1024,mx:"auto"},children:e.jsx(ut,{container:!0,spacing:2,children:e.jsx(ut,{item:!0,xs:12,children:e.jsxs(Le,{elevation:0,sx:{},children:[e.jsx(fe,{label:"試合日付",type:"date",InputLabelProps:{shrink:!0},value:s.date,onChange:c=>g(r=>({...r,date:c.target.value})),fullWidth:!0,margin:"dense",disabled:h,sx:{"& .MuiOutlinedInput-root":{height:56},"& .MuiOutlinedInput-input":{padding:"0 14px",height:"100%",lineHeight:"56px",fontSize:"1rem",textAlign:"left"},'& input[type="date"]':{WebkitAppearance:"none"}}}),e.jsx(fe,{label:"試合名",value:s.matchName,onChange:c=>g(r=>({...r,matchName:c.target.value})),fullWidth:!0,margin:"dense",disabled:h}),e.jsx(wt,{multiple:!0,freeSolo:!0,options:j,getOptionLabel:c=>typeof c=="string"?c:c.name,value:s.tags.map(c=>j.find(r=>r.id===c)).filter(Boolean),onChange:(c,r)=>{const $=[];r.forEach(y=>{if(typeof y=="string"){const P={id:crypto.randomUUID(),name:y,color:He};T(P),$.push(P.id)}else $.push(y.id)}),g(y=>({...y,tags:$}))},renderTags:(c,r)=>c.map(($,y)=>e.jsx(Pe,{...r({index:y}),label:$.name,sx:{backgroundColor:$.color||He,color:"#fff",mr:.5,mb:.5}})),renderInput:c=>e.jsx(fe,{...c,label:"タグ",margin:"dense"}),fullWidth:!0,disabled:h}),e.jsxs(ns,{severity:"info",sx:{mt:1},children:["試合タグは上記項目にて直接入力するか、設定＞タグメニューにて追加できます",e.jsx("br",{}),"試合にタグを設定することにより、試合を横串で集計することが可能となります"]}),e.jsx(fe,{label:"場所",value:s.location,onChange:c=>g(r=>({...r,location:c.target.value})),fullWidth:!0,margin:"dense",disabled:h}),e.jsx(fe,{label:"主審",value:s.mainReferee,onChange:c=>g(r=>({...r,mainReferee:c.target.value})),fullWidth:!0,margin:"dense",disabled:h}),e.jsx(fe,{label:"副審",value:s.subReferee,onChange:c=>g(r=>({...r,subReferee:c.target.value})),fullWidth:!0,margin:"dense",disabled:h}),e.jsx(fe,{label:"動画URL",value:s.videoUrl,onChange:c=>g(r=>({...r,videoUrl:c.target.value})),multiline:!0,rows:3,fullWidth:!0,margin:"dense",disabled:h}),e.jsx(fe,{label:"メモ",value:s.memo,onChange:c=>g(r=>({...r,memo:c.target.value})),multiline:!0,rows:3,fullWidth:!0,margin:"dense",disabled:h})]})})})})}function Xn({match:s,setMatch:g,teams:j,locked:T}){return e.jsxs(Le,{elevation:0,sx:{},children:[e.jsxs(Se,{fullWidth:!0,margin:"dense",disabled:T,children:[e.jsx(Ae,{id:"teamA-label",children:"チームA"}),e.jsx(we,{labelId:"teamA-label",value:s.teamA,label:"チームA",onChange:h=>g(c=>({...c,teamA:h.target.value,teamAMembers:[]})),disabled:T,children:j.map(h=>e.jsx(re,{value:h.id,children:h.name},h.id))})]}),e.jsx(fe,{label:"チームA監督",value:s.teamAHeadCoach,onChange:h=>g(c=>({...c,teamAHeadCoach:h.target.value})),fullWidth:!0,margin:"dense",disabled:T}),e.jsx(fe,{label:"チームAコーチ",value:s.teamACoach,onChange:h=>g(c=>({...c,teamACoach:h.target.value})),fullWidth:!0,margin:"dense",disabled:T}),e.jsx(fe,{label:"チームAマネージャー",value:s.teamAManager,onChange:h=>g(c=>({...c,teamAManager:h.target.value})),fullWidth:!0,margin:"dense",disabled:T}),e.jsx(fe,{label:"チームAキャプテン",value:s.teamACaptain,onChange:h=>g(c=>({...c,teamACaptain:h.target.value})),fullWidth:!0,margin:"dense",disabled:T}),e.jsxs(Se,{fullWidth:!0,margin:"dense",disabled:T,children:[e.jsx(Ae,{id:"teamB-label",children:"チームB"}),e.jsx(we,{labelId:"teamB-label",value:s.teamB,label:"チームB",onChange:h=>g(c=>({...c,teamB:h.target.value,teamBMembers:[]})),disabled:T,children:j.map(h=>e.jsx(re,{value:h.id,children:h.name},h.id))})]}),e.jsx(fe,{label:"チームB監督",value:s.teamBHeadCoach,onChange:h=>g(c=>({...c,teamBHeadCoach:h.target.value})),fullWidth:!0,margin:"dense",disabled:T}),e.jsx(fe,{label:"チームBコーチ",value:s.teamBCoach,onChange:h=>g(c=>({...c,teamBCoach:h.target.value})),fullWidth:!0,margin:"dense",disabled:T}),e.jsx(fe,{label:"チームBマネージャー",value:s.teamBManager,onChange:h=>g(c=>({...c,teamBManager:h.target.value})),fullWidth:!0,margin:"dense",disabled:T}),e.jsx(fe,{label:"チームBキャプテン",value:s.teamBCaptain,onChange:h=>g(c=>({...c,teamBCaptain:h.target.value})),fullWidth:!0,margin:"dense",disabled:T})]})}const Yn=Os.create(n),Qn=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function di({match:s,onSave:g,teams:j,teamMembers:T,playDetails:h,playCategories:c,statsSettings:r,rallyCategoryTags:$,rallyDetailTags:y,themeSetting:P,scoreInputSetting:R,onAddMember:Z,setAppBarAction:V,setAppBarLeftAction:N,onDirtyChange:E,tags:ae,onAddTag:se}){const Y=_s(),ee=Ps(),[C,ce]=m.useState("info"),de=!1;m.useEffect(()=>{const d=ee.pathname.split("/").filter(Boolean);if(d[0]!=="matches"||d[1]!==s.id)return;const B=d[2]??"info";B==="setinfo"?(ce("info"),Y(`/matches/${s.id}/info`,{replace:!0})):(ce(B),d[2]||Y(`/matches/${s.id}/info`,{replace:!0}))},[ee.pathname,Y,s.id,de]);const oe=m.useCallback(d=>{const B=d.teamA,z=d.teamB,X=(pe,he)=>!!he&&(T[pe]||[]).some(le=>le.id===he&&le.visible!==!1),ue=(pe,he)=>he.filter(le=>X(pe,le.id)).map(le=>{const $e=(T[pe]||[]).find(st=>st.id===le.id);return $e?{...le,no:$e.no,name:$e.name,positions:$e.positions}:le});return{...d,teamAMembers:ue(B,d.teamAMembers),teamBMembers:ue(z,d.teamBMembers),sets:d.sets.map(pe=>({...pe,rallies:pe.rallies.map(he=>({...he,server:X(he.serverTeam==="teamA"?B:z,he.server)?he.server:void 0,teamAMember:X(B,he.teamAMember)?he.teamAMember:void 0,teamBMember:X(z,he.teamBMember)?he.teamBMember:void 0}))}))}},[T]),[f,te]=m.useState(()=>oe({...s,tags:s.tags||[],matchStatsSettings:s.matchStatsSettings||[],teamAMembers:s.teamAMembers.map(d=>({...d,statuses:d.statuses??Array(s.sets.length).fill("")})),teamBMembers:s.teamBMembers.map(d=>({...d,statuses:d.statuses??Array(s.sets.length).fill("")}))})),G=5,S=[as,os,ds,cs,us],v=!!s.locked,_=gt(),D=Ds(_.breakpoints.up("sm")),[O,Q]=m.useState(!1),[me,ne]=m.useState(!1),be=200,je=56,[ke,_e]=m.useState(!1),ge=_.palette.text.secondary,Be=m.useCallback(()=>{O?(ne(!1),Q(!1)):(Q(!0),D||ne(!0))},[O,D]),o=m.useCallback(d=>{d.propertyName==="width"&&D&&O&&ne(!0)},[D,O]);m.useEffect(()=>{D||(Q(!1),ne(!1))},[D]),m.useEffect(()=>(N(e.jsx(Je,{open:ke,onClose:()=>_e(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${ge}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${ge}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsxs(ye,{variant:"body2",children:[e.jsx(es,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"からメニューを開き、各セットのメニューをロングタップし上下にスライドすることでセット順の変更が可能です"]}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem("tutorial-set-reorder","1"),_e(!1)},children:"了解した"})})]}),children:e.jsx(ze,{color:"inherit",onClick:Be,children:e.jsx(es,{})})})),()=>N(null)),[N,Be,ke,ge]);const[u,I]=m.useState(!1),[F,w]=m.useState(!1),[i,p]=m.useState(null),[k,L]=m.useState(!1),[W,t]=m.useState({open:!1,message:"",severity:"success"}),x=(d,B,z)=>{t({open:!0,message:d,severity:B,...z})},q=`matchDraft-${s.id}`,K=m.useRef(!1),[H,l]=m.useState(!1),[a,A]=m.useState(!1),[M,J]=m.useState({}),U=m.useCallback((d,B,z=!0)=>{te(X=>{const ue=[...X.sets],pe=ue.findIndex(le=>le.id===d);if(pe===-1)return X;const he=ue[pe];return z&&J(le=>{const $e=le[d]||{undo:[]};return{...le,[d]:{undo:[...$e.undo,he],redo:[]}}}),ue[pe]=B,{...X,sets:ue}})},[]),ie=m.useCallback(()=>{if(!/^[0-9]+$/.test(C))return;const d=Number(C)-1,B=f.sets[d],z=M[B.id];if(!z||z.undo.length===0)return;const X=z.undo[z.undo.length-1];J(ue=>({...ue,[B.id]:{undo:z.undo.slice(0,-1),redo:[...z.redo,B]}})),U(B.id,X,!1)},[C,f.sets,M,U]),De=m.useCallback(()=>{if(!/^[0-9]+$/.test(C))return;const d=Number(C)-1,B=f.sets[d],z=M[B.id];if(!z||z.redo.length===0)return;const X=z.redo[z.redo.length-1];J(ue=>({...ue,[B.id]:{undo:[...z.undo,B],redo:z.redo.slice(0,-1)}})),U(B.id,X,!1)},[C,f.sets,M,U]),Me=d=>{if(!d.destination||v)return;const B=d.source.index,z=d.destination.index;if(B===z)return;const X=Array.from(f.sets),[ue]=X.splice(B,1);X.splice(z,0,ue);const pe=$e=>$e.map(st=>{const ve=Array.from(st.statuses||[]),[rt]=ve.splice(B,1);return ve.splice(z,0,rt),{...st,statuses:ve}}),he=pe(f.teamAMembers),le=pe(f.teamBMembers);te($e=>({...$e,sets:X,teamAMembers:he,teamBMembers:le}))};m.useEffect(()=>{J(d=>{const B={...d};return Object.keys(B).forEach(z=>{f.sets.some(X=>X.id===z)||delete B[z]}),B})},[f.sets]),m.useEffect(()=>{te(d=>oe(d))},[oe]);const Fe=d=>{var B;return((B=j.find(z=>z.id===d))==null?void 0:B.name)||""},tt=m.useMemo(()=>f.date!==s.date||f.matchName!==s.matchName||f.location!==s.location||f.mainReferee!==s.mainReferee||f.subReferee!==s.subReferee||f.videoUrl!==s.videoUrl||f.memo!==s.memo||f.teamA!==s.teamA||f.teamAHeadCoach!==s.teamAHeadCoach||f.teamACoach!==s.teamACoach||f.teamAManager!==s.teamAManager||f.teamACaptain!==s.teamACaptain||f.teamB!==s.teamB||f.teamBHeadCoach!==s.teamBHeadCoach||f.teamBCoach!==s.teamBCoach||f.teamBManager!==s.teamBManager||f.teamBCaptain!==s.teamBCaptain||JSON.stringify(f.tags)!==JSON.stringify(s.tags)||JSON.stringify(f.teamAMembers)!==JSON.stringify(s.teamAMembers)||JSON.stringify(f.teamBMembers)!==JSON.stringify(s.teamBMembers)||JSON.stringify(f.matchStatsSettings||[])!==JSON.stringify(s.matchStatsSettings||[])||JSON.stringify(f.sets)!==JSON.stringify(s.sets),[f,s]);m.useEffect(()=>{localStorage.getItem(q)&&L(!0)},[q]),m.useEffect(()=>{if(!K.current){K.current=!0;return}tt?localStorage.setItem(q,JSON.stringify(f)):localStorage.removeItem(q)},[f,tt,q]);const fs=()=>{if(v||f.sets.length>=G)return;f.sets.length===1&&!localStorage.getItem("tutorial-set-reorder")&&_e(!0);const d={id:Qn(),my:0,opponent:0,rallies:[]},B=f.sets.length+1;te(z=>({...z,sets:[...z.sets,d],teamAMembers:z.teamAMembers.map(X=>({...X,statuses:[...X.statuses||[],""]})),teamBMembers:z.teamBMembers.map(X=>({...X,statuses:[...X.statuses||[],""]}))})),ce(String(B)),Y(`/matches/${s.id}/${B}`)},js=d=>{v||(p(d),w(!0))},gs=()=>{if(i===null)return;const d=i,B=f.sets.length;let z=[],X=[],ue=[];const pe=C;let he=C;if(C!=="info"&&C!=="members"&&C!=="stats"&&C!=="setinfo"){const le=Number(C)-1;le===d?d>0?(he=String(d),Y(`/matches/${s.id}/${d}`)):B>1?(he="1",Y(`/matches/${s.id}/1`)):(he="info",Y(`/matches/${s.id}/info`)):le>d&&(he=String(le),Y(`/matches/${s.id}/${le}`))}ce(he),te(le=>{z=le.sets.map(ve=>({...ve})),X=le.teamAMembers.map(ve=>({...ve,statuses:ve.statuses?[...ve.statuses]:[]})),ue=le.teamBMembers.map(ve=>({...ve,statuses:ve.statuses?[...ve.statuses]:[]}));const $e=le.sets.filter((ve,rt)=>rt!==d),st=ve=>ve.map(rt=>({...rt,statuses:(rt.statuses||[]).filter((ei,ws)=>ws!==d)}));return{...le,sets:$e,teamAMembers:st(le.teamAMembers),teamBMembers:st(le.teamBMembers)}}),p(null),w(!1),x("セットを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{te(le=>({...le,sets:z,teamAMembers:X,teamBMembers:ue})),pe!=="info"&&pe!=="members"&&pe!=="stats"&&pe!=="setinfo"&&Y(`/matches/${s.id}/${pe}`)},autoHideDuration:5e3})},Xt=()=>{p(null),w(!1)},Yt=m.useCallback(()=>{I(!0)},[]),bs=async()=>{const d=oe(f);te(d);try{await Promise.resolve(g(d)),localStorage.removeItem(q),x("保存しました","success")}catch{x("保存に失敗しました","error")}I(!1)},Qt=()=>{I(!1)},ys=()=>{t(d=>({...d,open:!1}))},vs=()=>{const d=localStorage.getItem(q);if(!d){L(!1);return}try{const B=JSON.parse(d),z={...B,tags:B.tags||[],matchStatsSettings:B.matchStatsSettings||[],teamAMembers:B.teamAMembers.map(ue=>({...ue,statuses:ue.statuses??Array(B.sets.length).fill("")})),teamBMembers:B.teamBMembers.map(ue=>({...ue,statuses:ue.statuses??Array(B.sets.length).fill("")}))},X=oe(z);te(X),g(X)}catch{}localStorage.removeItem(q),L(!1)},Zt=()=>{localStorage.removeItem(q),L(!1)},Ue=m.useMemo(()=>/^[0-9]+$/.test(C),[C]),lt=m.useMemo(()=>Ue?f.sets[Number(C)-1]:null,[Ue,C,f.sets]),mt=m.useMemo(()=>{var d;return!Ue||v||!lt||!((d=M[lt.id])!=null&&d.undo.length)},[Ue,v,lt,M]),pt=m.useMemo(()=>{var d;return!Ue||v||!lt||!((d=M[lt.id])!=null&&d.redo.length)},[Ue,v,lt,M]);m.useEffect(()=>{mt?l(!1):localStorage.getItem("tutorial-undo")||l(!0)},[mt]),m.useEffect(()=>{pt?A(!1):localStorage.getItem("tutorial-redo")||A(!0)},[pt]),m.useEffect(()=>(V(e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[Ue&&e.jsxs(e.Fragment,{children:[e.jsx(Je,{open:H,onClose:()=>l(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${ge}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${ge}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsxs(ye,{variant:"body2",children:["各セットタブで独立し、ラリー結果の操作履歴を保持しています。",e.jsx("br",{}),e.jsx(It,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"を選択することで1つ前の操作を取り消すことができます。",e.jsx("br",{}),"操作履歴は試合画面を離れると消去されます。"]}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem("tutorial-undo","1"),l(!1)},children:"了解した"})})]}),children:e.jsx(ze,{onClick:ie,disabled:mt,color:"inherit",sx:{ml:1},children:e.jsx(It,{})})}),e.jsx(Je,{open:a,onClose:()=>A(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:Ge,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${ge}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${ge}`}}}},title:e.jsxs(n,{sx:{p:1,maxWidth:260},children:[e.jsxs(ye,{variant:"body2",children:[e.jsx(Bt,{fontSize:"inherit",sx:{verticalAlign:"middle",mr:.5}}),"を選択することで1つ前に取り消した操作を復活することができます。"]}),e.jsx(n,{sx:{textAlign:"right",mt:1},children:e.jsx(Xe,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem("tutorial-redo","1"),A(!1)},children:"了解した"})})]}),children:e.jsx(ze,{onClick:De,disabled:pt,color:"inherit",sx:{ml:1},children:e.jsx(Bt,{})})})]}),e.jsx(xe,{onClick:Yt,variant:"contained",disabled:!tt||v,startIcon:e.jsx(xs,{}),sx:{ml:1},children:"保存"})]})),()=>V(null)),[V,Ue,ie,De,Yt,tt,v,mt,pt,H,a,ge]),m.useEffect(()=>(E==null||E(tt),()=>E==null?void 0:E(!1)),[tt,E]);const Cs=[{key:"info",label:"試合概要",icon:e.jsx(zs,{})},{key:"team",label:"チーム",icon:e.jsx(rs,{})},{key:"members",label:"メンバー登録",icon:e.jsx(is,{})},{key:"sep1",divider:!0},{key:"stats",label:"スタッツ",icon:e.jsx(Fs,{})},{key:"sep2",divider:!0},{key:"setinfo",label:"セット情報",icon:e.jsx(ls,{})}].filter(d=>d.key!=="setinfo"),Ts=f.sets.map((d,B)=>{const z=S[B];return{key:`${B+1}`,icon:e.jsx(z,{}),label:`${d.my}-${d.opponent}`}}),Ss=!v&&f.sets.length<G?[{key:"add",label:"セット追加",icon:e.jsx(bt,{})}]:[],yt=d=>{d==="add"?fs():(ce(d),Y(`/matches/${s.id}/${d}`)),D||(ne(!1),Q(!1))},As=e.jsxs(Yn,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},sx:{flexGrow:1,overflowY:"auto",display:"flex",flexDirection:"column"},children:[C==="info"&&e.jsx(Gn,{match:f,setMatch:te,tags:ae,onAddTag:se,locked:v}),C==="members"&&e.jsx(Jn,{match:f,setMatch:te,teamAName:Fe(f.teamA)||"チームA",teamBName:Fe(f.teamB)||"チームB",teamMembers:T,onAddMember:Z,locked:v,showSnackbar:x}),C==="stats"&&e.jsx(Un,{sets:f.sets,playDetails:h,playCategories:c,statsSettings:r,matchStatsSettings:f.matchStatsSettings||[],onMatchStatsSettingsChange:d=>te(B=>({...B,matchStatsSettings:d})),rallyCategoryTags:$,rallyDetailTags:y,teamAName:Fe(f.teamA),teamBName:Fe(f.teamB),locked:v,showSnackbar:x}),C==="team"&&e.jsx(n,{sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Xn,{match:f,setMatch:te,teams:j,locked:v})}),de,C!=="info"&&C!=="members"&&C!=="stats"&&C!=="setinfo"&&C!=="team"&&e.jsx(On,{setScore:f.sets[Number(C)-1],playDetails:h,playCategories:c,teamAMembers:f.teamAMembers,teamBMembers:f.teamBMembers,teamAName:Fe(f.teamA),teamBName:Fe(f.teamB),locked:v,scoreInputSetting:R,themeSetting:P,onChange:d=>U(d.id,d),showSnackbar:x})]},C);return e.jsxs(n,{sx:{display:"flex",height:"100%"},children:[e.jsx(Ms,{variant:D?"permanent":"temporary",open:D?!0:O,onClose:()=>{ne(!1),Q(!1)},PaperProps:{onTransitionEnd:o},ModalProps:{keepMounted:!0,BackdropProps:{sx:{backgroundColor:"rgba(0, 0, 0, 0.5)"}}},sx:{width:D?O?be:je:be,flexShrink:0,transition:_.transitions.create("width",{easing:_.transitions.easing.sharp,duration:_.transitions.duration.standard}),...D?{zIndex:_.zIndex.appBar-1}:{},"& .MuiDrawer-paper":{width:D?O?be:je:be,boxSizing:"border-box",overflowX:"hidden",transition:_.transitions.create("width",{easing:_.transitions.easing.sharp,duration:_.transitions.duration.standard}),...D?{top:_.mixins.toolbar.minHeight,height:`calc(100% - ${_.mixins.toolbar.minHeight}px)`,zIndex:_.zIndex.appBar-1}:{}}},children:e.jsxs($s,{children:[Cs.map(d=>d.divider?e.jsx(ks,{component:"li"},d.key):e.jsxs(Ct,{selected:C===d.key,onClick:()=>yt(d.key),sx:{minHeight:48,justifyContent:O?"initial":"center",px:2.5},children:[e.jsx(Tt,{sx:{minWidth:0,mr:O?3:0,justifyContent:"center"},children:d.icon}),e.jsx(St,{primary:d.label??`セット${d.key}`,sx:{opacity:me?1:0,display:me?"block":"none",whiteSpace:"nowrap"}})]},d.key)),e.jsx(ht,{onDragEnd:Me,children:e.jsx(Ze,{droppableId:"drawer-sets",children:d=>e.jsxs(n,{ref:d.innerRef,...d.droppableProps,children:[Ts.map((B,z)=>e.jsx(et,{draggableId:f.sets[z].id,index:z,children:X=>e.jsxs(Ct,{ref:X.innerRef,...X.draggableProps,...X.dragHandleProps,style:X.draggableProps.style,selected:C===B.key,onClick:()=>yt(B.key),sx:{minHeight:48,justifyContent:O?"initial":"center",px:2.5},children:[e.jsx(Tt,{sx:{minWidth:0,mr:O?3:0,justifyContent:"center"},children:B.icon}),e.jsx(St,{primary:B.label??`セット${B.key}`,sx:{opacity:me?1:0,display:me?"block":"none",whiteSpace:"nowrap"}}),!v&&O&&e.jsx(ze,{edge:"end",onClick:ue=>{ue.stopPropagation(),js(z)},children:e.jsx(Re,{})})]})},f.sets[z].id)),d.placeholder]})})}),Ss.map(d=>e.jsxs(Ct,{selected:C===d.key,onClick:()=>yt(d.key),sx:{minHeight:48,justifyContent:O?"initial":"center",px:2.5},children:[e.jsx(Tt,{sx:{minWidth:0,mr:O?3:0,justifyContent:"center"},children:d.icon}),e.jsx(St,{primary:d.label??`セット${d.key}`,sx:{opacity:me?1:0,display:me?"block":"none",whiteSpace:"nowrap"}})]},d.key))]})}),e.jsxs(n,{sx:{flexGrow:1,display:"flex",flexDirection:"column",width:D?`calc(100% - ${O?be:je}px)`:"100%",transition:D?_.transitions.create("width",{duration:_.transitions.duration.standard}):void 0},children:[e.jsx(n,{sx:{flexGrow:1,position:"relative",overflowY:"hidden",display:"flex",width:"100%"},children:e.jsx(Hs,{mode:"wait",children:As})}),e.jsxs(At,{open:F,onClose:Xt,children:[e.jsx(qe,{children:"削除確認"}),e.jsx(Ne,{sx:{mt:2},children:"このセットを削除しますか？"}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:Xt,startIcon:e.jsx(Ye,{}),color:"inherit",children:"キャンセル"}),e.jsx(xe,{onClick:gs,color:"error",startIcon:e.jsx(Qe,{}),children:"OK"})]})]}),e.jsxs(At,{open:k,onClose:Zt,children:[e.jsx(qe,{children:"復元確認"}),e.jsx(Ne,{sx:{mt:2},children:"入力途中のデータが存在します。復元しますか？"}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:Zt,startIcon:e.jsx(Ye,{}),color:"inherit",children:"いいえ"}),e.jsx(xe,{onClick:vs,startIcon:e.jsx(Qe,{}),children:"はい"})]})]}),e.jsxs(At,{open:u,onClose:Qt,children:[e.jsx(qe,{children:"保存確認"}),e.jsx(Ne,{sx:{mt:2},children:"入力内容を保存しますか？"}),e.jsxs(Ke,{children:[e.jsx(xe,{onClick:Qt,startIcon:e.jsx(Ye,{}),color:"inherit",children:"キャンセル"}),e.jsx(xe,{onClick:bs,disabled:!tt||v,startIcon:e.jsx(Qe,{}),children:"OK"})]})]}),e.jsx(Rs,{open:W.open,message:W.message,severity:W.severity,onClose:ys,actionLabel:W.actionLabel,onAction:W.onAction,autoHideDuration:W.autoHideDuration})]})]})}export{di as default};
