import{i as ue,j as e,a as hs,B as t,m as A,f as We,H as us,Z as ps,I as he,s as dt,L as Ct,J as ze,K as Ne,N as ae,O as c,Q as Le,v as be,w as Ce,U as xe,x as ve,F as Te,z as Ee,S as _e,M as ee,d as xt,e as De,C as se,R as vt,a2 as ot,a3 as at,D as nt,a4 as gs,a5 as js,a6 as fs,a7 as ms,a8 as ys,A as bt}from"./mui-vendor-ZDpZWGIz.js";import{r,b as $t,u as bs,f as Cs,L as vs}from"./react-vendor-QLNaZ7XN.js";import{r as pe,u as Ke,c as Je,b as Be,S as Fe,e as Ae,g as Ue,h as je,D as Ve,f as ge,R as Ge,d as Ie,a as Se,i as te,j as Is,k as Ss,l as Dn,_ as ks}from"./index-Cn5cO1ka.js";import{a as Ds,d as ws}from"./QueryStatsOutlined-DAUBhuq5.js";import{D as Oe,C as fe,P as me,d as ye}from"./DragIndicator-DvNqw2ai.js";import{A as Ts,m as _s}from"./motion-vendor-dPyzewEM.js";import"./chart-vendor-CRzMDpO4.js";var Ut={},Os=ue;Object.defineProperty(Ut,"__esModule",{value:!0});var Pe=Ut.default=void 0,Rs=Os(pe()),Es=e;Pe=Ut.default=(0,Rs.default)((0,Es.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7"}),"VisibilityOutlined");var Vt={},Ps=ue;Object.defineProperty(Vt,"__esModule",{value:!0});var Me=Vt.default=void 0,Ms=Ps(pe()),As=e;Me=Vt.default=(0,Ms.default)((0,As.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6m-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14M2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45zm7.5 7.5 2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13m-3.4-3.4 1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53"}),"VisibilityOffOutlined");var Gt={},$s=ue;Object.defineProperty(Gt,"__esModule",{value:!0});var wn=Gt.default=void 0,Hs=$s(pe()),Ws=e;wn=Gt.default=(0,Hs.default)((0,Ws.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined");var Kt={},zs=ue;Object.defineProperty(Kt,"__esModule",{value:!0});var Tn=Kt.default=void 0,Ns=zs(pe()),Ls=e;Tn=Kt.default=(0,Ns.default)((0,Ls.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined");var qt={},Fs=ue;Object.defineProperty(qt,"__esModule",{value:!0});var _n=qt.default=void 0,Bs=Fs(pe()),Us=e;_n=qt.default=(0,Bs.default)((0,Us.jsx)("path",{d:"M4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29M20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24zm-7.76-2.78c-1.17-.52-2.61-.9-4.24-.9-1.63 0-3.07.39-4.24.9C6.68 14.13 6 15.21 6 16.39V18h12v-1.61c0-1.18-.68-2.26-1.76-2.74M8.07 16c.09-.23.13-.39.91-.69.97-.38 1.99-.56 3.02-.56s2.05.18 3.02.56c.77.3.81.46.91.69zM12 8c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0-2c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"GroupsOutlined");var Jt={},Vs=ue;Object.defineProperty(Jt,"__esModule",{value:!0});var On=Jt.default=void 0,Gs=Vs(pe()),Ks=e;On=Jt.default=(0,Gs.default)((0,Ks.jsx)("path",{d:"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonOutlined");var Yt={},qs=ue;Object.defineProperty(Yt,"__esModule",{value:!0});var Rn=Yt.default=void 0,Js=qs(pe()),Ys=e;Rn=Yt.default=(0,Js.default)((0,Ys.jsx)("path",{d:"M18 9h-2.5c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1H18c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1m-.5 4.5H16v-3h1.5zm-8 1.5H5v-2.5c0-.55.45-1 1-1h2v-1H5V9h3.5c.55 0 1 .45 1 1v1.5c0 .55-.45 1-1 1h-2v1h3zm3.25-4h-1.5V9.5h1.5zm0 3.5h-1.5V13h1.5zM22 6v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h3V2h2v2h6V2h2v2h3c1.1 0 2 .9 2 2m-2 12V6h-7.25v1.5h-1.5V6H4v12h7.25v-1.5h1.5V18z"}),"ScoreboardOutlined");var Xt={},Xs=ue;Object.defineProperty(Xt,"__esModule",{value:!0});var En=Xt.default=void 0,Zs=Xs(pe()),mn=e;En=Xt.default=(0,Zs.default)([(0,mn.jsx)("path",{d:"m21.41 11.41-8.83-8.83c-.37-.37-.88-.58-1.41-.58H4c-1.1 0-2 .9-2 2v7.17c0 .53.21 1.04.59 1.41l8.83 8.83c.78.78 2.05.78 2.83 0l7.17-7.17c.78-.78.78-2.04-.01-2.83M12.83 20 4 11.17V4h7.17L20 12.83z"},"0"),(0,mn.jsx)("circle",{cx:"6.5",cy:"6.5",r:"1.5"},"1")],"SellOutlined");var Zt={},Qs=ue;Object.defineProperty(Zt,"__esModule",{value:!0});var tt=Zt.default=void 0,el=Qs(pe()),ct=e;tt=Zt.default=(0,el.default)([(0,ct.jsx)("path",{d:"M12 22C6.49 22 2 17.51 2 12S6.49 2 12 2s10 4.04 10 9c0 3.31-2.69 6-6 6h-1.77c-.28 0-.5.22-.5.5 0 .12.05.23.13.33.41.47.64 1.06.64 1.67 0 1.38-1.12 2.5-2.5 2.5m0-18c-4.41 0-8 3.59-8 8s3.59 8 8 8c.28 0 .5-.22.5-.5 0-.16-.08-.28-.14-.35-.41-.46-.63-1.05-.63-1.65 0-1.38 1.12-2.5 2.5-2.5H16c2.21 0 4-1.79 4-4 0-3.86-3.59-7-8-7"},"0"),(0,ct.jsx)("circle",{cx:"6.5",cy:"11.5",r:"1.5"},"1"),(0,ct.jsx)("circle",{cx:"9.5",cy:"7.5",r:"1.5"},"2"),(0,ct.jsx)("circle",{cx:"14.5",cy:"7.5",r:"1.5"},"3"),(0,ct.jsx)("circle",{cx:"17.5",cy:"11.5",r:"1.5"},"4")],"PaletteOutlined");var Qt={},tl=ue;Object.defineProperty(Qt,"__esModule",{value:!0});var Pn=Qt.default=void 0,nl=tl(pe()),yn=e;Pn=Qt.default=(0,nl.default)([(0,yn.jsx)("path",{d:"M20 3H4c-1.11 0-2 .89-2 2v12c0 1.1.89 2 2 2h4v2h8v-2h4c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2m0 14H4V5h16z"},"0"),(0,yn.jsx)("path",{d:"M6 8.25h8v1.5H6zm10.5 1.5H18v-1.5h-1.5V7H15v4h1.5zm-6.5 2.5h8v1.5h-8zM7.5 15H9v-4H7.5v1.25H6v1.5h1.5z"},"1")],"DisplaySettingsOutlined");var en={},sl=ue;Object.defineProperty(en,"__esModule",{value:!0});var Mn=en.default=void 0,ll=sl(pe()),rl=e;Mn=en.default=(0,ll.default)((0,rl.jsx)("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"StorageOutlined");var tn={},il=ue;Object.defineProperty(tn,"__esModule",{value:!0});var An=tn.default=void 0,ol=il(pe()),al=e;An=tn.default=(0,ol.default)((0,al.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");function cl({teams:x,setTeams:h,setMembers:k,selectedTeam:b,setSelectedTeam:D,createTeam:L,showSnackbar:N}){const[V,F]=r.useState(!1),[$,K]=r.useState(""),[p,g]=r.useState(null),y=hs(),G=Ke("md"),{handleTouchEnd:X,setSwiperRef:J}=Je(),q="tutorial-team-swipe",[B,R]=r.useState(()=>G&&x.length>0&&!localStorage.getItem(q)),[H,le]=r.useState(()=>{var s;return((s=x[0])==null?void 0:s.id)||""}),Z=r.useRef(x.length),P=s=>{if(!s.destination)return;const a=Array.from(x),[d]=a.splice(s.source.index,1);a.splice(s.destination.index,0,d),h(a)},v=()=>{g(-1),K(""),F(!0)},S=s=>{g(s),K(x[s].name),F(!0)},O=()=>{if(p===-1){const s=L($);h(a=>[...a,s]),k(a=>({...a,[s.id]:[]})),b||D(s.id),G&&!localStorage.getItem(q)&&(le(s.id),R(!0))}else if(p!==null){const s=x[p].id;h(a=>a.map((d,M)=>M===p?{...d,name:$}:d)),b===s&&D(s)}F(!1)},z=()=>{F(!1)},T=s=>{var Y;const a=x[s];let d=[];k(Q=>{d=Q[a.id]||[];const ne={...Q};return delete ne[a.id],ne});const M=b,W=x.filter((Q,ne)=>ne!==s);h(W),b===a.id&&D(((Y=W[0])==null?void 0:Y.id)||""),N("チームを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{h(Q=>{const ne=[...Q];return ne.splice(s,0,a),ne}),k(Q=>({...Q,[a.id]:d})),D(M)},autoHideDuration:5e3})};return r.useEffect(()=>{G&&x.length>0&&Z.current===0&&!localStorage.getItem(q)&&(le(x[0].id),R(!0)),Z.current=x.length},[x,G]),e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(A,{onClick:v,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})}),e.jsx(Fe,{component:We,storageKey:"teams-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Oe,{onDragEnd:P,children:G?e.jsx(fe,{droppableId:"teams",children:s=>e.jsxs(t,{ref:s.innerRef,...s.droppableProps,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ae},children:[e.jsx(t,{sx:{width:32}}),e.jsx(t,{sx:{flexGrow:1},children:"チーム名"})]}),x.map((a,d)=>e.jsx(me,{draggableId:a.id,index:d,children:M=>e.jsx(t,{ref:M.innerRef,...M.draggableProps,style:M.draggableProps.style,children:e.jsx(us,{open:B&&H===a.id,onClose:()=>R(!1),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,arrow:!0,placement:"bottom",TransitionComponent:ps,slotProps:{tooltip:{sx:{backgroundColor:"#F5F5F9",color:"rgba(0, 0, 0, 0.87)",border:`1px solid ${y.palette.text.secondary}`,pointerEvents:"auto"}},arrow:{sx:{color:"#F5F5F9","&::before":{border:`1px solid ${y.palette.text.secondary}`}}}},title:e.jsxs(t,{sx:{p:1,maxWidth:260},children:[e.jsxs(dt,{variant:"body2",children:["左にスワイプすることで削除メニューが表示されます",e.jsx("br",{}),"他画面の一覧においても同様に削除することが可能です"]}),e.jsx(t,{sx:{textAlign:"right",mt:1},children:e.jsx(Ct,{component:"button",variant:"body2",onClick:()=>{localStorage.setItem(q,"1"),R(!1)},children:"了解した"})})]}),children:e.jsx(t,{children:e.jsxs(Ue,{onSwiper:W=>J(a.id,W),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(W,Y)=>Y.stopPropagation(),onTouchEnd:W=>X(a.id,W),children:[e.jsx(je,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>S(d),sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer"},children:[e.jsx(t,{...M.dragHandleProps,onClick:W=>W.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),e.jsx(t,{sx:{flexGrow:1},children:a.name})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>T(d),children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})})})},a.id)),s.placeholder]})}):e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:s=>s.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{}),e.jsx(c,{children:"チーム名"}),e.jsx(c,{})]})}),e.jsx(fe,{droppableId:"teams",children:s=>e.jsxs(Le,{ref:s.innerRef,...s.droppableProps,children:[x.map((a,d)=>e.jsx(me,{draggableId:a.id,index:d,children:M=>e.jsxs(ae,{ref:M.innerRef,...M.draggableProps,style:M.draggableProps.style,onClick:()=>S(d),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",onClick:W=>W.stopPropagation(),children:e.jsx(t,{onClick:W=>W.stopPropagation(),...M.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:a.name}),e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:W=>W.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:()=>T(d),sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:"error"})})})})]})},a.id)),s.placeholder]})})]})})})]}),e.jsxs(Ge,{open:V,onClose:z,children:[e.jsxs(be,{children:["チーム名",p===-1?"追加":"編集"]}),e.jsx(Ce,{sx:{mt:2},children:e.jsx(xe,{label:"チーム名",value:$,onChange:s=>K(s.target.value),fullWidth:!0,margin:"dense"})}),e.jsxs(ve,{children:[e.jsx(A,{onClick:z,startIcon:e.jsx(Ie,{}),color:"inherit",sx:{color:{xs:"black",md:"inherit"}},children:"キャンセル"}),e.jsx(A,{onClick:O,disabled:$.trim()==="",startIcon:e.jsx(Se,{}),children:"OK"})]})]})]})}const Ht=32,Wt=80,zt=200,Nt=200,Lt=64,dl=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function xl({teams:x,members:h,setMembers:k,selectedTeam:b,setSelectedTeam:D,showSnackbar:L}){const[N,V]=r.useState(null),[F,$]=r.useState(""),[K,p]=r.useState(""),[g,y]=r.useState([]),[G,X]=r.useState(!0),[J,q]=r.useState(!1),B=Ke("md"),R=Ke("sm"),H=Ht+zt+16+(R?0:Wt+Nt+Lt),{handleTouchEnd:le,setSwiperRef:Z}=Je(),P=s=>{if(!s.destination||!b)return;const a=Array.from(h[b]||[]),[d]=a.splice(s.source.index,1);a.splice(s.destination.index,0,d),k(M=>({...M,[b]:a}))},v=()=>{V(-1),$(""),p(""),y([]),X(!0),q(!0)},S=s=>{V(s);const a=h[b][s];$(String(a.no)),p(a.name),y(a.positions||[]),X(a.visible!==!1),q(!0)},O=()=>{b&&(N===-1?k(s=>({...s,[b]:[...s[b]||[],{id:dl(),no:Number(F),name:K,positions:g,visible:G}]})):N!==null&&k(s=>({...s,[b]:s[b].map((a,d)=>d===N?{...a,no:Number(F),name:K,positions:g,visible:G}:a)})),q(!1))},z=()=>{q(!1)},T=s=>{if(!b)return;let a;k(d=>{const M=[...d[b]||[]];a=M[s];const W=M.filter((Y,Q)=>Q!==s);return{...d,[b]:W}}),L("メンバーを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{a&&k(d=>{const M=[...d[b]||[]];return M.splice(s,0,a),{...d,[b]:M}})},autoHideDuration:5e3})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"team-select-label",children:"チーム"}),e.jsx(_e,{labelId:"team-select-label",value:b,label:"チーム",onChange:s=>D(s.target.value),children:x.map(s=>e.jsx(ee,{value:s.id,children:s.name},s.id))})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mt:2,mb:1},children:e.jsx(A,{onClick:v,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})}),e.jsx(Fe,{component:We,storageKey:"members-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Oe,{onDragEnd:P,children:B?e.jsx(fe,{droppableId:"members",children:s=>{var a;return e.jsxs(t,{ref:s.innerRef,...s.droppableProps,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",width:"100%",minWidth:H,...Ae},children:[e.jsx(t,{sx:{width:Ht}}),!R&&e.jsx(t,{sx:{width:Wt,textAlign:"center"},children:"番号"}),e.jsx(t,{sx:{width:zt,flexShrink:0},children:"名前"}),!R&&e.jsx(t,{sx:{width:Nt},children:"ポジション"}),!R&&e.jsx(t,{sx:{width:Lt,textAlign:"center"},children:"表示"})]}),(a=h[b])==null?void 0:a.map((d,M)=>e.jsx(me,{draggableId:d.id,index:M,children:W=>e.jsx(t,{ref:W.innerRef,...W.draggableProps,style:W.draggableProps.style,children:e.jsxs(Ue,{onSwiper:Y=>Z(d.id,Y),threshold:20,slidesPerView:"auto",style:{overflow:"hidden",width:"100%",minWidth:H},onTouchStart:(Y,Q)=>Q.stopPropagation(),onTouchEnd:Y=>le(d.id,Y),children:[e.jsx(je,{style:{width:"100%",minWidth:H,flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>S(M),sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer",width:"100%",minWidth:H},children:[e.jsx(t,{...W.dragHandleProps,onClick:Y=>Y.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:Ht,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),!R&&e.jsx(t,{sx:{width:Wt,textAlign:"center"},children:d.no}),e.jsx(t,{sx:{width:zt,flexShrink:0,whiteSpace:"nowrap",overflow:"hidden"},children:d.name}),!R&&e.jsx(t,{sx:{width:Nt,whiteSpace:"nowrap",overflow:"hidden"},children:(d.positions||[]).join(", ")}),!R&&e.jsx(t,{sx:{width:Lt,display:"flex",justifyContent:"center"},children:d.visible===!1?e.jsx(Me,{}):e.jsx(Pe,{})})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>T(M),children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},d.id)),s.placeholder]})}}):e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:s=>s.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{}),e.jsx(c,{children:"番号"}),e.jsx(c,{children:"名前"}),!R&&e.jsx(c,{children:"ポジション"}),e.jsx(c,{children:"表示"}),e.jsx(c,{})]})}),e.jsx(fe,{droppableId:"members",children:s=>{var a;return e.jsxs(Le,{ref:s.innerRef,...s.droppableProps,children:[(a=h[b])==null?void 0:a.map((d,M)=>e.jsx(me,{draggableId:d.id,index:M,children:W=>e.jsxs(ae,{ref:W.innerRef,...W.draggableProps,"data-index":M,onClick:()=>S(M),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:Y=>Y.stopPropagation(),...W.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:d.no}),e.jsx(c,{children:d.name}),!R&&e.jsx(c,{children:(d.positions||[]).join(", ")}),e.jsx(c,{children:d.visible===!1?e.jsx(Me,{}):e.jsx(Pe,{})}),e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:Y=>Y.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:()=>T(M),sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:"error"})})})})]})},d.id)),s.placeholder]})}})]})})})]}),e.jsxs(Ge,{open:J,onClose:z,children:[e.jsxs(be,{children:["メンバー",N===-1?"追加":"編集"]}),e.jsxs(Ce,{children:[e.jsx(xe,{label:"番号",type:"number",value:F,onChange:s=>$(s.target.value),fullWidth:!0,margin:"dense"}),e.jsx(xe,{label:"名前",value:K,onChange:s=>p(s.target.value),fullWidth:!0,margin:"dense"}),e.jsxs(Te,{margin:"dense",fullWidth:!0,children:[e.jsx(Ee,{id:"positions-label",children:"ポジション"}),e.jsxs(_e,{labelId:"positions-label",multiple:!0,value:g,label:"ポジション",onChange:s=>y(typeof s.target.value=="string"?s.target.value.split(","):s.target.value),renderValue:s=>s.join(", "),children:[e.jsx(ee,{value:"レフト",children:"レフト"}),e.jsx(ee,{value:"センター",children:"センター"}),e.jsx(ee,{value:"ライト",children:"ライト"}),e.jsx(ee,{value:"セッター",children:"セッター"}),e.jsx(ee,{value:"リベロ",children:"リベロ"})]})]}),e.jsxs(xt,{value:G?"visible":"hidden",exclusive:!0,onChange:(s,a)=>a&&X(a==="visible"),fullWidth:!0,sx:{display:"flex",mt:1},children:[e.jsxs(De,{value:"visible",sx:{flex:1,whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(Pe,{sx:{mr:1}}),"表示"]}),e.jsxs(De,{value:"hidden",sx:{flex:1,whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(Me,{sx:{mr:1}}),"非表示"]})]})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:z,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:O,disabled:F==="",startIcon:e.jsx(Se,{}),children:"OK"})]})]})]})}const bn=!1;function hl({openAddPlayDialog:x,playCategories:h,setPlayCategories:k,openEditPlayDialog:b,scoreInput:D,renderIcon:L,rallyCategoryTags:N,handlePlayDelete:V,openAddDetailDialog:F,playDetails:$,setPlayDetails:K,openEditDetailDialog:p,theme:g,rallyDetailTags:y,handleDetailDelete:G}){const X=P=>{if(!P.destination)return;const v=Array.from(h),[S]=v.splice(P.source.index,1);v.splice(P.destination.index,0,S),k(v)},J=$t.useMemo(()=>{const P={};return h.forEach(v=>{P[v.id]=[]}),$.forEach((v,S)=>{(P[v.playCategoryId]||(P[v.playCategoryId]=[])).push(S)}),P},[h,$]),q=P=>{const{source:v,destination:S}=P;if(!S||v.droppableId!==S.droppableId)return;const O=v.droppableId,z=O==="play-details"?Object.values(J).flat():J[O.replace("play-details-","")];if(!z)return;const T=z[v.index],s=z[S.index],a=Array.from($),[d]=a.splice(T,1);a.splice(s,0,d),K(a)},B=Ke("md"),R=Ke("sm"),{handleTouchEnd:H,setSwiperRef:le}=Je();let Z=0;return e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(A,{onClick:x,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})}),e.jsx(Fe,{component:We,storageKey:"play-category-grid",sx:{maxWidth:1024,mx:"auto"},children:B?e.jsx(Oe,{onDragEnd:X,children:e.jsx(fe,{droppableId:"play-categories",children:P=>e.jsxs(t,{ref:P.innerRef,...P.droppableProps,children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:R?"32px 1fr":"32px 1fr 1fr 64px",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ae},children:[e.jsx(t,{sx:{width:32}}),e.jsx(t,{children:"プレー区分"}),!R&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"ラリー区分タグ"}),e.jsx(t,{children:"表示"})]})]}),h.map((v,S)=>e.jsx(me,{draggableId:v.id,index:S,children:O=>e.jsx(t,{ref:O.innerRef,...O.draggableProps,style:O.draggableProps.style,children:e.jsxs(Ue,{onSwiper:z=>le(v.id,z),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(z,T)=>T.stopPropagation(),onTouchEnd:z=>H(v.id,z),children:[e.jsx(je,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>b(S),sx:{display:"grid",gridTemplateColumns:R?"32px 1fr":"32px 1fr 1fr 64px",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer"},children:[e.jsx(t,{...O.dragHandleProps,onClick:z=>z.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(se,{label:v.name,size:"small",variant:"outlined",sx:{backgroundColor:"transparent",borderColor:v.color,color:v.color}}),D.showRallyIcons&&e.jsx(t,{children:L(v)})]}),!R&&e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:(v.tags||[]).map(z=>{const T=N.find(a=>a.id===z),s=(T==null?void 0:T.color)||te;return e.jsx(se,{label:(T==null?void 0:T.name)||z,size:"small",sx:{backgroundColor:s,color:"#fff"}},z)})}),!R&&e.jsx(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:v.visible===!1?e.jsx(Me,{}):e.jsx(Pe,{})})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>V(S),disabled:v.id==="init-serve",children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},v.id)),P.placeholder]})})}):e.jsxs(ze,{size:"small",sx:{minWidth:600},children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:P=>P.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{sx:{width:48}}),e.jsx(c,{children:"プレー区分"}),bn,D.showRallyIcons&&e.jsx(c,{children:"アイコン"}),e.jsx(c,{children:"タグ"}),e.jsx(c,{children:"表示"}),e.jsx(c,{})]})}),e.jsx(Oe,{onDragEnd:X,children:e.jsx(fe,{droppableId:"play-categories",children:P=>e.jsxs(Le,{ref:P.innerRef,...P.droppableProps,children:[h.map((v,S)=>e.jsx(me,{draggableId:v.id,index:S,children:O=>e.jsxs(ae,{ref:O.innerRef,...O.draggableProps,"data-index":S,onClick:()=>b(S),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",sx:{width:48},children:e.jsx(t,{onClick:z=>z.stopPropagation(),...O.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:e.jsx(se,{label:v.name,size:"small",variant:"outlined",sx:{backgroundColor:"transparent",borderColor:v.color,color:v.color}})}),bn,D.showRallyIcons&&e.jsx(c,{children:L(v)}),e.jsx(c,{children:(v.tags||[]).map(z=>{const T=N.find(a=>a.id===z),s=(T==null?void 0:T.color)||te;return e.jsx(se,{label:(T==null?void 0:T.name)||z,size:"small",sx:{mr:.5,mb:.5,backgroundColor:s,color:"#fff"}},z)})}),e.jsx(c,{children:v.visible===!1?e.jsx(Me,{}):e.jsx(Pe,{})}),e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:z=>z.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:v.id==="init-serve"?void 0:()=>V(S),disabled:v.id==="init-serve",sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:v.id==="init-serve"?"disabled":"error"})})})})]})},v.id)),P.placeholder]})})})]})}),e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1,mt:2},children:e.jsx(A,{onClick:F,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})}),e.jsx(Fe,{component:We,storageKey:"play-detail-grid",sx:{maxWidth:1024,mx:"auto"},children:B?e.jsx(Oe,{onDragEnd:q,children:e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:R?"32px 1fr":"32px 1fr 1fr 1fr 1fr 64px",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ae},children:[e.jsx(t,{sx:{width:32}}),e.jsx(t,{children:"プレー詳細"}),!R&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:"得点区分"}),e.jsx(t,{children:"得失点単位区分"}),e.jsx(t,{children:"タグ"}),e.jsx(t,{children:"表示"})]})]}),h.map(P=>{const v=$.map((S,O)=>({d:S,i:O})).filter(({d:S})=>S.playCategoryId===P.id);return e.jsxs($t.Fragment,{children:[e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",px:1,borderBottom:1,borderColor:"divider",...Ae},children:P.name}),e.jsx(fe,{droppableId:`play-details-${P.id}`,children:S=>e.jsxs(t,{ref:S.innerRef,...S.droppableProps,children:[v.map(({d:O,i:z},T)=>e.jsx(me,{draggableId:O.id,index:T,children:s=>e.jsx(t,{ref:s.innerRef,...s.draggableProps,style:s.draggableProps.style,children:e.jsxs(Ue,{onSwiper:a=>le(O.id,a),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(a,d)=>d.stopPropagation(),onTouchEnd:a=>H(O.id,a),children:[e.jsx(je,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>p(z),sx:{display:"grid",gridTemplateColumns:R?"32px 1fr":"32px 1fr 1fr 1fr 1fr 64px",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer"},children:[e.jsx(t,{...s.dragHandleProps,onClick:a=>a.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),e.jsx(t,{children:e.jsx(se,{label:O.name,size:"small",sx:{backgroundColor:O.pointType==="得点"?g.scoreColor:g.lossColor,border:`1px solid ${O.pointType==="得点"?g.scoreColor:g.lossColor}`,color:"#fff"}})}),!R&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:O.pointType}),e.jsx(t,{children:O.pointUnitType}),e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:(O.tags||[]).map(a=>{const d=y.find(W=>W.id===a),M=(d==null?void 0:d.color)||te;return e.jsx(se,{label:(d==null?void 0:d.name)||a,size:"small",sx:{backgroundColor:M,color:"#fff"}},a)})}),e.jsx(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:O.visible===!1?e.jsx(Me,{}):e.jsx(Pe,{})})]})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>G(z),children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},O.id)),S.placeholder]})})]},P.id)})]})}):e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:P=>P.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{}),e.jsx(c,{children:"プレー詳細"}),e.jsx(c,{children:"得点区分"}),e.jsx(c,{children:"得失点単位区分"}),e.jsx(c,{children:"タグ"}),e.jsx(c,{children:"表示"}),e.jsx(c,{})]})}),e.jsx(Oe,{onDragEnd:q,children:e.jsx(fe,{droppableId:"play-details",children:P=>e.jsxs(Le,{ref:P.innerRef,...P.droppableProps,children:[h.map(v=>e.jsxs($t.Fragment,{children:[e.jsx(ae,{sx:{backgroundColor:S=>S.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:e.jsx(c,{colSpan:7,children:v.name})}),$.map((S,O)=>({d:S,i:O})).filter(({d:S})=>S.playCategoryId===v.id).map(({d:S,i:O})=>{const z=Z++;return e.jsx(me,{draggableId:S.id,index:z,children:T=>e.jsxs(ae,{ref:T.innerRef,...T.draggableProps,"data-index":O,onClick:()=>p(O),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:s=>s.stopPropagation(),...T.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:e.jsx(se,{label:S.name,size:"small",sx:{backgroundColor:S.pointType==="得点"?g.scoreColor:g.lossColor,border:`1px solid ${S.pointType==="得点"?g.scoreColor:g.lossColor}`,color:"#fff"}})}),e.jsx(c,{children:S.pointType}),e.jsx(c,{children:S.pointUnitType}),e.jsx(c,{children:(S.tags||[]).map(s=>{const a=y.find(M=>M.id===s),d=(a==null?void 0:a.color)||te;return e.jsx(se,{label:(a==null?void 0:a.name)||s,size:"small",sx:{mr:.5,mb:.5,backgroundColor:d,color:"#fff"}},s)})}),e.jsx(c,{children:S.visible===!1?e.jsx(Me,{}):e.jsx(Pe,{})}),e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:s=>s.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:()=>G(O),sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:"error"})})})})]})},S.id)})]},v.id)),P.placeholder]})})})]})})]})}const Cn=!1,vn=!1,In=!1;function ul({tags:x,setTags:h,rallyCategoryTags:k,setRallyCategoryTags:b,rallyDetailTags:D,setRallyDetailTags:L,setMatches:N,setPlayCategories:V,setPlayDetails:F,showSnackbar:$}){const[K,p]=r.useState(null),[g,y]=r.useState(""),[G,X]=r.useState(te),[J,q]=r.useState(!1),[B,R]=r.useState(null),[H,le]=r.useState(""),[Z,P]=r.useState(te),[v,S]=r.useState(!1),[O,z]=r.useState(null),[T,s]=r.useState(""),[a,d]=r.useState(te),[M,W]=r.useState(!1),Y=Ke("md"),Q=Je(),ne=Je(),ce=Je(),ie=o=>{if(!o.destination)return;const u=Array.from(x),[_]=u.splice(o.source.index,1);u.splice(o.destination.index,0,_),h(u)},n=o=>{if(!o.destination)return;const u=Array.from(k),[_]=u.splice(o.source.index,1);u.splice(o.destination.index,0,_),b(u)},l=o=>{if(!o.destination)return;const u=Array.from(D),[_]=u.splice(o.source.index,1);u.splice(o.destination.index,0,_),L(u)},m=()=>{p(-1),y(""),X(te),q(!0)},w=o=>{p(o),y(x[o].name),X(x[o].color),q(!0)},f=()=>{K===-1?h(o=>[...o,{id:crypto.randomUUID(),name:g,color:G}]):K!==null&&h(o=>o.map((u,_)=>_===K?{...u,name:g,color:G}:u)),q(!1)},I=()=>{q(!1)},re=o=>{const u=x[o];let _=[];h(E=>E.filter((j,de)=>de!==o)),N(E=>(_=E.map(j=>({...j,tags:[...j.tags]})),E.map(j=>({...j,tags:j.tags.filter(de=>de!==u.id)})))),$("試合タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{h(E=>{const j=[...E];return j.splice(o,0,u),j}),N(()=>_)},autoHideDuration:5e3})},we=()=>{R(-1),le(""),P(te),S(!0)},Re=o=>{R(o),le(k[o].name),P(k[o].color),S(!0)},st=()=>{B===-1?b(o=>[...o,{id:crypto.randomUUID(),name:H,color:Z}]):B!==null&&b(o=>o.map((u,_)=>_===B?{...u,name:H,color:Z}:u)),S(!1)},Ye=()=>{S(!1)},ht=o=>{const u=k[o];let _=[];b(E=>E.filter((j,de)=>de!==o)),V(E=>(_=E.map(j=>({...j,tags:[...j.tags||[]]})),E.map(j=>({...j,tags:(j.tags||[]).filter(de=>de!==u.id)})))),$("プレー区分タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{b(E=>{const j=[...E];return j.splice(o,0,u),j}),V(()=>_)},autoHideDuration:5e3})},Xe=()=>{z(-1),s(""),d(te),W(!0)},Ze=o=>{z(o),s(D[o].name),d(D[o].color),W(!0)},ut=()=>{O===-1?L(o=>[...o,{id:crypto.randomUUID(),name:T,color:a}]):O!==null&&L(o=>o.map((u,_)=>_===O?{...u,name:T,color:a}:u)),W(!1)},pt=()=>{W(!1)},Qe=o=>{const u=D[o];let _=[];L(E=>E.filter((j,de)=>de!==o)),F(E=>(_=E.map(j=>({...j,tags:[...j.tags||[]]})),E.map(j=>({...j,tags:(j.tags||[]).filter(de=>de!==u.id)})))),$("プレー詳細タグを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{L(E=>{const j=[...E];return j.splice(o,0,u),j}),F(()=>_)},autoHideDuration:5e3})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"試合タグ"}),e.jsx(A,{onClick:m,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})]}),e.jsx(Fe,{component:We,storageKey:"match-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Oe,{onDragEnd:ie,children:Y?e.jsx(fe,{droppableId:"match-tags",children:o=>e.jsxs(t,{ref:o.innerRef,...o.droppableProps,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ae},children:[e.jsx(t,{sx:{width:32}}),e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})]}),x.map((u,_)=>e.jsx(me,{draggableId:u.id,index:_,children:E=>e.jsx(t,{ref:E.innerRef,...E.draggableProps,style:E.draggableProps.style,children:e.jsxs(Ue,{onSwiper:j=>Q.setSwiperRef(u.id,j),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(j,de)=>de.stopPropagation(),onTouchEnd:j=>Q.handleTouchEnd(u.id,j),children:[e.jsx(je,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>w(_),sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer"},children:[e.jsx(t,{...E.dragHandleProps,onClick:j=>j.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),e.jsx(t,{sx:{flexGrow:1},children:e.jsx(se,{label:u.name,size:"small",sx:{backgroundColor:u.color,border:`1px solid ${u.color}`,color:"#fff"}})})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>re(_),children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},u.id)),o.placeholder]})}):e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:o=>o.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{}),e.jsx(c,{children:"タグ名称"}),Cn,e.jsx(c,{})]})}),e.jsx(fe,{droppableId:"match-tags",children:o=>e.jsxs(Le,{ref:o.innerRef,...o.droppableProps,children:[x.map((u,_)=>e.jsx(me,{draggableId:u.id,index:_,children:E=>e.jsxs(ae,{ref:E.innerRef,...E.draggableProps,"data-index":_,onClick:()=>w(_),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:j=>j.stopPropagation(),...E.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:e.jsx(se,{label:u.name,size:"small",sx:{backgroundColor:u.color,border:`1px solid ${u.color}`,color:"#fff"}})}),Cn,e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:j=>j.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:()=>re(_),sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:"error"})})})})]})},u.id)),o.placeholder]})})]})})}),e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,mt:2},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"プレー区分タグ"}),e.jsx(A,{onClick:we,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})]}),e.jsx(Fe,{component:We,storageKey:"play-category-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Oe,{onDragEnd:n,children:Y?e.jsx(fe,{droppableId:"rally-category-tags",children:o=>e.jsxs(t,{ref:o.innerRef,...o.droppableProps,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ae},children:[e.jsx(t,{sx:{width:32}}),e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})]}),k.map((u,_)=>e.jsx(me,{draggableId:u.id,index:_,children:E=>e.jsx(t,{ref:E.innerRef,...E.draggableProps,style:E.draggableProps.style,children:e.jsxs(Ue,{onSwiper:j=>ne.setSwiperRef(u.id,j),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(j,de)=>de.stopPropagation(),onTouchEnd:j=>ne.handleTouchEnd(u.id,j),children:[e.jsx(je,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>Re(_),sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer"},children:[e.jsx(t,{...E.dragHandleProps,onClick:j=>j.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),e.jsx(t,{sx:{flexGrow:1},children:e.jsx(se,{label:u.name,size:"small",sx:{backgroundColor:u.color,border:`1px solid ${u.color}`,color:"#fff"}})})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>ht(_),children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},u.id)),o.placeholder]})}):e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:o=>o.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{}),e.jsx(c,{children:"タグ名称"}),vn,e.jsx(c,{})]})}),e.jsx(fe,{droppableId:"rally-category-tags",children:o=>e.jsxs(Le,{ref:o.innerRef,...o.droppableProps,children:[k.map((u,_)=>e.jsx(me,{draggableId:u.id,index:_,children:E=>e.jsxs(ae,{ref:E.innerRef,...E.draggableProps,"data-index":_,onClick:()=>Re(_),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:j=>j.stopPropagation(),...E.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:e.jsx(se,{label:u.name,size:"small",sx:{backgroundColor:u.color,border:`1px solid ${u.color}`,color:"#fff"}})}),vn,e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:j=>j.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:()=>ht(_),sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:"error"})})})})]})},u.id)),o.placeholder]})})]})})}),e.jsxs(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,mt:2},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"プレー詳細タグ"}),e.jsx(A,{onClick:Xe,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})]}),e.jsx(Fe,{component:We,storageKey:"play-detail-tag-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsx(Oe,{onDragEnd:l,children:Y?e.jsx(fe,{droppableId:"rally-detail-tags",children:o=>e.jsxs(t,{ref:o.innerRef,...o.droppableProps,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ae},children:[e.jsx(t,{sx:{width:32}}),e.jsx(t,{sx:{flexGrow:1},children:"タグ名称"})]}),D.map((u,_)=>e.jsx(me,{draggableId:u.id,index:_,children:E=>e.jsx(t,{ref:E.innerRef,...E.draggableProps,style:E.draggableProps.style,children:e.jsxs(Ue,{onSwiper:j=>ce.setSwiperRef(u.id,j),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(j,de)=>de.stopPropagation(),onTouchEnd:j=>ce.handleTouchEnd(u.id,j),children:[e.jsx(je,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>Ze(_),sx:{display:"flex",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer"},children:[e.jsx(t,{...E.dragHandleProps,onClick:j=>j.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),e.jsx(t,{sx:{flexGrow:1},children:e.jsx(se,{label:u.name,size:"small",sx:{backgroundColor:u.color,border:`1px solid ${u.color}`,color:"#fff"}})})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>Qe(_),children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},u.id)),o.placeholder]})}):e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:o=>o.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{}),e.jsx(c,{children:"タグ名称"}),In,e.jsx(c,{})]})}),e.jsx(fe,{droppableId:"rally-detail-tags",children:o=>e.jsxs(Le,{ref:o.innerRef,...o.droppableProps,children:[D.map((u,_)=>e.jsx(me,{draggableId:u.id,index:_,children:E=>e.jsxs(ae,{ref:E.innerRef,...E.draggableProps,"data-index":_,onClick:()=>Ze(_),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:j=>j.stopPropagation(),...E.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:e.jsx(se,{label:u.name,size:"small",sx:{backgroundColor:u.color,border:`1px solid ${u.color}`,color:"#fff"}})}),In,e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:j=>j.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:()=>Qe(_),sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:"error"})})})})]})},u.id)),o.placeholder]})})]})})})]}),e.jsxs(Ge,{open:J,onClose:I,children:[e.jsxs(be,{children:["タグ",K===-1?"追加":"編集"]}),e.jsxs(Ce,{sx:{mt:2},children:[e.jsx(xe,{label:"タグ名称",value:g,onChange:o=>y(o.target.value),fullWidth:!0,margin:"dense"}),e.jsx(xe,{label:"色",type:"color",value:G,onChange:o=>X(o.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:I,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:f,disabled:g.trim()==="",startIcon:e.jsx(Se,{}),children:"OK"})]})]}),e.jsxs(Ge,{open:v,onClose:Ye,children:[e.jsxs(be,{children:["タグ",B===-1?"追加":"編集"]}),e.jsxs(Ce,{sx:{mt:2},children:[e.jsx(xe,{label:"タグ名称",value:H,onChange:o=>le(o.target.value),fullWidth:!0,margin:"dense"}),e.jsx(xe,{label:"色",type:"color",value:Z,onChange:o=>P(o.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:Ye,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:st,disabled:H.trim()==="",startIcon:e.jsx(Se,{}),children:"OK"})]})]}),e.jsxs(Ge,{open:M,onClose:pt,children:[e.jsxs(be,{children:["タグ",O===-1?"追加":"編集"]}),e.jsxs(Ce,{sx:{mt:2},children:[e.jsx(xe,{label:"タグ名称",value:T,onChange:o=>s(o.target.value),fullWidth:!0,margin:"dense"}),e.jsx(xe,{label:"色",type:"color",value:a,onChange:o=>d(o.target.value),fullWidth:!0,margin:"dense",InputLabelProps:{shrink:!0},sx:{mt:2}})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:pt,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:ut,disabled:T.trim()==="",startIcon:e.jsx(Se,{}),children:"OK"})]})]})]})}const pl=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function gl({statsSettings:x,setStatsSettings:h,playCategories:k,playDetails:b,rallyCategoryTags:D,rallyDetailTags:L,showSnackbar:N}){const[V,F]=r.useState(null),[$,K]=r.useState(""),[p,g]=r.useState(""),[y,G]=r.useState([]),[X,J]=r.useState([]),[q,B]=r.useState(""),[R,H]=r.useState(""),[le,Z]=r.useState("合算"),[P,v]=r.useState(!1),S=Ke("md"),O=Ke("sm"),{handleTouchEnd:z,setSwiperRef:T}=Je(),s=n=>{if(!n.destination)return;const l=Array.from(x),[m]=l.splice(n.source.index,1);l.splice(n.destination.index,0,m),h(l)},a=n=>{var l;return((l=k.find(m=>m.id===n))==null?void 0:l.name)||""},d=n=>{var l;return((l=b.find(m=>m.id===n))==null?void 0:l.name)||""},M=n=>{const l=n.playCategoryId?a(n.playCategoryId):n.playCategoryTags?n.playCategoryTags.map(re=>{var we;return((we=D.find(Re=>Re.id===re))==null?void 0:we.name)||re}).join(", "):"",m=n.playDetailId?d(n.playDetailId):n.playDetailTags?n.playDetailTags.map(re=>{var we;return((we=L.find(Re=>Re.id===re))==null?void 0:we.name)||re}).join(", "):"",w=n.pointType||"",f=n.pointUnitType||"",I=n.aggregateType||"合算";return[l,m,w,f,I].filter(re=>re).join(", ")},W=()=>{F(-1),K(""),g(""),G([]),J([]),B(""),H(""),Z("合算"),v(!0)},Y=n=>{const l=x[n];F(n),K(l.playCategoryId||""),g(l.playDetailId||""),G(l.playCategoryTags||[]),J(l.playDetailTags||[]),B(l.pointType||""),H(l.pointUnitType||""),Z(l.aggregateType||"合算"),v(!0)},Q=()=>{const n=$!=="",l=p!=="",m=y.length>0,w=X.length>0,f=q!=="",I=R!=="";return n&&!l&&!m&&!w&&!f&&!I||n&&l&&!m&&!w&&!f&&!I||n&&!l&&!m&&!w&&f&&!I||n&&!l&&!m&&!w&&!f&&I||n&&!l&&!m&&!w&&f&&I||!n&&!l&&!m&&!w&&f&&!I||!n&&!l&&!m&&!w&&f&&I||!n&&!l&&!m&&!w&&!f&&I||m&&!n&&!l&&!w&&!f&&!I||m&&w&&!n&&!l&&!f&&!I||m&&w&&!n&&!l&&f&&!I||m&&w&&!n&&!l&&!f&&I||m&&w&&!n&&!l&&f&&I||m&&!n&&!l&&f&&!I||m&&!n&&!l&&!f&&I||m&&!n&&!l&&f&&I||w&&!n&&!l&&!m&&!f&&!I||w&&!n&&!l&&!m&&f&&!I||w&&!n&&!l&&!m&&!f&&I||w&&!n&&!l&&!m&&f&&I},ne=()=>{const n={id:V===-1?pl():x[V].id,playCategoryId:$||void 0,playDetailId:p||void 0,playCategoryTags:$===""&&y.length>0?y:void 0,playDetailTags:p===""&&X.length>0?X:void 0,pointType:p?void 0:q||void 0,pointUnitType:p?void 0:R||void 0,aggregateType:le};V===-1?h(l=>[...l,n]):V!==null&&h(l=>l.map((m,w)=>w===V?n:m)),v(!1)},ce=()=>{v(!1)},ie=n=>{const l=x[n];h(m=>m.filter((w,f)=>f!==n)),N("スタッツを削除しました","success",{actionLabel:"元に戻す",onAction:()=>{h(m=>{const w=[...m];return w.splice(n,0,l),w})},autoHideDuration:5e3})};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(A,{onClick:W,variant:"contained",startIcon:e.jsx(Be,{}),children:"追加"})}),e.jsx(Fe,{component:We,storageKey:"stats-grid",sx:{maxWidth:1024,mx:"auto"},children:S?e.jsx(Oe,{onDragEnd:s,children:e.jsx(fe,{droppableId:"stats-settings",children:n=>e.jsxs(t,{ref:n.innerRef,...n.droppableProps,children:[e.jsx(t,{sx:{display:"grid",gridTemplateColumns:O?"48px 1fr":"48px repeat(5, 1fr)",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",...Ae},children:O?e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{width:48}}),e.jsx(t,{children:"スタッツ"})]}):e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{width:48}}),e.jsx(t,{children:"プレー区分"}),e.jsx(t,{children:"プレー詳細"}),e.jsx(t,{children:"得点区分"}),e.jsx(t,{children:"得失点単位区分"}),e.jsx(t,{children:"集計方法"})]})}),x.map((l,m)=>e.jsx(me,{draggableId:l.id,index:m,children:w=>e.jsx(t,{ref:w.innerRef,...w.draggableProps,style:w.draggableProps.style,children:e.jsxs(Ue,{onSwiper:f=>T(l.id,f),threshold:20,slidesPerView:"auto",style:{overflow:"hidden"},onTouchStart:(f,I)=>I.stopPropagation(),onTouchEnd:f=>z(l.id,f),children:[e.jsx(je,{style:{width:"100%",flex:"0 0 auto"},children:e.jsxs(t,{onClick:()=>Y(m),sx:{display:"grid",gridTemplateColumns:O?"48px 1fr":"48px repeat(5, 1fr)",alignItems:"center",height:50,px:1,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",cursor:"pointer"},children:[e.jsx(t,{...w.dragHandleProps,onClick:f=>f.stopPropagation(),sx:{cursor:"grab",display:"flex",touchAction:"none",width:48,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})}),O?e.jsx(t,{children:M(l)}):e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{pr:1},children:l.playCategoryId?a(l.playCategoryId):l.playCategoryTags&&l.playCategoryTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:l.playCategoryTags.map(f=>{const I=D.find(re=>re.id===f);return e.jsx(se,{label:(I==null?void 0:I.name)||f,size:"small",sx:{backgroundColor:(I==null?void 0:I.color)||te,color:"#fff"}},f)})}):""}),e.jsx(t,{sx:{pr:1},children:l.playDetailId?d(l.playDetailId):l.playDetailTags&&l.playDetailTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:l.playDetailTags.map(f=>{const I=L.find(re=>re.id===f);return e.jsx(se,{label:(I==null?void 0:I.name)||f,size:"small",sx:{backgroundColor:(I==null?void 0:I.color)||te,color:"#fff"}},f)})}):""}),e.jsx(t,{sx:{pr:1},children:l.pointType||""}),e.jsx(t,{sx:{pr:1},children:l.pointUnitType||""}),e.jsx(t,{children:l.aggregateType||"合算"})]})]})}),e.jsx(je,{style:{width:Ve,flex:"0 0 auto"},children:e.jsx(t,{sx:{height:50,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.main"},children:e.jsx(he,{size:"small",onClick:()=>ie(m),children:e.jsx(ge,{fontSize:"small",sx:{color:"common.white"}})})})})]})})},l.id)),n.placeholder]})})}):e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:n=>n.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{padding:"checkbox",sx:{width:48}}),e.jsx(c,{children:"プレー区分"}),e.jsx(c,{children:"プレー詳細"}),e.jsx(c,{children:"得点区分"}),e.jsx(c,{children:"得失点単位区分"}),e.jsx(c,{children:"集計方法"}),e.jsx(c,{})]})}),e.jsx(Oe,{onDragEnd:s,children:e.jsx(fe,{droppableId:"stats-settings",children:n=>e.jsxs(Le,{ref:n.innerRef,...n.droppableProps,children:[x.map((l,m)=>e.jsx(me,{draggableId:l.id,index:m,children:w=>e.jsxs(ae,{ref:w.innerRef,...w.draggableProps,"data-index":m,onClick:()=>Y(m),sx:{cursor:"pointer",height:50},children:[e.jsx(c,{padding:"checkbox",sx:{width:48},children:e.jsx(t,{onClick:f=>f.stopPropagation(),...w.dragHandleProps,sx:{cursor:"grab",display:"inline-flex",width:32,height:32,alignItems:"center",justifyContent:"center"},children:e.jsx(ye,{})})}),e.jsx(c,{children:l.playCategoryId?a(l.playCategoryId):l.playCategoryTags&&l.playCategoryTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:l.playCategoryTags.map(f=>{const I=D.find(re=>re.id===f);return e.jsx(se,{label:(I==null?void 0:I.name)||f,size:"small",sx:{backgroundColor:(I==null?void 0:I.color)||te,color:"#fff"}},f)})}):""}),e.jsx(c,{children:l.playDetailId?d(l.playDetailId):l.playDetailTags&&l.playDetailTags.length>0?e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:l.playDetailTags.map(f=>{const I=L.find(re=>re.id===f);return e.jsx(se,{label:(I==null?void 0:I.name)||f,size:"small",sx:{backgroundColor:(I==null?void 0:I.color)||te,color:"#fff"}},f)})}):""}),e.jsx(c,{children:l.pointType||""}),e.jsx(c,{children:l.pointUnitType||""}),e.jsx(c,{children:l.aggregateType||"合算"}),e.jsx(c,{padding:"checkbox",children:e.jsx(t,{onClick:f=>f.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:"small",onClick:()=>ie(m),sx:{width:24,height:24},children:e.jsx(ge,{fontSize:"small",color:"error"})})})})]})},l.id)),n.placeholder]})})})]})})]}),e.jsxs(Ge,{open:P,onClose:ce,children:[e.jsxs(be,{children:["スタッツ設定",V===-1?"追加":"編集"]}),e.jsxs(Ce,{children:[e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"stat-category-label",children:"プレー区分"}),e.jsxs(_e,{labelId:"stat-category-label",value:$,label:"プレー区分",onChange:n=>{K(n.target.value),g(""),G([]),J([])},disabled:y.length>0||X.length>0,children:[e.jsx(ee,{value:"",children:"なし"}),k.map(n=>e.jsx(ee,{value:n.id,children:n.name},n.id))]})]}),e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"stat-detail-label",children:"プレー詳細"}),e.jsxs(_e,{labelId:"stat-detail-label",value:p,label:"プレー詳細",onChange:n=>{g(n.target.value),B(""),H(""),G([]),J([])},disabled:q!==""||R!==""||y.length>0||X.length>0,children:[e.jsx(ee,{value:"",children:"なし"}),b.filter(n=>n.playCategoryId===$).map(n=>e.jsx(ee,{value:n.id,children:n.name},n.id))]})]}),e.jsx(vt,{multiple:!0,options:D,getOptionLabel:n=>n.name,value:D.filter(n=>y.includes(n.id)),onChange:(n,l)=>{G(l.map(m=>m.id)),l.length>0&&(K(""),g(""))},disabled:$!==""||p!=="",renderTags:(n,l)=>n.map((m,w)=>e.jsx(se,{...l({index:w}),label:m.name,size:"small",sx:{backgroundColor:m.color||te,color:"#fff"}})),renderInput:n=>e.jsx(xe,{...n,label:"プレー区分タグ",margin:"dense"}),fullWidth:!0}),e.jsx(vt,{multiple:!0,options:L,getOptionLabel:n=>n.name,value:L.filter(n=>X.includes(n.id)),onChange:(n,l)=>{J(l.map(m=>m.id)),l.length>0&&(K(""),g(""))},disabled:$!==""||p!=="",renderTags:(n,l)=>n.map((m,w)=>e.jsx(se,{...l({index:w}),label:m.name,size:"small",sx:{backgroundColor:m.color||te,color:"#fff"}})),renderInput:n=>e.jsx(xe,{...n,label:"プレー詳細タグ",margin:"dense"}),fullWidth:!0}),e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"stat-point-label",children:"得点区分"}),e.jsxs(_e,{labelId:"stat-point-label",value:q,label:"得点区分",onChange:n=>{B(n.target.value),n.target.value!==""&&g("")},disabled:p!=="",children:[e.jsx(ee,{value:"",children:"なし"}),e.jsx(ee,{value:"得点",children:"得点"}),e.jsx(ee,{value:"失点",children:"失点"})]})]}),e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"stat-unit-label",children:"得失点単位区分"}),e.jsxs(_e,{labelId:"stat-unit-label",value:R,label:"得失点単位区分",onChange:n=>{H(n.target.value),n.target.value!==""&&g("")},disabled:p!=="",children:[e.jsx(ee,{value:"",children:"なし"}),e.jsx(ee,{value:"メンバー",children:"メンバー"}),e.jsx(ee,{value:"チーム",children:"チーム"})]})]}),e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"stat-aggregate-label",children:"集計方法"}),e.jsxs(_e,{labelId:"stat-aggregate-label",value:le,label:"集計方法",onChange:n=>Z(n.target.value),children:[e.jsx(ee,{value:"合算",children:"合算"}),e.jsx(ee,{value:"セット平均",children:"セット平均"})]})]})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:ce,color:"inherit",startIcon:e.jsx(Ie,{}),children:"キャンセル"}),e.jsx(A,{onClick:ne,disabled:!Q(),startIcon:e.jsx(Se,{}),children:"OK"})]})]})]})}const jl={mode:"light",appBarColor:"#F5F5F5",appBarTextColor:"#000000",buttonColor:"#1C8139",scoreColor:"#1C8139",lossColor:"#D21972"},fl={mode:"light",appBarColor:"#F2EDE3",appBarTextColor:"#000000",buttonColor:"#48A588",scoreColor:"#48A588",lossColor:"#CE5164"},ml={mode:"dark",appBarColor:"#333333",appBarTextColor:"#FFFFFF",buttonColor:"#90CAF9",scoreColor:"#90CAF9",lossColor:"#F48FB1"},yl={mode:"dark",appBarColor:"#121212",appBarTextColor:"#FFFFFF",buttonColor:"#BB86FC",scoreColor:"#419552",lossColor:"#C77584"};function bl({theme:x,onThemeChange:h}){return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1,maxWidth:1024,width:"100%",mx:"auto"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"アプリカラー"}),e.jsx("input",{type:"color",value:x.appBarColor,onChange:k=>h({...x,appBarColor:k.target.value}),title:"背景色"}),e.jsx("input",{type:"color",value:x.appBarTextColor,onChange:k=>h({...x,appBarTextColor:k.target.value}),title:"文字色",style:{marginLeft:8}})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"ボタンカラー"}),e.jsx("input",{type:"color",value:x.buttonColor,onChange:k=>h({...x,buttonColor:k.target.value})})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"得点カラー"}),e.jsx("input",{type:"color",value:x.scoreColor,onChange:k=>h({...x,scoreColor:k.target.value})})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(t,{sx:{mr:2},children:"失点カラー"}),e.jsx("input",{type:"color",value:x.lossColor,onChange:k=>h({...x,lossColor:k.target.value})})]}),e.jsxs(t,{sx:{display:"flex",gap:1},children:[e.jsx(A,{variant:"contained",onClick:()=>h({...jl}),startIcon:e.jsx(tt,{}),children:"ライトモード１"}),e.jsx(A,{variant:"contained",onClick:()=>h({...fl}),startIcon:e.jsx(tt,{}),children:"ライトモード２"}),e.jsx(A,{variant:"contained",onClick:()=>h({...ml}),startIcon:e.jsx(tt,{}),children:"ダークモード１"}),e.jsx(A,{variant:"contained",onClick:()=>h({...yl}),startIcon:e.jsx(tt,{}),children:"ダークモード２"})]})]})}var nn={},Cl=ue;Object.defineProperty(nn,"__esModule",{value:!0});var $n=nn.default=void 0,vl=Cl(pe()),Il=e;$n=nn.default=(0,vl.default)((0,Il.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");function Sl({scoreInput:x,onScoreInputChange:h,dashboardVisible:k,onDashboardVisibleChange:b,showSnackbar:D}){const[L,N]=r.useState(!1),V=()=>{try{const p=[];for(let g=0;g<localStorage.length;g++){const y=localStorage.key(g);y&&y.startsWith("tutorial-")&&p.push(y)}p.forEach(g=>localStorage.removeItem(g)),D("ガイド表示済み状態をクリアしました","success")}catch(p){console.error(p),D("ガイド表示済み状態のクリアに失敗しました","error")}},F=()=>N(!0),$=()=>N(!1),K=()=>{N(!1),V()};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",mt:1,maxWidth:1024,width:"100%",mx:"auto"},children:[e.jsx(ot,{control:e.jsx(at,{checked:x.rallyMemberRequired,onChange:p=>h({...x,rallyMemberRequired:p.target.checked})}),label:"ラリー結果メンバー選択必須",sx:{mb:1}}),e.jsx(ot,{control:e.jsx(at,{checked:x.showRallyIcons,onChange:p=>h({...x,showRallyIcons:p.target.checked})}),label:"ラリー結果アイコン表示",sx:{mb:1}}),e.jsx(ot,{control:e.jsx(at,{checked:x.showScoreProgressArea,onChange:p=>h({...x,showScoreProgressArea:p.target.checked})}),label:"得点推移エリア表示",sx:{mb:1}}),e.jsx(ot,{control:e.jsx(at,{checked:x.showGridScrollHint,onChange:p=>h({...x,showGridScrollHint:p.target.checked})}),label:"グリッド横スクロール表記表示",sx:{mb:1}}),e.jsx(ot,{control:e.jsx(at,{checked:k,onChange:p=>b(p.target.checked)}),label:"ダッシュボード表示",sx:{mb:1,display:"none"}}),e.jsx(A,{variant:"contained",startIcon:e.jsx($n,{}),onClick:F,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"},alignSelf:"flex-start",mt:2},children:"ガイド再表示"}),e.jsxs(nt,{open:L,onClose:$,children:[e.jsx(be,{children:"確認"}),e.jsx(Ce,{sx:{mt:2},children:"ガイドを再表示しますか？"}),e.jsxs(ve,{children:[e.jsx(A,{onClick:$,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:K,startIcon:e.jsx(Se,{}),children:"OK"})]})]})]})}var sn={},kl=ue;Object.defineProperty(sn,"__esModule",{value:!0});var Hn=sn.default=void 0,Dl=kl(pe()),wl=e;Hn=sn.default=(0,Dl.default)((0,wl.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen");function Tl({teams:x,matches:h,tags:k,matchLocks:b,setMatchLocks:D,lockGroupBy:L,setLockGroupBy:N,isMobile:V}){return e.jsxs(t,{children:[e.jsx(t,{sx:{maxWidth:1024,mx:"auto"},children:V?e.jsx(Te,{size:"small",margin:"dense",children:e.jsxs(_e,{value:L,onChange:F=>N(F.target.value),children:[e.jsx(ee,{value:"none",children:"グルーピングなし"}),e.jsx(ee,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(ee,{value:"card",children:"対戦カード"})]})}):e.jsxs(xt,{exclusive:!0,value:L,onChange:(F,$)=>{$!==null&&N($)},sx:{mb:1},children:[e.jsx(De,{value:"none",children:"グルーピングなし"}),e.jsx(De,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(De,{value:"card",children:"対戦カード"})]})}),e.jsx(Fe,{component:We,storageKey:"match-lock-grid",sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(ze,{size:"small",children:[e.jsx(Ne,{children:e.jsxs(ae,{sx:{backgroundColor:F=>F.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(c,{padding:"checkbox"}),e.jsx(c,{children:"日付"}),e.jsx(c,{children:"試合名"}),e.jsx(c,{children:"対戦カード"}),e.jsx(c,{children:"タグ"}),e.jsx(c,{children:"セット"})]})}),e.jsx(Le,{children:function(){const F=g=>{var y;return((y=x.find(G=>G.id===g))==null?void 0:y.name)||""},$=L,K=Is(h,$),p=g=>g.map(y=>{const G=y.sets.filter(B=>B.my>B.opponent).length,X=y.sets.filter(B=>B.my<B.opponent).length,J=y.sets.map((B,R)=>{const H=R<y.sets.length-1?", ":"";return`${B.my}-${B.opponent}${H}`}).join(""),q=b[y.id];return e.jsxs(ae,{sx:{height:50},children:[e.jsx(c,{padding:"checkbox",children:e.jsx(he,{size:"small",onClick:()=>D(B=>({...B,[y.id]:!B[y.id]})),children:q?e.jsx(Dn,{sx:{color:"#D21972"}}):e.jsx(Hn,{sx:{color:"#1C8139"}})})}),e.jsx(c,{children:y.date}),e.jsx(c,{children:y.matchName}),e.jsx(c,{children:`${F(y.teamA)} - ${F(y.teamB)}`}),e.jsx(c,{children:y.tags.map(B=>{const R=k.find(le=>le.id===B),H=(R==null?void 0:R.color)||te;return e.jsx(se,{label:(R==null?void 0:R.name)||B,size:"small",sx:{mr:.5,mb:.5,backgroundColor:H,color:"#fff"}},B)})}),e.jsxs(c,{children:[G,"-",X," (",J,")"]})]},y.id)});return $==="none"?p(K.all||[]):Object.entries(K).map(([g,y])=>{const G=$==="card"?Ss(y[0].teamA,y[0].teamB,x):g;return e.jsxs(r.Fragment,{children:[e.jsx(ae,{sx:{height:50},children:e.jsx(c,{colSpan:6,sx:{...Ae},children:G})}),p(y)]},g)})}()})]})})]})}var ln={},_l=ue;Object.defineProperty(ln,"__esModule",{value:!0});var Wn=ln.default=void 0,Ol=_l(pe()),Rl=e;Wn=ln.default=(0,Ol.default)((0,Rl.jsx)("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 12H4V8h16z"}),"FolderOpen");var rn={},El=ue;Object.defineProperty(rn,"__esModule",{value:!0});var Ft=rn.default=void 0,Pl=El(pe()),Ml=e;Ft=rn.default=(0,Pl.default)((0,Ml.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");var on={},Al=ue;Object.defineProperty(on,"__esModule",{value:!0});var zn=on.default=void 0,$l=Al(pe()),Hl=e;zn=on.default=(0,$l.default)((0,Hl.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload");const Wl=`[team]
サンプルチーム

[member]
サンプルチーム,1,バレーボーラー

[rally-play-category]
スパイク

[rally-play-detail]
スパイク,イン,得点,メンバー
スパイク,アウト,失点,メンバー
スパイク,アウト,失点,メンバー`,Bt=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36),zl=x=>({id:crypto.randomUUID(),name:x}),Nl=x=>({id:Bt(),name:x,color:te,iconType:"none",tags:[],visible:!0});function Ll({onDeleteData:x,onImportData:h,onExportData:k,showSnackbar:b,teams:D,setTeams:L,setMembers:N,playCategories:V,setPlayCategories:F,setPlayDetails:$}){const[K,p]=r.useState(!1),[g,y]=r.useState(null),[G,X]=r.useState(!1),[J,q]=r.useState(!1),[B,R]=r.useState(Wl),H=()=>{p(!0)},le=async()=>{p(!1);try{await x(),b("全データを削除しました","success")}catch(d){console.error(d),b("全データの削除に失敗しました","error")}},Z=()=>{p(!1)},P=d=>{y(d.target.files&&d.target.files[0]?d.target.files[0]:null)},v=()=>{X(!0)},S=async()=>{X(!1);const d=g;y(null);try{d&&await h(d),b("インポートが完了しました","success")}catch(M){console.error(M),b("インポートに失敗しました","error")}},O=()=>{X(!1)},z=async()=>{try{await k(),b("エクスポートが完了しました","success")}catch(d){console.error(d),b("エクスポートに失敗しました","error")}},T=()=>{q(!0)},s=()=>{q(!1);try{const d=B.replace(/\r\n/g,`
`).split(`
`);let M="";const W=[],Y={},Q=[],ne=[];for(const ce of d){const ie=ce.trim();if(ie!==""){if(ie.startsWith("[")&&ie.endsWith("]")){M=ie.toLowerCase();continue}switch(M){case"[team]":W.push(zl(ie));break;case"[member]":{const[n,l,m]=ie.split(",").map(w=>w.trim());if(n&&l&&m){const w=[...D,...W].find(f=>f.name===n);if(w){const f={id:Bt(),no:Number(l),name:m,positions:[],visible:!0};Y[w.id]||(Y[w.id]=[]),Y[w.id].push(f)}}break}case"[rally-play-category]":Q.push(Nl(ie));break;case"[rally-play-detail]":{const[n,l,m,w]=ie.split(",").map(f=>f.trim());if(n&&l&&m&&w){const f=[...V,...Q].find(I=>I.name===n);f&&ne.push({id:Bt(),playCategoryId:f.id,name:l,pointType:m,pointUnitType:w,tags:[],visible:!0})}break}default:break}}}W.length&&L(ce=>[...ce,...W]),Object.keys(Y).length&&N(ce=>{const ie={...ce};for(const[n,l]of Object.entries(Y))ie[n]=[...ie[n]||[],...l];return ie}),Q.length&&F(ce=>[...ce,...Q]),ne.length&&$(ce=>[...ce,...ne]),W.length||Object.keys(Y).length||Q.length||ne.length?(b("一括登録が完了しました","success"),R("")):b("登録対象のデータがありません","error")}catch(d){console.error(d),b("一括登録に失敗しました","error")}},a=()=>{q(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{maxWidth:1024,width:"100%",mx:"auto",textAlign:"left",display:"flex",flexDirection:"column",gap:1,alignItems:"flex-start"},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"データエクスポート"}),e.jsx(t,{children:e.jsx(A,{variant:"contained",startIcon:e.jsx(zn,{}),onClick:z,children:"エクスポート"})}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"データインポート"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(A,{variant:"outlined",component:"label",startIcon:e.jsx(Wn,{}),children:["ファイル選択",e.jsx("input",{type:"file",accept:".zip",hidden:!0,onChange:P})]}),e.jsx(A,{variant:"contained",startIcon:e.jsx(Ft,{}),onClick:v,disabled:!g,children:"インポート"})]}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"一括登録"}),e.jsx(xe,{value:B,onChange:d=>R(d.target.value),multiline:!0,minRows:10,fullWidth:!0}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:e.jsx(A,{variant:"contained",startIcon:e.jsx(Ft,{}),onClick:T,children:"一括登録"})}),e.jsx(t,{sx:{mt:2,fontWeight:"bold"},children:"データ削除"}),e.jsx(A,{variant:"contained",color:"error",startIcon:e.jsx(ge,{}),onClick:H,children:"全データ削除"})]}),e.jsxs(nt,{open:K,onClose:Z,children:[e.jsx(be,{children:"削除確認"}),e.jsx(Ce,{sx:{mt:2},children:"全データを削除しますか？"}),e.jsxs(ve,{children:[e.jsx(A,{onClick:Z,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:le,color:"error",startIcon:e.jsx(Se,{}),children:"OK"})]})]}),e.jsxs(nt,{open:G,onClose:O,children:[e.jsx(be,{children:"確認"}),e.jsx(Ce,{sx:{mt:2},children:"データをインポートしますか？"}),e.jsxs(ve,{children:[e.jsx(A,{onClick:O,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:S,disabled:!g,startIcon:e.jsx(Se,{}),children:"OK"})]})]}),e.jsxs(nt,{open:J,onClose:a,children:[e.jsx(be,{children:"確認"}),e.jsx(Ce,{sx:{mt:2},children:"一括登録を実行しますか？"}),e.jsxs(ve,{children:[e.jsx(A,{onClick:a,startIcon:e.jsx(Ie,{}),color:"inherit",children:"キャンセル"}),e.jsx(A,{onClick:s,startIcon:e.jsx(Se,{}),children:"OK"})]})]})]})}var an={},Fl=ue;Object.defineProperty(an,"__esModule",{value:!0});var Nn=an.default=void 0,Bl=Fl(pe()),Ul=e;Nn=an.default=(0,Bl.default)((0,Ul.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");const Vl=`MIT License

Copyright (c) 2025 shinya_sun_sun

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
`;function Gl(x){if(!x)return"";let h=x.replace(/^git\+/,"");const k=h.match(/^git@github\.com:(.+)$/);k&&(h=`https://github.com/${k[1]}`);const b=h.match(/^git:\/\/github\.com\/(.+)$/);b&&(h=`https://github.com/${b[1]}`);const D=h.match(/^ssh:\/\/git@github\.com\/(.+)$/);return D&&(h=`https://github.com/${D[1]}`),h.startsWith("github.com/")&&(h=`https://${h}`),/^[a-zA-Z]+:\/\//.test(h)||(/^[^/]+\/[^/]+$/.test(h)?h=`https://github.com/${h}`:h=`https://${h}`),h=h.replace(/\.git$/,""),h}function Kl(){const[x,h]=r.useState(""),[k,b]=r.useState([]),[D,L]=r.useState(!0),[N,V]=r.useState({}),F={MIT:"https://opensource.org/license/mit/"};r.useEffect(()=>{ks(()=>import("./licenses-CkgLLKu8.js"),[]).then(p=>b(p.licenses)).finally(()=>L(!1))},[]);const $=r.useMemo(()=>k.filter(p=>p.name.toLowerCase().includes(x.toLowerCase())),[x,k]),K=async p=>{if(!N[p])try{const g=await fetch(`https://raw.githubusercontent.com/spdx/license-list-data/main/text/${p}.txt`);if(!g.ok)throw new Error("not ok");const y=await g.text();V(G=>({...G,[p]:y}))}catch{V(g=>({...g,[p]:""}))}};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(dt,{variant:"h6",sx:{mb:1},children:"BreakPoint MIT License"}),e.jsx(t,{component:"pre",sx:{p:1,backgroundColor:p=>p.palette.mode==="dark"?"#343A42":"#f5f5f5",color:p=>p.palette.text.primary,whiteSpace:"pre-wrap",minHeight:128,overflow:"auto"},children:Vl}),e.jsx(xe,{label:"検索",value:x,onChange:p=>h(p.target.value),sx:{my:2}}),e.jsx(t,{sx:{flexGrow:1,overflow:"auto"},children:D?e.jsx(t,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(gs,{})}):$.map(p=>{const g=p.license;return e.jsxs(js,{onChange:(y,G)=>{G&&K(g)},children:[e.jsxs(fs,{expandIcon:e.jsx(Nn,{}),children:[e.jsx(dt,{sx:{flexGrow:1},children:p.name}),e.jsx(dt,{variant:"body2",sx:{ml:2},children:g})]}),e.jsxs(ms,{children:[(()=>{const y=Gl(p.url);return y&&e.jsx(Ct,{href:y,target:"_blank",rel:"noopener",sx:{display:"block",mb:1,wordBreak:"break-all"},children:y})})(),p.license.startsWith("CC")&&p.attribution&&e.jsx(dt,{variant:"body2",sx:{mb:1,whiteSpace:"pre-wrap"},children:p.attribution}),N[g]!==void 0&&(N[g]?e.jsx(t,{component:"pre",sx:{p:1,backgroundColor:y=>y.palette.mode==="dark"?"#343A42":"#f5f5f5",color:y=>y.palette.text.primary,whiteSpace:"pre-wrap",maxHeight:300,overflow:"auto"},children:N[g]}):e.jsx(Ct,{href:F[g]||`https://spdx.org/licenses/${g}.html`,target:"_blank",rel:"noopener",sx:{wordBreak:"break-all"},children:F[g]||`https://spdx.org/licenses/${g}.html`}))]})]},p.name)})})]})}const ql=_s.create(t),Sn=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36);function kn(x){if(typeof window>"u")return x;try{const k=new DOMParser().parseFromString(x,"image/svg+xml"),b=new Set(["svg","g","path","circle","rect","line","polygon","polyline","text","defs","use"]),D=L=>{[...L.children].forEach(N=>{if(b.has(N.tagName))[...N.attributes].forEach(V=>{V.name.startsWith("on")&&N.removeAttribute(V.name)}),D(N);else{const V=document.createTextNode(N.outerHTML);N.replaceWith(V)}})};return D(k.documentElement),k.documentElement.outerHTML}catch{return""}}function Jl({src:x,cropX:h,cropY:k,onChange:b}){const D=r.useRef(null),L=r.useRef(null),[N,V]=r.useState(!1),[F,$]=r.useState({x:0,y:0}),K=()=>D.current?{sx:D.current.clientWidth/D.current.naturalWidth,sy:D.current.clientHeight/D.current.naturalHeight}:{sx:1,sy:1},p=J=>{J.preventDefault(),J.stopPropagation();const q=L.current.getBoundingClientRect();$({x:J.clientX-q.left,y:J.clientY-q.top}),V(!0)},g=J=>{if(!N||!D.current)return;const q=D.current.getBoundingClientRect(),{sx:B,sy:R}=K(),H=J.clientX-q.left-F.x,le=J.clientY-q.top-F.y,Z=Math.min(Math.max(0,H/B),D.current.naturalWidth-64),P=Math.min(Math.max(0,le/R),D.current.naturalHeight-64);b(Math.round(Z),Math.round(P))},y=()=>V(!1),{sx:G,sy:X}=K();return e.jsxs(t,{sx:{position:"relative",display:"inline-block"},onMouseMove:g,onMouseUp:y,onMouseLeave:y,children:[e.jsx("img",{src:x,ref:D,style:{maxWidth:256}}),e.jsx(t,{ref:L,sx:{position:"absolute",left:h*G,top:k*X,width:64,height:64,border:"1px solid red",cursor:"move"},onMouseDown:p})]})}function Yl({name:x}){const h=r.useRef(null),[k,b]=r.useState(1);return r.useEffect(()=>{const D=h.current;if(!D)return;const L=D.getBBox().width;b(L>64?64/L:1)},[x]),e.jsx("svg",{width:64,height:64,children:e.jsx("g",{transform:`scale(${k})`,children:e.jsx("text",{ref:h,x:32/k,y:32/k,textAnchor:"middle",dominantBaseline:"middle",fontSize:8,children:x})})})}function lr({matches:x,teams:h,teamMembers:k,playCategories:b,playDetails:D,statsSettings:L,tags:N,rallyCategoryTags:V,rallyDetailTags:F,themeSetting:$,scoreInputSetting:K,onSave:p,onDirtyChange:g,onDeleteData:y,onImportData:G,onExportData:X,showSnackbar:J,dashboardVisible:q,onDashboardVisibleChange:B,setAppBarLeftAction:R}){var fn;const[H,le]=r.useState("teams");r.useEffect(()=>{window.scrollTo(0,0)},[H]);const[Z,P]=r.useState([...h]),[v,S]=r.useState({...k}),[O,z]=r.useState(((fn=h[0])==null?void 0:fn.id)||""),[T,s]=r.useState([...b]),[a,d]=r.useState(null),[M,W]=r.useState(""),[Y,Q]=r.useState(te),[ne,ce]=r.useState("設定なし"),[ie,n]=r.useState(""),[l,m]=r.useState(""),[w,f]=r.useState(0),[I,re]=r.useState(0),[we,Re]=r.useState([]),[st,Ye]=r.useState(!0),[ht,Xe]=r.useState(!1),[Ze,ut]=r.useState(null),[pt,Qe]=r.useState(!1),[o,u]=r.useState([...D]),[_,E]=r.useState([...L]),[j,de]=r.useState([...N]),[$e,Ln]=r.useState([...V]),[He,Fn]=r.useState([...F]),[et,Bn]=r.useState({...$}),[qe,Un]=r.useState({...K}),[It,Vn]=r.useState([...x]),[lt,Gn]=r.useState(()=>{const i={};return x.forEach(C=>{i[C.id]=!!C.locked}),i}),[Kn,qn]=r.useState("none"),gt=!0,rt=bs(),jt=Cs();r.useEffect(()=>{if(!rt.pathname.startsWith("/settings"))return;rt.pathname.split("/")[2]},[gt,rt.pathname,jt]),r.useEffect(()=>{const C=rt.pathname.split("/")[2];le(C??null)},[rt.pathname,gt]);const[it,cn]=r.useState(null),[St,kt]=r.useState(""),[ft,Dt]=r.useState(""),[wt,Tt]=r.useState("得点"),[_t,Ot]=r.useState("メンバー"),[Rt,Et]=r.useState([]),[Pt,Mt]=r.useState(!0),[Jn,mt]=r.useState(!1),[dn,xn]=r.useState(null),[Yn,At]=r.useState(!1),Xn=i=>({id:crypto.randomUUID(),name:i}),Zn=i=>({id:Sn(),name:i,color:te,iconType:"none",tags:[],visible:!0}),yt=r.useMemo(()=>{const i=x.some(C=>!!C.locked!==lt[C.id]);return JSON.stringify(Z)!==JSON.stringify(h)||JSON.stringify(v)!==JSON.stringify(k)||JSON.stringify(T)!==JSON.stringify(b)||JSON.stringify(o)!==JSON.stringify(D)||JSON.stringify(_)!==JSON.stringify(L)||JSON.stringify(j)!==JSON.stringify(N)||JSON.stringify($e)!==JSON.stringify(V)||JSON.stringify(He)!==JSON.stringify(F)||JSON.stringify(et)!==JSON.stringify($)||JSON.stringify(qe)!==JSON.stringify(K)||i},[Z,v,T,o,_,j,$e,He,et,qe,lt,h,k,b,D,L,N,V,F,$,K,x]),Qn=r.useMemo(()=>[{key:"teams",label:"チーム",icon:e.jsx(_n,{})},{key:"members",label:"メンバー",icon:e.jsx(On,{})},{key:"scores",label:"ラリー",icon:e.jsx(Rn,{})},{key:"tags",label:"タグ",icon:e.jsx(En,{})},{key:"stats",label:"スタッツ",icon:e.jsx(Ds,{})},{key:"locks",label:"試合ロック",icon:e.jsx(Dn,{})},{key:"theme",label:"テーマ",icon:e.jsx(tt,{})},{key:"display",label:"表示・操作",icon:e.jsx(Pn,{})},{key:"data",label:"データ",icon:e.jsx(Mn,{})},{key:"license",label:"ライセンス",icon:e.jsx(ws,{})},{key:"version",label:"バージョン",icon:e.jsx(An,{})}],[]),es=r.useMemo(()=>[["teams","members","scores","tags","stats"],["display","theme"],["locks","data"],["license"],["version"]],[]),hn=r.useCallback(()=>{const i=It.map(C=>({...C,locked:lt[C.id]}));p(Z,v,T,o,_,j,$e,He,et,qe,i,!0)},[T,o,lt,It,p,Z,v,_,j,$e,He,et,qe]),ts=()=>{d(-1),W(""),Q(te),ce("設定なし"),n(""),m(""),f(0),re(0),Re([]),Ye(!0),Xe(!0)},ns=i=>{d(i),W(T[i].name),Q(T[i].color||te);const C=T[i];ce(C.iconType==="svg"?"SVG":C.iconType==="image"?"画像":"設定なし"),n(C.svg||""),m(C.image||""),f(C.cropX||0),re(C.cropY||0),Re(C.tags||[]),Ye(C.visible!==!1),Xe(!0)},ss=()=>{const i=ne==="SVG"?"svg":ne==="画像"?"image":"none",C=i==="svg"?{iconType:i,svg:ie}:i==="image"?{iconType:i,image:l,cropX:w,cropY:I}:{iconType:i};a===-1?s(U=>[...U,{...Zn(M),...C,color:Y,tags:we,visible:st}]):a!==null&&s(U=>U.map((oe,ke)=>ke===a?{...oe,name:M,...C,color:Y,tags:we,visible:st}:oe)),Xe(!1)},un=()=>{Xe(!1)},ls=i=>{ut(i),Qe(!0)},rs=()=>{if(Ze!==null&&T[Ze].id!=="init-serve"){const i=Ze,C=T[i];s(U=>U.filter((oe,ke)=>ke!==i)),J("プレー区分を削除しました","success",{actionLabel:"元に戻す",onAction:()=>{s(U=>{const oe=[...U];return oe.splice(i,0,C),oe})},autoHideDuration:5e3})}Qe(!1),ut(null)},pn=()=>{Qe(!1)},is=()=>{var i;cn(-1),kt(((i=T.find(C=>C.visible!==!1))==null?void 0:i.id)||""),Dt(""),Tt("得点"),Ot("メンバー"),Et([]),Mt(!0),mt(!0)},os=i=>{const C=o[i];cn(i),kt(C.playCategoryId),Dt(C.name),Tt(C.pointType),Ot(C.pointUnitType),Et(C.tags||[]),Mt(C.visible!==!1),mt(!0)},as=()=>{it===-1?u(i=>[...i,{id:Sn(),playCategoryId:St,name:ft,pointType:wt,pointUnitType:_t,tags:Rt,visible:Pt}]):it!==null&&u(i=>i.map((C,U)=>U===it?{...C,playCategoryId:St,name:ft,pointType:wt,pointUnitType:_t,tags:Rt,visible:Pt}:C)),mt(!1)},gn=()=>{mt(!1)},cs=i=>{xn(i),At(!0)},ds=()=>{if(dn!==null){const i=dn,C=o[i];u(U=>U.filter((oe,ke)=>ke!==i)),J("プレー詳細を削除しました","success",{actionLabel:"元に戻す",onAction:()=>{u(U=>{const oe=[...U];return oe.splice(i,0,C),oe})},autoHideDuration:5e3})}At(!1),xn(null)},jn=()=>{At(!1)};r.useEffect(()=>(R(H?e.jsx(he,{onClick:()=>jt("/settings"),size:"small",children:e.jsx(wn,{})}):null),()=>R(null)),[R,gt,H,jt]),r.useEffect(()=>(g==null||g(yt),()=>g==null?void 0:g(!1)),[yt,g]),r.useEffect(()=>{yt&&hn()},[yt,hn]);const xs=i=>i.iconType==="svg"&&i.svg?e.jsx(t,{sx:{width:64,height:64},dangerouslySetInnerHTML:{__html:kn(i.svg)}}):i.iconType==="image"&&i.image?e.jsx(t,{component:"img",src:i.image,sx:{width:64,height:64,objectFit:"none",objectPosition:`-${i.cropX||0}px -${i.cropY||0}px`}}):e.jsx(Yl,{name:i.name});return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",height:"100dvh"},children:[H===null?e.jsx(t,{children:es.map((i,C)=>e.jsx(ys,{orientation:"vertical",fullWidth:!0,variant:"outlined",sx:{mb:2,"& .MuiButton-root":{justifyContent:"flex-start",color:U=>U.palette.text.secondary,height:50,textAlign:"left"},"& .MuiButton-root .MuiButton-startIcon":{mr:1},"& .MuiButton-root .MuiButton-endIcon":{marginLeft:"auto"},"& .MuiButtonGroup-grouped":{borderColor:"divider"}},children:i.map(U=>{const oe=Qn.find(ke=>ke.key===U);return oe?e.jsxs(A,{onClick:U==="version"?void 0:()=>jt(`/settings/${U}`),disableRipple:U==="version",startIcon:oe.icon,endIcon:U==="version"?void 0:e.jsx(Tn,{sx:{color:ke=>ke.palette.text.secondary}}),children:[oe.label,U==="version"&&e.jsx(t,{component:"span",sx:{ml:"auto",color:ke=>ke.palette.text.secondary},children:"1.2.0"})]},U):null})},C))}):null,H!==null&&e.jsx(t,{sx:{mt:0,flexGrow:1,overflowY:"visible"},children:e.jsx(Ts,{mode:"wait",children:H&&e.jsxs(ql,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[H==="teams"&&e.jsx(cl,{teams:Z,setTeams:P,setMembers:S,selectedTeam:O,setSelectedTeam:z,createTeam:Xn,showSnackbar:J}),H==="members"&&(Z.length===0?e.jsxs(bt,{severity:"info",children:["チームを登録するとメンバーを設定できるようになります",e.jsx("br",{}),e.jsx(Ct,{component:vs,to:"/settings/teams",children:"チーム設定へ"})]}):O&&e.jsx(xl,{teams:Z,members:v,setMembers:S,selectedTeam:O,setSelectedTeam:z,showSnackbar:J})),H==="scores"&&e.jsx(hl,{openAddPlayDialog:ts,playCategories:T,setPlayCategories:s,openEditPlayDialog:ns,scoreInput:qe,renderIcon:xs,rallyCategoryTags:$e,handlePlayDelete:ls,openAddDetailDialog:is,playDetails:o,setPlayDetails:u,openEditDetailDialog:os,theme:et,rallyDetailTags:He,handleDetailDelete:cs}),H==="stats"&&e.jsx(gl,{statsSettings:_,setStatsSettings:E,playCategories:T,playDetails:o,rallyCategoryTags:$e,rallyDetailTags:He,showSnackbar:J}),H==="tags"&&e.jsx(ul,{tags:j,setTags:de,rallyCategoryTags:$e,setRallyCategoryTags:Ln,rallyDetailTags:He,setRallyDetailTags:Fn,setMatches:Vn,setPlayCategories:s,setPlayDetails:u,showSnackbar:J}),H==="locks"&&e.jsx(Tl,{teams:Z,matches:It,tags:j,matchLocks:lt,setMatchLocks:Gn,lockGroupBy:Kn,setLockGroupBy:qn,isMobile:gt}),H==="theme"&&e.jsx(bl,{theme:et,onThemeChange:Bn}),H==="display"&&e.jsx(Sl,{scoreInput:qe,onScoreInputChange:Un,dashboardVisible:q,onDashboardVisibleChange:B,showSnackbar:J}),H==="data"&&e.jsx(Ll,{onDeleteData:y,onImportData:G,onExportData:X,showSnackbar:J,teams:Z,setTeams:P,setMembers:S,playCategories:T,setPlayCategories:s,setPlayDetails:u}),H==="license"&&e.jsx(Kl,{})]},H)})}),e.jsxs(Ge,{open:ht,onClose:un,children:[e.jsxs(be,{children:["プレー区分",a===-1?"追加":"編集"]}),e.jsxs(Ce,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[e.jsx(xe,{label:"プレー区分",value:M,onChange:i=>W(i.target.value),fullWidth:!0,margin:"dense"}),e.jsx(xe,{label:"色",type:"color",value:Y,onChange:i=>Q(i.target.value),margin:"dense",InputLabelProps:{shrink:!0},fullWidth:!0}),e.jsx(vt,{multiple:!0,options:$e,getOptionLabel:i=>i.name,value:$e.filter(i=>we.includes(i.id)),onChange:(i,C)=>Re(C.map(U=>U.id)),renderTags:(i,C)=>i.map((U,oe)=>r.createElement(se,{...C({index:oe}),key:U.id,label:U.name,size:"small",sx:{backgroundColor:U.color||te,color:"#fff"}})),renderInput:i=>e.jsx(xe,{...i,label:"タグ",margin:"dense"})}),e.jsxs(bt,{severity:"info",children:["プレー区分タグは設定＞タグメニューにて追加できます",e.jsx("br",{}),"プレー区分にタグを設定することにより、プレー区分を横串で集計することが可能となります"]}),e.jsxs(xt,{exclusive:!0,value:st?"表示":"非表示",onChange:(i,C)=>C&&Ye(C==="表示"),fullWidth:!0,children:[e.jsxs(De,{value:"表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Pe,{sx:{mr:1}}),"表示"]}),e.jsxs(De,{value:"非表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Me,{sx:{mr:1}}),"非表示"]})]}),qe.showRallyIcons&&e.jsxs(e.Fragment,{children:[e.jsxs(xt,{exclusive:!0,value:ne,onChange:(i,C)=>C&&ce(C),children:[e.jsx(De,{value:"設定なし",children:"設定なし"}),e.jsx(De,{value:"SVG",children:"SVG"}),e.jsx(De,{value:"画像",children:"画像"})]}),ne==="SVG"&&e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{width:64,height:64},dangerouslySetInnerHTML:{__html:kn(ie)}}),e.jsx(xe,{multiline:!0,minRows:10,label:"SVG",value:ie,onChange:i=>n(i.target.value),fullWidth:!0,margin:"dense"})]}),ne==="画像"&&e.jsxs(e.Fragment,{children:[l&&e.jsx(Jl,{src:l,cropX:w,cropY:I,onChange:(i,C)=>{f(i),re(C)}}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/bmp,image/tiff,image/gif",onChange:i=>{var oe;const C=(oe=i.target.files)==null?void 0:oe[0];if(!C)return;const U=new FileReader;U.onload=()=>{m(U.result)},U.readAsDataURL(C)}})]})]})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:un,color:"inherit",startIcon:e.jsx(Ie,{}),children:"キャンセル"}),e.jsx(A,{onClick:ss,disabled:M.trim()==="",startIcon:e.jsx(Se,{}),children:"OK"})]})]}),e.jsxs(Ge,{open:Jn,onClose:gn,children:[e.jsxs(be,{children:["プレー詳細",it===-1?"追加":"編集"]}),e.jsxs(Ce,{children:[e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"detail-category-label",children:"プレー区分"}),e.jsx(_e,{labelId:"detail-category-label",value:St,label:"プレー区分",onChange:i=>kt(i.target.value),children:T.map(i=>e.jsx(ee,{value:i.id,children:i.name},i.id))})]}),e.jsx(xe,{fullWidth:!0,label:"プレー詳細",value:ft,onChange:i=>Dt(i.target.value),margin:"dense"}),e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"detail-point-label",children:"得点区分"}),e.jsxs(_e,{labelId:"detail-point-label",value:wt,label:"得点区分",onChange:i=>Tt(i.target.value),children:[e.jsx(ee,{value:"得点",children:"得点"}),e.jsx(ee,{value:"失点",children:"失点"})]})]}),e.jsxs(Te,{fullWidth:!0,margin:"dense",children:[e.jsx(Ee,{id:"detail-point-unit-label",children:"得失点単位区分"}),e.jsxs(_e,{labelId:"detail-point-unit-label",value:_t,label:"得失点単位区分",onChange:i=>Ot(i.target.value),disabled:it!==-1,children:[e.jsx(ee,{value:"メンバー",children:"メンバー"}),e.jsx(ee,{value:"チーム",children:"チーム"})]})]}),e.jsx(bt,{severity:"warning",sx:{whiteSpace:"pre-line",mt:1},children:`得失点単位区分は追加時にのみ設定でき、後から変更できません
再設定する場合はプレー詳細を作り直してください`}),e.jsx(vt,{multiple:!0,options:He,getOptionLabel:i=>i.name,value:He.filter(i=>Rt.includes(i.id)),onChange:(i,C)=>Et(C.map(U=>U.id)),renderTags:(i,C)=>i.map((U,oe)=>{const ke=U.color||te;return r.createElement(se,{...C({index:oe}),key:U.id,label:U.name,size:"small",sx:{backgroundColor:ke,color:"#fff"}})}),renderInput:i=>e.jsx(xe,{...i,label:"タグ",margin:"dense"})}),e.jsxs(bt,{severity:"info",sx:{mt:1},children:["プレー詳細タグは設定＞タグメニューにて追加できます",e.jsx("br",{}),"プレー詳細にタグを設定することにより、プレー詳細を横串で集計することが可能となります"]}),e.jsxs(xt,{exclusive:!0,value:Pt?"表示":"非表示",onChange:(i,C)=>C&&Mt(C==="表示"),fullWidth:!0,sx:{mt:2},children:[e.jsxs(De,{value:"表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Pe,{sx:{mr:1}}),"表示"]}),e.jsxs(De,{value:"非表示",sx:{width:"50%",whiteSpace:"nowrap"},children:[e.jsx(Me,{sx:{mr:1}}),"非表示"]})]})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:gn,color:"inherit",startIcon:e.jsx(Ie,{}),children:"キャンセル"}),e.jsx(A,{onClick:as,disabled:ft.trim()==="",startIcon:e.jsx(Se,{}),children:"OK"})]})]}),e.jsxs(nt,{open:pt,onClose:pn,children:[e.jsx(be,{children:"削除確認"}),e.jsxs(Ce,{sx:{mt:2},children:["このプレー区分を削除しますか？",e.jsx(t,{sx:{mt:1},children:"削除すると、すでに入力されている試合のスコアや分析に影響が出る可能性があります。"})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:pn,color:"inherit",startIcon:e.jsx(Ie,{}),children:"キャンセル"}),e.jsx(A,{onClick:rs,color:"error",startIcon:e.jsx(Se,{}),children:"OK"})]})]}),e.jsxs(nt,{open:Yn,onClose:jn,children:[e.jsx(be,{children:"削除確認"}),e.jsxs(Ce,{sx:{mt:2},children:["このプレー詳細を削除しますか？",e.jsx(t,{sx:{mt:1},children:"削除すると、すでに入力されている試合のスコアや分析に影響が出る可能性があります。"})]}),e.jsxs(ve,{children:[e.jsx(A,{onClick:jn,color:"inherit",startIcon:e.jsx(Ie,{}),children:"キャンセル"}),e.jsx(A,{onClick:ds,color:"error",startIcon:e.jsx(Se,{}),children:"OK"})]})]})]})}export{lr as default};
