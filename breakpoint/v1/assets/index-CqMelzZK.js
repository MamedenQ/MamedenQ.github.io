const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MatchDetail-CzqpSio9.js","assets/mui-vendor-Bb0AjAZd.js","assets/react-vendor-QLNaZ7XN.js","assets/QueryStatsOutlined-DJyyM_Zi.js","assets/DragIndicator-PjYelcOK.js","assets/chart-vendor-CuPFlH9t.js","assets/motion-vendor-Bslre2pU.js","assets/Settings-B4aLDb61.js","assets/Analysis-DR4QG7F3.js","assets/Dashboard-ZueDhn3L.js"])))=>i.map(i=>d[i]);
import{u as ds,i as X,j as e,a as Rt,b as us,B as z,T as hs,F as fs,S as ms,M as Ue,d as ps,e as Ae,f as Et,g as gs,h as xs,k as Ie,l as k,m as vs,D as Pe,n as be,o as $e,p as Se,q as le,r as ys,C as bs,I as Ss,s as js,t as Re,v as ws,A as Cs,w as Ds,x as Ts,y as _s,z as Us,E as As,G as Is,H as Rs,J as Es}from"./mui-vendor-Bb0AjAZd.js";import{d as Ms,a as Ls,r as c,b as te,u as Os,f as Bs,B as Ps,h as $s,i as fe,N as ks}from"./react-vendor-QLNaZ7XN.js";import{m as zs,A as Vs}from"./motion-vendor-Bslre2pU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Mt,ft=Ms;Mt=ft.createRoot,ft.hydrateRoot;const Hs="modulepreload",Ns=function(o){return"/breakpoint/v1/"+o},mt={},me=function(r,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(n.map(u=>{if(u=Ns(u),u in mt)return;mt[u]=!0;const S=u.endsWith(".css"),f=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=S?"stylesheet":Hs,S||(m.as="script"),m.crossOrigin="",m.href=u,h&&m.setAttribute("nonce",h),document.head.appendChild(m),S)return new Promise((y,L)=>{m.addEventListener("load",y),m.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return a.then(l=>{for(const h of l||[])h.status==="rejected"&&i(h.reason);return r().catch(i)})};var ke={},Ee={};const Ws=Ls(ds);var pt;function J(){return pt||(pt=1,function(o){"use client";Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=Ws}(Ee)),Ee}var qs=X;Object.defineProperty(ke,"__esModule",{value:!0});var Lt=ke.default=void 0,Fs=qs(J()),Gs=e;Lt=ke.default=(0,Fs.default)((0,Gs.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var ze={},Xs=X;Object.defineProperty(ze,"__esModule",{value:!0});var Ot=ze.default=void 0,Js=Xs(J()),Ys=e;Ot=ze.default=(0,Js.default)((0,Ys.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var Ve={},Ks=X;Object.defineProperty(Ve,"__esModule",{value:!0});var Bt=Ve.default=void 0,Qs=Ks(J()),Zs=e;Bt=Ve.default=(0,Qs.default)((0,Zs.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2M9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9zm9 14H6V10h12zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2"}),"LockOutlined");var He={},er=X;Object.defineProperty(He,"__esModule",{value:!0});var Ne=He.default=void 0,tr=er(J()),sr=e;Ne=He.default=(0,tr.default)((0,sr.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var We={},rr=X;Object.defineProperty(We,"__esModule",{value:!0});var qe=We.default=void 0,nr=rr(J()),or=e;qe=We.default=(0,nr.default)((0,or.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");const ar=(o,r)=>[o,r].sort().join(":"),ir=(o,r,n)=>[o,r].sort().map(s=>{var a;return((a=n.find(i=>i.id===s))==null?void 0:a.name)||""}).join(" - ");function lr(o,r){return o.reduce((n,s)=>{let a="";return r==="dateName"?a=`${s.date} ${s.matchName}`:r==="card"?a=ar(s.teamA,s.teamB):a="all",n[a]||(n[a]=[]),n[a].push(s),n},{})}function Fe(o){const r=Rt();return us(r.breakpoints.down(o))}function cr(){return e.jsxs("svg",{width:"160",height:"40",viewBox:"0 0 160 40",role:"img","aria-label":"横スクロール可能",children:[e.jsx("rect",{width:"160",height:"40",rx:"4",fill:"rgba(0,0,0,0.6)"}),e.jsx("text",{x:"80",y:"26",fill:"#fff",fontSize:"14",textAnchor:"middle",children:"横スクロール可能"})]})}const Pt=c.createContext({rallyMemberRequired:!1,showRallyIcons:!1,showScoreProgressArea:!1,showGridScrollHint:!1});function dr({storageKey:o,children:r,...n}){const s=c.useRef(null),[a,i]=c.useState(!1),l=Fe("md"),{showGridScrollHint:h}=c.useContext(Pt);c.useEffect(()=>{if(!l||!h){i(!1);return}const f=s.current;f&&(typeof window<"u"&&localStorage.getItem(`scrollHint-${o}`)||f.scrollWidth>f.clientWidth&&i(!0))},[l,o,h]);const u=c.useCallback(()=>{i(!1),typeof window<"u"&&localStorage.setItem(`scrollHint-${o}`,"1")},[o]);c.useEffect(()=>{const f=s.current;if(!a||!f)return;const m={once:!0,passive:!0};return f.addEventListener("scroll",u,m),f.addEventListener("pointerdown",u,m),f.addEventListener("touchstart",u,m),()=>{f.removeEventListener("scroll",u),f.removeEventListener("pointerdown",u),f.removeEventListener("touchstart",u)}},[a,u]);const S=c.isValidElement(r)?c.cloneElement(r,{sx:{minWidth:"100%",...r.props.sx||{}}}):r;return e.jsxs(z,{sx:{position:"relative",my:1,width:"100%"},children:[e.jsx(hs,{...n,ref:s,sx:{overflowX:"auto",WebkitOverflowScrolling:"touch","& th, & td":{whiteSpace:"nowrap"},...n.sx||{},width:"100%"},onClick:u,children:S}),a&&e.jsx(z,{onClick:u,sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10,cursor:"pointer"},children:e.jsx(cr,{})})]})}const Me="#1C8139",Le="#D21972",ye="#1C8139",Oe="#F5F5F5",Be="#000000",I=ye;function ur({matches:o,teams:r,tags:n,onSelect:s,onAdd:a,onDelete:i,hideFab:l=!1}){const[h,u]=c.useState(!1),[S,f]=c.useState([]),[m,y]=c.useState("none"),[L,H]=c.useState(!1),P=Fe("md"),V=A=>{var v;return((v=r.find(F=>F.id===A))==null?void 0:v.name)||""};c.useEffect(()=>{const A=setTimeout(()=>H(!0),300);return()=>clearTimeout(A)},[]),c.useEffect(()=>{l&&H(!1)},[l]);const R=A=>{f([A]),u(!0)},U=()=>{i(S),f([]),u(!1)},W=()=>{f([]),u(!1)},q=m,oe=lr(o,q),ae=A=>A.map(v=>{const F=v.sets.filter(T=>T.my>T.opponent).length,N=v.sets.filter(T=>T.my<T.opponent).length,ue=v.sets.map((T,G)=>{const ce=G<v.sets.length-1?", ":"";return`${T.my}-${T.opponent}${ce}`}).join("");return e.jsxs(Ie,{sx:{backgroundColor:"white",cursor:"pointer",height:50},hover:!0,onClick:()=>s(v),children:[e.jsx(k,{children:v.date}),e.jsx(k,{children:v.matchName}),e.jsx(k,{children:`${V(v.teamA)} - ${V(v.teamB)}`}),e.jsx(k,{children:v.tags.map(T=>{const G=n.find(Y=>Y.id===T),ce=(G==null?void 0:G.color)||I;return e.jsx(bs,{label:(G==null?void 0:G.name)||T,size:"small",sx:{mr:.5,mb:.5,backgroundColor:ce,color:"#fff"}},T)})}),e.jsxs(k,{children:[F,"-",N," (",ue,")"]}),e.jsx(k,{padding:"checkbox",children:e.jsx(z,{onClick:T=>T.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ss,{size:"small",onClick:v.locked?void 0:()=>R(v.id),disabled:v.locked,sx:{width:24,height:24},children:v.locked?e.jsx(Bt,{fontSize:"small",sx:{color:"#D21972"}}):e.jsx(Ot,{fontSize:"small",color:"error"})})})})]},v.id)});return e.jsxs(z,{sx:{pb:P?10:7},children:[e.jsx(z,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",alignItems:"center",mb:1},children:P?e.jsx(fs,{size:"small",children:e.jsxs(ms,{value:m,onChange:A=>y(A.target.value),children:[e.jsx(Ue,{value:"none",children:"グルーピングなし"}),e.jsx(Ue,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(Ue,{value:"card",children:"対戦カード"})]})}):e.jsxs(ps,{exclusive:!0,value:m,onChange:(A,v)=>{v!==null&&y(v)},children:[e.jsx(Ae,{value:"none",children:"グルーピングなし"}),e.jsx(Ae,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(Ae,{value:"card",children:"対戦カード"})]})}),e.jsx(dr,{component:Et,storageKey:"match-list",sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(gs,{size:"small",children:[e.jsx(xs,{children:e.jsxs(Ie,{sx:{backgroundColor:"#f5f5f5",height:50},children:[e.jsx(k,{children:"日付"}),e.jsx(k,{children:"試合名"}),e.jsx(k,{children:"対戦カード"}),e.jsx(k,{children:"タグ"}),e.jsx(k,{children:"セット"}),e.jsx(k,{})]})}),e.jsx(vs,{children:q==="none"?ae(oe.all||[]):Object.entries(oe).map(([A,v])=>{const F=q==="card"?ir(v[0].teamA,v[0].teamB,r):A;return e.jsxs(te.Fragment,{children:[e.jsx(Ie,{sx:{height:50},children:e.jsx(k,{colSpan:6,sx:{backgroundColor:"#f5f5f5",fontWeight:"bold"},children:F})}),ae(v)]},A)})})]})}),e.jsxs(Pe,{open:h,onClose:W,children:[e.jsx(be,{children:"削除確認"}),e.jsx($e,{sx:{mt:2},children:"この試合を削除しますか？"}),e.jsxs(Se,{children:[e.jsx(le,{onClick:W,startIcon:e.jsx(Ne,{}),color:"inherit",children:"キャンセル"}),e.jsx(le,{onClick:U,color:"error",startIcon:e.jsx(qe,{}),children:"OK"})]})]}),L&&e.jsx(ys,{ariaLabel:"add match",icon:e.jsx(Lt,{}),FabProps:{color:"primary",onClick:a},sx:{position:"fixed",right:20,bottom:80}})]})}var Ge={},hr=X;Object.defineProperty(Ge,"__esModule",{value:!0});var $t=Ge.default=void 0,fr=hr(J()),mr=e;$t=Ge.default=(0,fr.default)((0,mr.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 2.07c3.07.38 5.57 2.52 6.54 5.36L13 5.65zM8 5.08c1.18-.69 3.33-1.06 3-1.02v7.35l-3 1.73zM4.63 15.1c-.4-.96-.63-2-.63-3.1 0-2.02.76-3.86 2-5.27v7.58zm1.01 1.73L12 13.15l3 1.73-6.98 4.03c-.93-.53-1.74-1.23-2.38-2.08M12 20c-.54 0-1.07-.06-1.58-.16l6.58-3.8 1.36.78C16.9 18.75 14.6 20 12 20m1-8.58V7.96l7 4.05c0 1.1-.23 2.14-.63 3.09z"}),"SportsVolleyballOutlined");var Xe={},pr=X;Object.defineProperty(Xe,"__esModule",{value:!0});var kt=Xe.default=void 0,gr=pr(J()),xr=e;kt=Xe.default=(0,gr.default)((0,xr.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings");var Je={},vr=X;Object.defineProperty(Je,"__esModule",{value:!0});var zt=Je.default=void 0,yr=vr(J()),br=e;zt=Je.default=(0,yr.default)((0,br.jsx)("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"}),"BarChart");function Sr({value:o,onChange:r}){return e.jsx(Et,{sx:{position:"fixed",left:0,right:0,bottom:0,zIndex:n=>n.zIndex.drawer+1},elevation:3,children:e.jsxs(js,{showLabels:!0,value:o,onChange:(n,s)=>r(s),children:[e.jsx(Re,{label:"試合",value:"matches",icon:e.jsx($t,{})}),e.jsx(Re,{label:"分析",value:"analysis",icon:e.jsx(zt,{})}),e.jsx(Re,{label:"設定",value:"settings",icon:e.jsx(kt,{})})]})})}function jr({open:o,message:r,severity:n="success",onClose:s,actionLabel:a,onAction:i,autoHideDuration:l=3e3}){return e.jsx(ws,{open:o,autoHideDuration:l,onClose:s,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{top:{xs:72,sm:80}},children:e.jsx(Cs,{onClose:s,severity:n,sx:{width:"100%"},action:a&&i?e.jsx(le,{color:"inherit",size:"small",onClick:()=>{i(),s()},children:a}):void 0,children:r})})}const wr="breakpoint-db",se="state",re="widgets",ne="dashboards",Cr=3;function Dr(){return new Promise((o,r)=>{const n=indexedDB.open(wr,Cr);n.onupgradeneeded=()=>{const s=n.result;s.objectStoreNames.contains(se)||s.createObjectStore(se),s.objectStoreNames.contains(re)||s.createObjectStore(re,{keyPath:"id"}),s.objectStoreNames.contains(ne)||s.createObjectStore(ne,{keyPath:"id"})},n.onerror=()=>r(n.error),n.onsuccess=()=>o(n.result)})}const K=Dr();async function Tr(){const o=await K;return new Promise((r,n)=>{const a=o.transaction(se,"readonly").objectStore(se).get("state");a.onsuccess=()=>r(a.result),a.onerror=()=>n(a.error)})}async function _r(o){const r=await K;return new Promise((n,s)=>{const a=r.transaction(se,"readwrite");a.objectStore(se).put(o,"state"),a.oncomplete=()=>n(),a.onerror=()=>s(a.error)})}async function gt(){const o=await K;return new Promise((r,n)=>{const s=o.transaction(se,"readwrite");s.objectStore(se).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}async function Ur(){const o=await K;return new Promise((r,n)=>{const a=o.transaction(ne,"readonly").objectStore(ne).getAll();a.onsuccess=()=>{const i=a.result;i.sort((l,h)=>l.order-h.order),r(i)},a.onerror=()=>n(a.error)})}async function Ar(o){const r=await K;return new Promise((n,s)=>{const a=r.transaction(ne,"readwrite"),i=a.objectStore(ne);i.clear();for(const l of o)i.put(l);a.oncomplete=()=>n(),a.onerror=()=>s(a.error)})}async function Ir(){const o=await K;return new Promise((r,n)=>{const s=o.transaction(ne,"readwrite");s.objectStore(ne).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}async function Rr(o){const r=await K;return new Promise((n,s)=>{const i=r.transaction(re,"readonly").objectStore(re).getAll();i.onsuccess=()=>{const l=i.result;n(l.filter(h=>h.dashboardId===o))},i.onerror=()=>s(i.error)})}async function Er(o,r){const n=await K;return new Promise((s,a)=>{const i=n.transaction(re,"readwrite"),l=i.objectStore(re),h=l.getAll();h.onsuccess=()=>{const u=h.result;for(const S of u)S.dashboardId===o&&l.delete(S.id);for(const S of r)l.put({...S,dashboardId:o})},h.onerror=()=>a(h.error),i.oncomplete=()=>s(),i.onerror=()=>a(i.error)})}async function xt(){const o=await K;return new Promise((r,n)=>{const s=o.transaction(re,"readwrite");s.objectStore(re).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}function Mr(o,r){const s=new TextEncoder().encode(r),a=Or(s),i=new Uint8Array(30+o.length),l=new DataView(i.buffer);l.setUint32(0,67324752,!0),l.setUint16(4,20,!0),l.setUint16(6,0,!0),l.setUint16(8,0,!0),l.setUint16(10,0,!0),l.setUint16(12,0,!0),l.setUint32(14,a,!0),l.setUint32(18,s.length,!0),l.setUint32(22,s.length,!0),l.setUint16(26,o.length,!0),l.setUint16(28,0,!0);for(let m=0;m<o.length;m++)i[30+m]=o.charCodeAt(m);const h=new Uint8Array(46+o.length),u=new DataView(h.buffer);u.setUint32(0,33639248,!0),u.setUint16(4,20,!0),u.setUint16(6,20,!0),u.setUint16(8,0,!0),u.setUint16(10,0,!0),u.setUint16(12,0,!0),u.setUint16(14,0,!0),u.setUint32(16,a,!0),u.setUint32(20,s.length,!0),u.setUint32(24,s.length,!0),u.setUint16(28,o.length,!0),u.setUint16(30,0,!0),u.setUint16(32,0,!0),u.setUint16(34,0,!0),u.setUint16(36,0,!0),u.setUint32(38,0,!0),u.setUint32(42,0,!0);for(let m=0;m<o.length;m++)h[46+m]=o.charCodeAt(m);const S=new Uint8Array(22),f=new DataView(S.buffer);return f.setUint32(0,101010256,!0),f.setUint16(4,0,!0),f.setUint16(6,0,!0),f.setUint16(8,1,!0),f.setUint16(10,1,!0),f.setUint32(12,h.length,!0),f.setUint32(16,i.length+s.length,!0),f.setUint16(20,0,!0),new Blob([i,s,h,S],{type:"application/zip"})}async function Lr(o){const r=await o.arrayBuffer(),n=new DataView(r);if(n.getUint32(0,!0)!==67324752)throw new Error("invalid zip");const s=n.getUint16(26,!0),a=n.getUint16(28,!0),i=n.getUint32(22,!0),l=30+s+a,h=r.slice(l,l+i);return new TextDecoder().decode(h)}function Or(o){let r=-1;for(let n=0;n<o.length;n++)r=r>>>8^Br[(r^o[n])&255];return(r^-1)>>>0}const Br=(()=>{const o=new Uint32Array(256);for(let r=0;r<256;r++){let n=r;for(let s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;o[r]=n>>>0}return o})(),vt="1.0.0",Pr=c.lazy(()=>me(()=>import("./MatchDetail-CzqpSio9.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),$r=c.lazy(()=>me(()=>import("./Settings-B4aLDb61.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),kr=c.lazy(()=>me(()=>import("./Analysis-DR4QG7F3.js"),__vite__mapDeps([8,1,2,4,5,6]))),zr=c.lazy(()=>me(()=>import("./Dashboard-ZueDhn3L.js"),__vite__mapDeps([9,1,2,6]))),yt=[],bt={},St=[{id:"init-serve",name:"サーブ",color:I,iconType:"none",tags:[],visible:!0}],jt=[{id:"init-ace",playCategoryId:"init-serve",name:"エース",pointType:"得点",pointUnitType:"メンバー",tags:[],visible:!0},{id:"init-out",playCategoryId:"init-serve",name:"アウト",pointType:"失点",pointUnitType:"メンバー",tags:[],visible:!0},{id:"init-net",playCategoryId:"init-serve",name:"ネット",pointType:"失点",pointUnitType:"メンバー",tags:[],visible:!0}],wt=[],Ct={rallyMemberRequired:!1,showRallyIcons:!1,showScoreProgressArea:!1,showGridScrollHint:!1},Dt={scoreColor:Me,lossColor:Le,buttonColor:ye,appBarColor:Oe,appBarTextColor:Be},Tt=[],_t=[],Ut=[],At=[],It=[],xe=[],Vr=zs.create(z);function ve(){const[o,r]=c.useState(It),[n,s]=c.useState(yt),[a,i]=c.useState(bt),[l,h]=c.useState(St),[u,S]=c.useState(jt),[f,m]=c.useState(wt),[y,L]=c.useState(_t),[H,P]=c.useState(Ut),[V,R]=c.useState(At),[U,W]=c.useState(Dt),[q,oe]=c.useState(Ct),[ae,A]=c.useState(Tt),[v,F]=c.useState(xe),N=c.useRef(xe),[ue,T]=c.useState(null),[G,ce]=c.useState(null),[Y,pe]=c.useState(!1);c.useEffect(()=>{N.current=v},[v]);const[ie,Q]=c.useState(null),he=Os(),je=Bs(),Qe=t=>t.startsWith("/matches")?"matches":t.startsWith("/analysis")?"analysis":t.startsWith("/settings")?"settings":"dashboard",[$,Ze]=c.useState(Qe(he.pathname)),Z=t=>{Ze(t),je(t==="dashboard"?"/":`/${t}`)};c.useEffect(()=>{Ze(Qe(he.pathname))},[he.pathname]),c.useEffect(()=>{const t=he.pathname.split("/").filter(Boolean);if(t[0]==="matches"&&t[1]){const g=o.find(d=>d.id===t[1])||null;Q(g)}else Q(null)},[he.pathname,o]);const[Nt,Wt]=c.useState(null),[qt,et]=c.useState(null),[Ft,Gt]=c.useState(!1),[Xt,Jt]=c.useState(!1),[we,Ce]=c.useState(null),[Yt,De]=c.useState(!1),[Kt,tt]=c.useState(!1),[de,st]=c.useState({open:!1,message:"",severity:"success"}),Te=(t,g,d)=>{st({open:!0,message:t,severity:g,...d})},Qt=c.useMemo(()=>Ds({palette:{primary:{main:U.buttonColor}},components:{MuiButtonBase:{styleOverrides:{root:{"&:focus":{outline:"none"},"&.Mui-focusVisible":{outline:"none"}}}},MuiDialogTitle:{styleOverrides:{root:{backgroundColor:U.appBarColor,color:U.appBarTextColor}}}}}),[U.buttonColor,U.appBarColor,U.appBarTextColor]);c.useEffect(()=>{window.scrollTo(0,0)},[$,ie]),c.useEffect(()=>{!Y&&$==="dashboard"&&Z("matches")},[Y,$]),c.useEffect(()=>{Tr().then(t=>{if(!t)return;const g=p=>typeof p=="string"?{id:crypto.randomUUID(),name:p,color:I}:{id:p.id||crypto.randomUUID(),name:p.name,color:p.color||I},d=t.tags?t.tags.map(g):[],_=t.rallyCategoryTags?t.rallyCategoryTags.map(g):t.rallyTags?t.rallyTags.map(g):[],E=t.rallyDetailTags?t.rallyDetailTags.map(g):t.rallyTags?t.rallyTags.map(g):[];t.matches&&r(t.matches.map(p=>({...p,tags:(p.tags||[]).map(x=>{const j=d.find(ee=>ee.id===x);if(j)return j.id;const b=d.find(ee=>ee.name===x);if(b)return b.id;const D={id:crypto.randomUUID(),name:x,color:I};return d.push(D),D.id}),matchStatsSettings:p.matchStatsSettings||[]}))),t.teams&&s(t.teams),t.teamMembers&&i(t.teamMembers),t.playCategories&&h(t.playCategories.map(p=>({...p,tags:(p.tags||[]).map(x=>{const j=_.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return _.push(b),b.id}),color:p.color||I,visible:p.visible!==!1}))),t.playDetails&&S(t.playDetails.map(p=>({...p,tags:(p.tags||[]).map(x=>{const j=E.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return E.push(b),b.id}),visible:p.visible!==!1}))),t.statsSettings&&m(t.statsSettings.map(p=>({...p,playCategoryTags:(p.playCategoryTags||[]).map(x=>{const j=_.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return _.push(b),b.id}),playDetailTags:(p.playDetailTags||[]).map(x=>{const j=E.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return E.push(b),b.id})}))),L(d),P(_),R(E),t.themeSetting&&W({scoreColor:t.themeSetting.scoreColor??Me,lossColor:t.themeSetting.lossColor??Le,buttonColor:t.themeSetting.buttonColor??ye,appBarColor:t.themeSetting.appBarColor??Oe,appBarTextColor:t.themeSetting.appBarTextColor??Be}),t.scoreInputSetting&&oe({rallyMemberRequired:t.scoreInputSetting.rallyMemberRequired??!0,showRallyIcons:t.scoreInputSetting.showRallyIcons??!0,showScoreProgressArea:t.scoreInputSetting.showScoreProgressArea??!0,showGridScrollHint:t.scoreInputSetting.showGridScrollHint??!1}),t.customAnalyses&&A(t.customAnalyses),t.dashboardVisible!==void 0?(pe(t.dashboardVisible),t.dashboardVisible||Z("matches")):t.dashboardDisabled!==void 0&&(pe(!t.dashboardDisabled),t.dashboardDisabled&&Z("matches"))})},[]),c.useEffect(()=>{Ur().then(t=>{if(t.length===0)F([]),N.current=[],T(null),Z("matches");else{const g=t.sort((d,_)=>d.order-_.order);F(g),N.current=g,T(g[0].id)}})},[]),c.useEffect(()=>{_r({matches:o,teams:n,teamMembers:a,playCategories:l,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:q,customAnalyses:ae,dashboardVisible:Y})},[o,n,a,l,u,f,y,H,V,U,q,ae,Y]);const Zt=(t,g)=>{i(d=>({...d,[t]:[...d[t]||[],g]}))},es=()=>{const t={id:crypto.randomUUID(),date:new Date().toISOString().slice(0,10),matchName:"",location:"",mainReferee:"",subReferee:"",videoUrl:"",memo:"",teamA:"",teamAHeadCoach:"",teamACoach:"",teamAManager:"",teamACaptain:"",teamB:"",teamBHeadCoach:"",teamBCoach:"",teamBManager:"",teamBCaptain:"",tags:[],sets:[],teamAMembers:[],teamBMembers:[],matchStatsSettings:[],locked:!1};r(g=>[...g,t]),je(`/matches/${t.id}/info`),Q(t)},ts=t=>{let g=[];r(d=>(g=d.map(_=>({..._})),d.filter(_=>!t.includes(_.id)))),Te("試合を削除しました","success",{actionLabel:"元に戻す",onAction:()=>r(g),autoHideDuration:5e3})},ss=async()=>{await gt(),await Ir(),await xt(),r(It),s(yt),i(bt),h(St),S(jt),m(wt),L(_t),P(Ut),R(At),W(Dt),oe(Ct),A(Tt),F(xe),N.current=xe,T(null),Q(null),pe(!1),Z("matches")},rs=async()=>{const t=[];for(const b of N.current){const D=await Rr(b.id);t.push(...D)}const g={schemaVersion:vt,matches:o,teams:n,teamMembers:a,playCategories:l,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:q,customAnalyses:ae,dashboards:N.current,widgets:t},d=Mr("data.json",JSON.stringify(g)),_=URL.createObjectURL(d),E=document.createElement("a");E.href=_;const p=new Date,x=b=>b.toString().padStart(2,"0"),j=p.getFullYear().toString()+x(p.getMonth()+1)+x(p.getDate())+x(p.getHours())+x(p.getMinutes())+x(p.getSeconds());E.download=`breakpoint-data-${j}.zip`,E.click(),URL.revokeObjectURL(_)},ns=async t=>{var D,ee,ge,nt,ot,at,it,lt,ct,dt,ut,ht;const g=await Lr(t),d=JSON.parse(g),_=d.schemaVersion??"1.0.0";_!==vt&&console.warn(`unexpected schema version: ${_}`),await gt();const E=d.dashboards||[];if(F(E),N.current=E,await Ar(E),T(((D=E[0])==null?void 0:D.id)??null),await xt(),Array.isArray(d.widgets)){const w={};for(const C of d.widgets)(w[ee=C.dashboardId]||(w[ee]=[])).push(C);await Promise.all(Object.entries(w).map(([C,M])=>Er(C,M)))}const p=w=>typeof w=="string"?{id:crypto.randomUUID(),name:w,color:I}:{id:w.id||crypto.randomUUID(),name:w.name,color:w.color||I},x=((ge=d.tags)==null?void 0:ge.map(p))||[],j=(d.rallyCategoryTags?d.rallyCategoryTags:d.rallyTags||[]).map(p),b=(d.rallyDetailTags?d.rallyDetailTags:d.rallyTags||[]).map(p);r((d.matches||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=x.find(_e=>_e.id===C);if(M)return M.id;const O=x.find(_e=>_e.name===C);if(O)return O.id;const B={id:crypto.randomUUID(),name:C,color:I};return x.push(B),B.id})}))),s(d.teams||[]),i(d.teamMembers||{}),h((d.playCategories||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=j.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return j.push(O),O.id}),color:w.color||I}))),S((d.playDetails||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=b.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return b.push(O),O.id})}))),m((d.statsSettings||[]).map(w=>({...w,playCategoryTags:(w.playCategoryTags||[]).map(C=>{const M=j.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return j.push(O),O.id}),playDetailTags:(w.playDetailTags||[]).map(C=>{const M=b.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return b.push(O),O.id})}))),L(x),P(j),R(b),W({scoreColor:((nt=d.themeSetting)==null?void 0:nt.scoreColor)??Me,lossColor:((ot=d.themeSetting)==null?void 0:ot.lossColor)??Le,buttonColor:((at=d.themeSetting)==null?void 0:at.buttonColor)??ye,appBarColor:((it=d.themeSetting)==null?void 0:it.appBarColor)??Oe,appBarTextColor:((lt=d.themeSetting)==null?void 0:lt.appBarTextColor)??Be}),oe({rallyMemberRequired:((ct=d.scoreInputSetting)==null?void 0:ct.rallyMemberRequired)??!0,showRallyIcons:((dt=d.scoreInputSetting)==null?void 0:dt.showRallyIcons)??!0,showScoreProgressArea:((ut=d.scoreInputSetting)==null?void 0:ut.showScoreProgressArea)??!0,showGridScrollHint:((ht=d.scoreInputSetting)==null?void 0:ht.showGridScrollHint)??!1}),A(d.customAnalyses||[]),Q(null),Z(Y&&N.current.length>0?"dashboard":"matches")},os=t=>{r(g=>g.map(d=>d.id===t.id?{...d,...t}:d)),Q(t)},as=(t,g,d,_,E,p,x,j,b,D,ee,ge=!1)=>{s(t),i(g),h(d),S(_),m(E),L(p),P(x),R(j),W(b),oe(D),r(ee),ge||Z(Y&&N.current.length>0?"dashboard":"matches")},is=t=>{const g=ie?Ft:$==="settings"?Xt:!1,d=()=>{ie&&localStorage.removeItem(`matchDraft-${ie.id}`),t()};g?(Ce(()=>d),De(!0)):d()},ls=()=>{De(!1),we==null||we(),Ce(null)},rt=()=>{De(!1),Ce(null)},cs=$==="dashboard"?ue&&e.jsx(zr,{dashboardId:ue,editing:G===ue,onExitEdit:()=>ce(null),teams:n}):$==="settings"?e.jsx($r,{matches:o,teams:n,teamMembers:a,playCategories:l,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:q,onSave:as,onDeleteData:ss,onImportData:ns,onExportData:rs,showSnackbar:Te,dashboardVisible:Y,onDashboardVisibleChange:pe,setAppBarLeftAction:et,onDirtyChange:Jt}):$==="analysis"?e.jsx(kr,{matches:o,teams:n,teamMembers:a,playCategories:l,playDetails:u,customAnalyses:ae,onCustomAnalysesChange:A,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,showSnackbar:Te}):ie?e.jsx(Pr,{match:ie,onSave:os,setAppBarAction:Wt,setAppBarLeftAction:et,teams:n,teamMembers:a,playDetails:u,playCategories:l,statsSettings:f,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:q,onAddMember:Zt,tags:y,onAddTag:t=>L(g=>g.some(d=>d.id===t.id)?g:[...g,t]),onDirtyChange:Gt}):e.jsx(ur,{matches:o,teams:n,tags:y,onSelect:t=>{je(`/matches/${t.id}/info`),Q(t)},onAdd:es,onDelete:ts,hideFab:Kt});return e.jsx(Pt.Provider,{value:q,children:e.jsx(Ts,{theme:Qt,children:e.jsxs(z,{sx:{height:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box"},children:[e.jsx(_s,{}),e.jsx(Us,{position:"fixed",sx:{bgcolor:U.appBarColor,color:U.appBarTextColor},children:e.jsxs(As,{sx:{position:"relative"},children:[qt,e.jsx(Is,{variant:"h6",component:"div",sx:{position:"absolute",left:"50%",transform:"translateX(-50%)"},color:"inherit",children:"BreakPoint"}),e.jsx(z,{sx:{flexGrow:1}}),Nt]})}),e.jsx(z,{sx:{flex:1,position:"relative",display:"flex",overflowY:"auto"},children:e.jsx(Vs,{initial:!1,mode:"wait",children:e.jsx(Vr,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},sx:{position:"absolute",width:"100%",display:"flex"},children:e.jsx(Rs,{maxWidth:!1,disableGutters:!0,sx:{flex:1,pt:2,pb:2,display:"flex",flexDirection:"column"},children:e.jsx(c.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:cs})})},$)})}),e.jsx(Sr,{value:$==="matches"||$==="analysis"||$==="settings"?$:void 0,onChange:t=>{t===$&&ie===null||is(()=>{tt(!0),setTimeout(()=>{Q(null),Z(t),ce(null),tt(!1)},0)})}}),e.jsxs(Pe,{open:Yt,onClose:rt,children:[e.jsx(be,{children:"確認"}),e.jsx($e,{sx:{mt:2},children:"未保存のデータがあります。保存せずに移動しますか？"}),e.jsxs(Se,{children:[e.jsx(le,{onClick:rt,startIcon:e.jsx(Ne,{}),children:"キャンセル"}),e.jsx(le,{onClick:ls,color:"error",startIcon:e.jsx(qe,{}),children:"OK"})]})]}),e.jsx(jr,{open:de.open,message:de.message,severity:de.severity,actionLabel:de.actionLabel,onAction:de.onAction,autoHideDuration:de.autoHideDuration,onClose:()=>st(t=>({...t,open:!1}))})]})})})}const Hr=()=>e.jsx(Ps,{basename:"/breakpoint/v1",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs($s,{children:[e.jsx(fe,{path:"/",element:e.jsx(ve,{})}),e.jsx(fe,{path:"/matches/*",element:e.jsx(ve,{})}),e.jsx(fe,{path:"/analysis/*",element:e.jsx(ve,{})}),e.jsx(fe,{path:"/settings/*",element:e.jsx(ve,{})}),e.jsx(fe,{path:"*",element:e.jsx(ks,{to:"/",replace:!0})})]})});function Nr(o={}){const{immediate:r=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:a,onRegisteredSW:i,onRegisterError:l}=o;let h,u;const S=async(m=!0)=>{await u};async function f(){if("serviceWorker"in navigator){const{Workbox:m}=await me(async()=>{const{Workbox:y}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:y}},[]);h=new m("/breakpoint/v1/sw.js",{scope:"/breakpoint/v1/",type:"classic"}),h.addEventListener("activated",y=>{(y.isUpdate||y.isExternal)&&window.location.reload()}),h.addEventListener("installed",y=>{y.isUpdate||s==null||s()}),h.register({immediate:r}).then(y=>{i?i("/breakpoint/v1/sw.js",y):a==null||a(y)}).catch(y=>{l==null||l(y)})}}return u=f(),S}var Ye={},Wr=X;Object.defineProperty(Ye,"__esModule",{value:!0});var Vt=Ye.default=void 0,qr=Wr(J()),Fr=e;Vt=Ye.default=(0,qr.default)((0,Fr.jsx)("path",{d:"m12 16.5 4-4h-3v-9h-2v9H8zm9-13h-6v1.99h6v14.03H3V5.49h6V3.5H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2v-14c0-1.1-.9-2-2-2"}),"SystemUpdateAlt");var Ke={},Gr=X;Object.defineProperty(Ke,"__esModule",{value:!0});var Ht=Ke.default=void 0,Xr=Gr(J()),Jr=e;Ht=Ke.default=(0,Xr.default)((0,Jr.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m4.2 14.2L11 13V7h1.5v5.2l4.5 2.7z"}),"WatchLater");const Yr=({children:o,open:r=!1,onClose:n,PaperProps:s,...a})=>{var h;const i=Rt();if(Fe("md")){const u=()=>{n&&n({},"backdropClick")},S=te.Children.toArray(o);let f,m;const y=[];S.forEach(R=>{te.isValidElement(R)&&R.type===be?f=R:te.isValidElement(R)&&R.type===Se?m=R:y.push(R)});const L=m?te.Children.toArray(m.props.children):[],H=L[0],P=L.length>1?L[L.length-1]:void 0,V=(R,U)=>{if(te.isValidElement(R)){const W=R;return te.cloneElement(W,{sx:{minWidth:"auto",...W.props.sx||{},...U}})}return null};return e.jsx(Es,{anchor:"bottom",open:r,onClose:u,onOpen:()=>{},sx:{zIndex:i.zIndex.modal},PaperProps:{sx:{height:"100vh",borderTopLeftRadius:0,borderTopRightRadius:0}},children:e.jsxs(z,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(z,{sx:{position:"relative",display:"flex",alignItems:"center",p:2},children:[V(H),e.jsx(z,{sx:{position:"absolute",left:"50%",transform:"translateX(-50%)",fontWeight:"bold"},children:f==null?void 0:f.props.children}),P&&V(P,te.isValidElement(P)&&((h=P.props.sx)!=null&&h.color||P.props.color)?{ml:"auto"}:{ml:"auto",color:i.palette.primary.main})]}),e.jsx(z,{sx:{flex:1,overflowY:"auto"},children:y})]})})}return e.jsx(Pe,{...a,open:r,onClose:n,fullWidth:!0,maxWidth:!1,PaperProps:{sx:{width:"100%",maxWidth:768,...(s==null?void 0:s.sx)||{}},...s},children:o})};function Kr({open:o,onReload:r,onClose:n}){return e.jsxs(Yr,{open:o,onClose:n,children:[e.jsx(be,{children:"更新があります"}),e.jsx($e,{children:"更新があります。再読み込みしますか？"}),e.jsxs(Se,{children:[e.jsx(le,{onClick:n,color:"inherit",startIcon:e.jsx(Ht,{}),children:"後で"}),e.jsx(le,{onClick:r,autoFocus:!0,startIcon:e.jsx(Vt,{}),children:"再読み込み"})]})]})}const Qr=Nr({immediate:!0,onNeedRefresh(){window.dispatchEvent(new Event("sw-need-refresh"))}});function Zr(){const[o,r]=c.useState(!1);c.useEffect(()=>{const s=()=>r(!0);return window.addEventListener("sw-need-refresh",s),()=>window.removeEventListener("sw-need-refresh",s)},[]);const n=()=>{Qr(!0),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(Hr,{}),e.jsx(Kr,{open:o,onReload:n,onClose:()=>r(!1)})]})}Mt(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(Zr,{})}));export{jr as A,I as D,Yr as R,dr as S,me as _,Lt as a,Ne as b,qe as c,Ot as d,ir as e,Bt as f,lr as g,$t as h,Rr as l,J as r,Er as s,Fe as u};
