const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MatchDetail-DyB9y0Xq.js","assets/mui-vendor-Bb0AjAZd.js","assets/react-vendor-QLNaZ7XN.js","assets/QueryStatsOutlined-Bn6zPNu3.js","assets/DragIndicator-7S8wAhk2.js","assets/chart-vendor-CuPFlH9t.js","assets/motion-vendor-Bslre2pU.js","assets/Settings-BRrDXgbo.js","assets/Analysis-CXEAJkcg.js","assets/Dashboard-DFNQ2Qhu.js"])))=>i.map(i=>d[i]);
import{u as ds,i as J,j as e,a as It,b as us,B as z,T as hs,F as fs,S as ms,M as Ae,d as ps,e as Ie,f as Rt,g as gs,h as xs,k as Re,l as $,m as vs,D as ke,n as Se,o as $e,p as je,q as ce,r as ys,C as bs,I as Ss,s as js,t as Ee,v as ws,A as Cs,w as Ds,x as Ts,y as _s,z as Us,E as As,G as Is,H as Rs,J as Es}from"./mui-vendor-Bb0AjAZd.js";import{d as Ms,a as Ls,r as i,b as te,u as Os,f as Bs,B as Ps,h as ks,i as fe,N as $s}from"./react-vendor-QLNaZ7XN.js";import{m as zs,A as Vs}from"./motion-vendor-Bslre2pU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var Et,ht=Ms;Et=ht.createRoot,ht.hydrateRoot;const Hs="modulepreload",Ns=function(o){return"/breakpoint/v1/"+o},ft={},me=function(r,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),h=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=Promise.allSettled(n.map(u=>{if(u=Ns(u),u in ft)return;ft[u]=!0;const S=u.endsWith(".css"),f=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=S?"stylesheet":Hs,S||(m.as="script"),m.crossOrigin="",m.href=u,h&&m.setAttribute("nonce",h),document.head.appendChild(m),S)return new Promise((y,L)=>{m.addEventListener("load",y),m.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(c){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=c,window.dispatchEvent(h),!h.defaultPrevented)throw c}return a.then(c=>{for(const h of c||[])h.status==="rejected"&&l(h.reason);return r().catch(l)})};var ze={},Me={};const Ws=Ls(ds);var mt;function Y(){return mt||(mt=1,function(o){"use client";Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=Ws}(Me)),Me}var qs=J;Object.defineProperty(ze,"__esModule",{value:!0});var Mt=ze.default=void 0,Fs=qs(Y()),Gs=e;Mt=ze.default=(0,Fs.default)((0,Gs.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var Ve={},Xs=J;Object.defineProperty(Ve,"__esModule",{value:!0});var Lt=Ve.default=void 0,Js=Xs(Y()),Ys=e;Lt=Ve.default=(0,Js.default)((0,Ys.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var He={},Ks=J;Object.defineProperty(He,"__esModule",{value:!0});var Ot=He.default=void 0,Qs=Ks(Y()),Zs=e;Ot=He.default=(0,Qs.default)((0,Zs.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2M9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9zm9 14H6V10h12zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2"}),"LockOutlined");var Ne={},er=J;Object.defineProperty(Ne,"__esModule",{value:!0});var We=Ne.default=void 0,tr=er(Y()),sr=e;We=Ne.default=(0,tr.default)((0,sr.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var qe={},rr=J;Object.defineProperty(qe,"__esModule",{value:!0});var Fe=qe.default=void 0,nr=rr(Y()),or=e;Fe=qe.default=(0,nr.default)((0,or.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");const ar=(o,r)=>[o,r].sort().join(":"),ir=(o,r,n)=>[o,r].sort().map(s=>{var a;return((a=n.find(l=>l.id===s))==null?void 0:a.name)||""}).join(" - ");function lr(o,r){return o.reduce((n,s)=>{let a="";return r==="dateName"?a=`${s.date} ${s.matchName}`:r==="card"?a=ar(s.teamA,s.teamB):a="all",n[a]||(n[a]=[]),n[a].push(s),n},{})}function Ge(o){const r=It();return us(r.breakpoints.down(o))}function cr(){return e.jsxs("svg",{width:"160",height:"40",viewBox:"0 0 160 40",role:"img","aria-label":"横スクロール可能",children:[e.jsx("rect",{width:"160",height:"40",rx:"4",fill:"rgba(0,0,0,0.6)"}),e.jsx("text",{x:"80",y:"26",fill:"#fff",fontSize:"14",textAnchor:"middle",children:"横スクロール可能"})]})}const Bt=i.createContext({rallyMemberRequired:!1,showRallyIcons:!1,showScoreProgressArea:!1,showGridScrollHint:!1});function dr({storageKey:o,children:r,...n}){const s=i.useRef(null),[a,l]=i.useState(!1),c=Ge("md"),{showGridScrollHint:h}=i.useContext(Bt);i.useEffect(()=>{if(!c||!h){l(!1);return}const f=s.current;f&&(typeof window<"u"&&localStorage.getItem(`scrollHint-${o}`)||f.scrollWidth>f.clientWidth&&l(!0))},[c,o,h]);const u=i.useCallback(()=>{l(!1),typeof window<"u"&&localStorage.setItem(`scrollHint-${o}`,"1")},[o]);i.useEffect(()=>{const f=s.current;if(!a||!f)return;const m={once:!0,passive:!0};return f.addEventListener("scroll",u,m),f.addEventListener("pointerdown",u,m),f.addEventListener("touchstart",u,m),()=>{f.removeEventListener("scroll",u),f.removeEventListener("pointerdown",u),f.removeEventListener("touchstart",u)}},[a,u]);const S=i.isValidElement(r)?i.cloneElement(r,{sx:{minWidth:"100%",...r.props.sx||{}}}):r;return e.jsxs(z,{sx:{position:"relative",my:1,width:"100%"},children:[e.jsx(hs,{...n,ref:s,sx:{overflowX:"auto",WebkitOverflowScrolling:"touch","& th, & td":{whiteSpace:"nowrap"},...n.sx||{},width:"100%"},onClick:u,children:S}),a&&e.jsx(z,{onClick:u,sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10,cursor:"pointer"},children:e.jsx(cr,{})})]})}const Le="#1C8139",Oe="#D21972",be="#1C8139",Be="#F5F5F5",Pe="#000000",I=be;function ur({matches:o,teams:r,tags:n,onSelect:s,onAdd:a,onDelete:l,hideFab:c=!1}){const[h,u]=i.useState(!1),[S,f]=i.useState([]),[m,y]=i.useState("none"),[L,H]=i.useState(!1),P=Ge("md"),V=A=>{var v;return((v=r.find(G=>G.id===A))==null?void 0:v.name)||""};i.useEffect(()=>{const A=setTimeout(()=>H(!0),300);return()=>clearTimeout(A)},[]),i.useEffect(()=>{c&&H(!1)},[c]);const R=A=>{f([A]),u(!0)},U=()=>{l(S),f([]),u(!1)},q=()=>{f([]),u(!1)},F=m,oe=lr(o,F),ae=A=>A.map(v=>{const G=v.sets.filter(T=>T.my>T.opponent).length,N=v.sets.filter(T=>T.my<T.opponent).length,he=v.sets.map((T,X)=>{const de=X<v.sets.length-1?", ":"";return`${T.my}-${T.opponent}${de}`}).join("");return e.jsxs(Re,{sx:{backgroundColor:"white",cursor:"pointer",height:50},hover:!0,onClick:()=>s(v),children:[e.jsx($,{children:v.date}),e.jsx($,{children:v.matchName}),e.jsx($,{children:`${V(v.teamA)} - ${V(v.teamB)}`}),e.jsx($,{children:v.tags.map(T=>{const X=n.find(K=>K.id===T),de=(X==null?void 0:X.color)||I;return e.jsx(bs,{label:(X==null?void 0:X.name)||T,size:"small",sx:{mr:.5,mb:.5,backgroundColor:de,color:"#fff"}},T)})}),e.jsxs($,{children:[G,"-",N," (",he,")"]}),e.jsx($,{padding:"checkbox",children:e.jsx(z,{onClick:T=>T.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ss,{size:"small",onClick:v.locked?void 0:()=>R(v.id),disabled:v.locked,sx:{width:24,height:24},children:v.locked?e.jsx(Ot,{fontSize:"small",sx:{color:"#D21972"}}):e.jsx(Lt,{fontSize:"small",color:"error"})})})})]},v.id)});return e.jsxs(z,{sx:{pb:P?10:7},children:[e.jsx(z,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",alignItems:"center",mb:1},children:P?e.jsx(fs,{size:"small",children:e.jsxs(ms,{value:m,onChange:A=>y(A.target.value),children:[e.jsx(Ae,{value:"none",children:"グルーピングなし"}),e.jsx(Ae,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(Ae,{value:"card",children:"対戦カード"})]})}):e.jsxs(ps,{exclusive:!0,value:m,onChange:(A,v)=>{v!==null&&y(v)},children:[e.jsx(Ie,{value:"none",children:"グルーピングなし"}),e.jsx(Ie,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(Ie,{value:"card",children:"対戦カード"})]})}),e.jsx(dr,{component:Rt,storageKey:"match-list",sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(gs,{size:"small",children:[e.jsx(xs,{children:e.jsxs(Re,{sx:{backgroundColor:"#f5f5f5",height:50},children:[e.jsx($,{children:"日付"}),e.jsx($,{children:"試合名"}),e.jsx($,{children:"対戦カード"}),e.jsx($,{children:"タグ"}),e.jsx($,{children:"セット"}),e.jsx($,{})]})}),e.jsx(vs,{children:F==="none"?ae(oe.all||[]):Object.entries(oe).map(([A,v])=>{const G=F==="card"?ir(v[0].teamA,v[0].teamB,r):A;return e.jsxs(te.Fragment,{children:[e.jsx(Re,{sx:{height:50},children:e.jsx($,{colSpan:6,sx:{backgroundColor:"#f5f5f5",fontWeight:"bold"},children:G})}),ae(v)]},A)})})]})}),e.jsxs(ke,{open:h,onClose:q,children:[e.jsx(Se,{children:"削除確認"}),e.jsx($e,{sx:{mt:2},children:"この試合を削除しますか？"}),e.jsxs(je,{children:[e.jsx(ce,{onClick:q,startIcon:e.jsx(We,{}),color:"inherit",children:"キャンセル"}),e.jsx(ce,{onClick:U,color:"error",startIcon:e.jsx(Fe,{}),children:"OK"})]})]}),L&&e.jsx(ys,{ariaLabel:"add match",icon:e.jsx(Mt,{}),FabProps:{color:"primary",onClick:a},sx:{position:"fixed",right:20,bottom:80}})]})}var Xe={},hr=J;Object.defineProperty(Xe,"__esModule",{value:!0});var Pt=Xe.default=void 0,fr=hr(Y()),mr=e;Pt=Xe.default=(0,fr.default)((0,mr.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 2.07c3.07.38 5.57 2.52 6.54 5.36L13 5.65zM8 5.08c1.18-.69 3.33-1.06 3-1.02v7.35l-3 1.73zM4.63 15.1c-.4-.96-.63-2-.63-3.1 0-2.02.76-3.86 2-5.27v7.58zm1.01 1.73L12 13.15l3 1.73-6.98 4.03c-.93-.53-1.74-1.23-2.38-2.08M12 20c-.54 0-1.07-.06-1.58-.16l6.58-3.8 1.36.78C16.9 18.75 14.6 20 12 20m1-8.58V7.96l7 4.05c0 1.1-.23 2.14-.63 3.09z"}),"SportsVolleyballOutlined");var Je={},pr=J;Object.defineProperty(Je,"__esModule",{value:!0});var kt=Je.default=void 0,gr=pr(Y()),xr=e;kt=Je.default=(0,gr.default)((0,xr.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings");var Ye={},vr=J;Object.defineProperty(Ye,"__esModule",{value:!0});var $t=Ye.default=void 0,yr=vr(Y()),br=e;$t=Ye.default=(0,yr.default)((0,br.jsx)("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"}),"BarChart");function Sr({value:o,onChange:r}){return e.jsx(Rt,{sx:{position:"fixed",left:0,right:0,bottom:0,zIndex:n=>n.zIndex.drawer+1},elevation:3,children:e.jsxs(js,{showLabels:!0,value:o,onChange:(n,s)=>r(s),children:[e.jsx(Ee,{label:"試合",value:"matches",icon:e.jsx(Pt,{})}),e.jsx(Ee,{label:"分析",value:"analysis",icon:e.jsx($t,{})}),e.jsx(Ee,{label:"設定",value:"settings",icon:e.jsx(kt,{})})]})})}function jr({open:o,message:r,severity:n="success",onClose:s,actionLabel:a,onAction:l,autoHideDuration:c=3e3}){return e.jsx(ws,{open:o,autoHideDuration:c,onClose:s,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{top:{xs:72,sm:80}},children:e.jsx(Cs,{onClose:s,severity:n,sx:{width:"100%"},action:a&&l?e.jsx(ce,{color:"inherit",size:"small",onClick:()=>{l(),s()},children:a}):void 0,children:r})})}const wr="breakpoint-db",se="state",re="widgets",ne="dashboards",Cr=3;function Dr(){return new Promise((o,r)=>{const n=indexedDB.open(wr,Cr);n.onupgradeneeded=()=>{const s=n.result;s.objectStoreNames.contains(se)||s.createObjectStore(se),s.objectStoreNames.contains(re)||s.createObjectStore(re,{keyPath:"id"}),s.objectStoreNames.contains(ne)||s.createObjectStore(ne,{keyPath:"id"})},n.onerror=()=>r(n.error),n.onsuccess=()=>o(n.result)})}const Q=Dr();async function Tr(){const o=await Q;return new Promise((r,n)=>{const a=o.transaction(se,"readonly").objectStore(se).get("state");a.onsuccess=()=>r(a.result),a.onerror=()=>n(a.error)})}async function _r(o){const r=await Q;return new Promise((n,s)=>{const a=r.transaction(se,"readwrite");a.objectStore(se).put(o,"state"),a.oncomplete=()=>n(),a.onerror=()=>s(a.error)})}async function pt(){const o=await Q;return new Promise((r,n)=>{const s=o.transaction(se,"readwrite");s.objectStore(se).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}async function Ur(){const o=await Q;return new Promise((r,n)=>{const a=o.transaction(ne,"readonly").objectStore(ne).getAll();a.onsuccess=()=>{const l=a.result;l.sort((c,h)=>c.order-h.order),r(l)},a.onerror=()=>n(a.error)})}async function Ar(o){const r=await Q;return new Promise((n,s)=>{const a=r.transaction(ne,"readwrite"),l=a.objectStore(ne);l.clear();for(const c of o)l.put(c);a.oncomplete=()=>n(),a.onerror=()=>s(a.error)})}async function Ir(){const o=await Q;return new Promise((r,n)=>{const s=o.transaction(ne,"readwrite");s.objectStore(ne).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}async function Rr(o){const r=await Q;return new Promise((n,s)=>{const l=r.transaction(re,"readonly").objectStore(re).getAll();l.onsuccess=()=>{const c=l.result;n(c.filter(h=>h.dashboardId===o))},l.onerror=()=>s(l.error)})}async function Er(o,r){const n=await Q;return new Promise((s,a)=>{const l=n.transaction(re,"readwrite"),c=l.objectStore(re),h=c.getAll();h.onsuccess=()=>{const u=h.result;for(const S of u)S.dashboardId===o&&c.delete(S.id);for(const S of r)c.put({...S,dashboardId:o})},h.onerror=()=>a(h.error),l.oncomplete=()=>s(),l.onerror=()=>a(l.error)})}async function gt(){const o=await Q;return new Promise((r,n)=>{const s=o.transaction(re,"readwrite");s.objectStore(re).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}function Mr(o,r){const s=new TextEncoder().encode(r),a=Or(s),l=new Uint8Array(30+o.length),c=new DataView(l.buffer);c.setUint32(0,67324752,!0),c.setUint16(4,20,!0),c.setUint16(6,0,!0),c.setUint16(8,0,!0),c.setUint16(10,0,!0),c.setUint16(12,0,!0),c.setUint32(14,a,!0),c.setUint32(18,s.length,!0),c.setUint32(22,s.length,!0),c.setUint16(26,o.length,!0),c.setUint16(28,0,!0);for(let m=0;m<o.length;m++)l[30+m]=o.charCodeAt(m);const h=new Uint8Array(46+o.length),u=new DataView(h.buffer);u.setUint32(0,33639248,!0),u.setUint16(4,20,!0),u.setUint16(6,20,!0),u.setUint16(8,0,!0),u.setUint16(10,0,!0),u.setUint16(12,0,!0),u.setUint16(14,0,!0),u.setUint32(16,a,!0),u.setUint32(20,s.length,!0),u.setUint32(24,s.length,!0),u.setUint16(28,o.length,!0),u.setUint16(30,0,!0),u.setUint16(32,0,!0),u.setUint16(34,0,!0),u.setUint16(36,0,!0),u.setUint32(38,0,!0),u.setUint32(42,0,!0);for(let m=0;m<o.length;m++)h[46+m]=o.charCodeAt(m);const S=new Uint8Array(22),f=new DataView(S.buffer);return f.setUint32(0,101010256,!0),f.setUint16(4,0,!0),f.setUint16(6,0,!0),f.setUint16(8,1,!0),f.setUint16(10,1,!0),f.setUint32(12,h.length,!0),f.setUint32(16,l.length+s.length,!0),f.setUint16(20,0,!0),new Blob([l,s,h,S],{type:"application/zip"})}async function Lr(o){const r=await o.arrayBuffer(),n=new DataView(r);if(n.getUint32(0,!0)!==67324752)throw new Error("invalid zip");const s=n.getUint16(26,!0),a=n.getUint16(28,!0),l=n.getUint32(22,!0),c=30+s+a,h=r.slice(c,c+l);return new TextDecoder().decode(h)}function Or(o){let r=-1;for(let n=0;n<o.length;n++)r=r>>>8^Br[(r^o[n])&255];return(r^-1)>>>0}const Br=(()=>{const o=new Uint32Array(256);for(let r=0;r<256;r++){let n=r;for(let s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;o[r]=n>>>0}return o})(),xt="1.0.0",Pr=i.lazy(()=>me(()=>import("./MatchDetail-DyB9y0Xq.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),kr=i.lazy(()=>me(()=>import("./Settings-BRrDXgbo.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),$r=i.lazy(()=>me(()=>import("./Analysis-CXEAJkcg.js"),__vite__mapDeps([8,1,2,4,5,6]))),zr=i.lazy(()=>me(()=>import("./Dashboard-DFNQ2Qhu.js"),__vite__mapDeps([9,1,2,6]))),vt=[],yt={},bt=[{id:"init-serve",name:"サーブ",color:I,iconType:"none",tags:[],visible:!0}],St=[{id:"init-ace",playCategoryId:"init-serve",name:"エース",pointType:"得点",pointUnitType:"メンバー",tags:[],visible:!0},{id:"init-out",playCategoryId:"init-serve",name:"アウト",pointType:"失点",pointUnitType:"メンバー",tags:[],visible:!0},{id:"init-net",playCategoryId:"init-serve",name:"ネット",pointType:"失点",pointUnitType:"メンバー",tags:[],visible:!0}],jt=[],wt={rallyMemberRequired:!1,showRallyIcons:!1,showScoreProgressArea:!1,showGridScrollHint:!1},Ct={scoreColor:Le,lossColor:Oe,buttonColor:be,appBarColor:Be,appBarTextColor:Pe},Dt=[],Tt=[],_t=[],Ut=[],At=[],ve=[],Vr=zs.create(z);function ye(){const[o,r]=i.useState(At),[n,s]=i.useState(vt),[a,l]=i.useState(yt),[c,h]=i.useState(bt),[u,S]=i.useState(St),[f,m]=i.useState(jt),[y,L]=i.useState(Tt),[H,P]=i.useState(_t),[V,R]=i.useState(Ut),[U,q]=i.useState(Ct),[F,oe]=i.useState(wt),[ae,A]=i.useState(Dt),[v,G]=i.useState(ve),N=i.useRef(ve),[he,T]=i.useState(null),[X,de]=i.useState(null),[K,pe]=i.useState(!1);i.useEffect(()=>{N.current=v},[v]);const[ie,Z]=i.useState(null),le=Os(),ge=Bs(),we=i.useCallback(t=>t.startsWith("/matches")?"matches":t.startsWith("/analysis")?"analysis":t.startsWith("/settings")?"settings":"dashboard",[]),[k,Ht]=i.useState(we(le.pathname)),W=i.useCallback(t=>{Ht(t);const p=t==="dashboard"?"/":`/${t}`;le.pathname!==p&&ge(p)},[ge,le.pathname]);i.useEffect(()=>{W(we(le.pathname))},[le.pathname,W,we]),i.useEffect(()=>{const t=le.pathname.split("/").filter(Boolean);if(t[0]==="matches"&&t[1]){const p=o.find(d=>d.id===t[1])||null;Z(p)}else Z(null)},[le.pathname,o]);const[Nt,Wt]=i.useState(null),[qt,Ze]=i.useState(null),[Ft,Gt]=i.useState(!1),[Xt,Jt]=i.useState(!1),[Ce,De]=i.useState(null),[Yt,Te]=i.useState(!1),[Kt,et]=i.useState(!1),[ue,tt]=i.useState({open:!1,message:"",severity:"success"}),_e=(t,p,d)=>{tt({open:!0,message:t,severity:p,...d})},Qt=i.useMemo(()=>Ds({palette:{primary:{main:U.buttonColor}},components:{MuiButtonBase:{styleOverrides:{root:{"&:focus":{outline:"none"},"&.Mui-focusVisible":{outline:"none"}}}},MuiDialogTitle:{styleOverrides:{root:{backgroundColor:U.appBarColor,color:U.appBarTextColor}}}}}),[U.buttonColor,U.appBarColor,U.appBarTextColor]);i.useEffect(()=>{window.scrollTo(0,0)},[k,ie]),i.useEffect(()=>{!K&&k==="dashboard"&&W("matches")},[K,k,W]),i.useEffect(()=>{Tr().then(t=>{if(!t)return;const p=g=>typeof g=="string"?{id:crypto.randomUUID(),name:g,color:I}:{id:g.id||crypto.randomUUID(),name:g.name,color:g.color||I},d=t.tags?t.tags.map(p):[],_=t.rallyCategoryTags?t.rallyCategoryTags.map(p):t.rallyTags?t.rallyTags.map(p):[],E=t.rallyDetailTags?t.rallyDetailTags.map(p):t.rallyTags?t.rallyTags.map(p):[];t.matches&&r(t.matches.map(g=>({...g,tags:(g.tags||[]).map(x=>{const j=d.find(ee=>ee.id===x);if(j)return j.id;const b=d.find(ee=>ee.name===x);if(b)return b.id;const D={id:crypto.randomUUID(),name:x,color:I};return d.push(D),D.id}),matchStatsSettings:g.matchStatsSettings||[]}))),t.teams&&s(t.teams),t.teamMembers&&l(t.teamMembers),t.playCategories&&h(t.playCategories.map(g=>({...g,tags:(g.tags||[]).map(x=>{const j=_.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return _.push(b),b.id}),color:g.color||I,visible:g.visible!==!1}))),t.playDetails&&S(t.playDetails.map(g=>({...g,tags:(g.tags||[]).map(x=>{const j=E.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return E.push(b),b.id}),visible:g.visible!==!1}))),t.statsSettings&&m(t.statsSettings.map(g=>({...g,playCategoryTags:(g.playCategoryTags||[]).map(x=>{const j=_.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return _.push(b),b.id}),playDetailTags:(g.playDetailTags||[]).map(x=>{const j=E.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return E.push(b),b.id})}))),L(d),P(_),R(E),t.themeSetting&&q({scoreColor:t.themeSetting.scoreColor??Le,lossColor:t.themeSetting.lossColor??Oe,buttonColor:t.themeSetting.buttonColor??be,appBarColor:t.themeSetting.appBarColor??Be,appBarTextColor:t.themeSetting.appBarTextColor??Pe}),t.scoreInputSetting&&oe({rallyMemberRequired:t.scoreInputSetting.rallyMemberRequired??!0,showRallyIcons:t.scoreInputSetting.showRallyIcons??!0,showScoreProgressArea:t.scoreInputSetting.showScoreProgressArea??!0,showGridScrollHint:t.scoreInputSetting.showGridScrollHint??!1}),t.customAnalyses&&A(t.customAnalyses),t.dashboardVisible!==void 0?(pe(t.dashboardVisible),t.dashboardVisible||W("matches")):t.dashboardDisabled!==void 0&&(pe(!t.dashboardDisabled),t.dashboardDisabled&&W("matches"))})},[]),i.useEffect(()=>{Ur().then(t=>{if(t.length===0)G([]),N.current=[],T(null),W("matches");else{const p=t.sort((d,_)=>d.order-_.order);G(p),N.current=p,T(p[0].id)}})},[]),i.useEffect(()=>{_r({matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:F,customAnalyses:ae,dashboardVisible:K})},[o,n,a,c,u,f,y,H,V,U,F,ae,K]);const Zt=(t,p)=>{l(d=>({...d,[t]:[...d[t]||[],p]}))},es=()=>{const t={id:crypto.randomUUID(),date:new Date().toISOString().slice(0,10),matchName:"",location:"",mainReferee:"",subReferee:"",videoUrl:"",memo:"",teamA:"",teamAHeadCoach:"",teamACoach:"",teamAManager:"",teamACaptain:"",teamB:"",teamBHeadCoach:"",teamBCoach:"",teamBManager:"",teamBCaptain:"",tags:[],sets:[],teamAMembers:[],teamBMembers:[],matchStatsSettings:[],locked:!1};r(p=>[...p,t]),ge(`/matches/${t.id}/info`),Z(t)},ts=t=>{let p=[];r(d=>(p=d.map(_=>({..._})),d.filter(_=>!t.includes(_.id)))),_e("試合を削除しました","success",{actionLabel:"元に戻す",onAction:()=>r(p),autoHideDuration:5e3})},ss=async()=>{await pt(),await Ir(),await gt(),r(At),s(vt),l(yt),h(bt),S(St),m(jt),L(Tt),P(_t),R(Ut),q(Ct),oe(wt),A(Dt),G(ve),N.current=ve,T(null),Z(null),pe(!1),W("matches")},rs=async()=>{const t=[];for(const b of N.current){const D=await Rr(b.id);t.push(...D)}const p={schemaVersion:xt,matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:F,customAnalyses:ae,dashboards:N.current,widgets:t},d=Mr("data.json",JSON.stringify(p)),_=URL.createObjectURL(d),E=document.createElement("a");E.href=_;const g=new Date,x=b=>b.toString().padStart(2,"0"),j=g.getFullYear().toString()+x(g.getMonth()+1)+x(g.getDate())+x(g.getHours())+x(g.getMinutes())+x(g.getSeconds());E.download=`breakpoint-data-${j}.zip`,E.click(),URL.revokeObjectURL(_)},ns=async t=>{var D,ee,xe,rt,nt,ot,at,it,lt,ct,dt,ut;const p=await Lr(t),d=JSON.parse(p),_=d.schemaVersion??"1.0.0";_!==xt&&console.warn(`unexpected schema version: ${_}`),await pt();const E=d.dashboards||[];if(G(E),N.current=E,await Ar(E),T(((D=E[0])==null?void 0:D.id)??null),await gt(),Array.isArray(d.widgets)){const w={};for(const C of d.widgets)(w[ee=C.dashboardId]||(w[ee]=[])).push(C);await Promise.all(Object.entries(w).map(([C,M])=>Er(C,M)))}const g=w=>typeof w=="string"?{id:crypto.randomUUID(),name:w,color:I}:{id:w.id||crypto.randomUUID(),name:w.name,color:w.color||I},x=((xe=d.tags)==null?void 0:xe.map(g))||[],j=(d.rallyCategoryTags?d.rallyCategoryTags:d.rallyTags||[]).map(g),b=(d.rallyDetailTags?d.rallyDetailTags:d.rallyTags||[]).map(g);r((d.matches||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=x.find(Ue=>Ue.id===C);if(M)return M.id;const O=x.find(Ue=>Ue.name===C);if(O)return O.id;const B={id:crypto.randomUUID(),name:C,color:I};return x.push(B),B.id})}))),s(d.teams||[]),l(d.teamMembers||{}),h((d.playCategories||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=j.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return j.push(O),O.id}),color:w.color||I}))),S((d.playDetails||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=b.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return b.push(O),O.id})}))),m((d.statsSettings||[]).map(w=>({...w,playCategoryTags:(w.playCategoryTags||[]).map(C=>{const M=j.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return j.push(O),O.id}),playDetailTags:(w.playDetailTags||[]).map(C=>{const M=b.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return b.push(O),O.id})}))),L(x),P(j),R(b),q({scoreColor:((rt=d.themeSetting)==null?void 0:rt.scoreColor)??Le,lossColor:((nt=d.themeSetting)==null?void 0:nt.lossColor)??Oe,buttonColor:((ot=d.themeSetting)==null?void 0:ot.buttonColor)??be,appBarColor:((at=d.themeSetting)==null?void 0:at.appBarColor)??Be,appBarTextColor:((it=d.themeSetting)==null?void 0:it.appBarTextColor)??Pe}),oe({rallyMemberRequired:((lt=d.scoreInputSetting)==null?void 0:lt.rallyMemberRequired)??!0,showRallyIcons:((ct=d.scoreInputSetting)==null?void 0:ct.showRallyIcons)??!0,showScoreProgressArea:((dt=d.scoreInputSetting)==null?void 0:dt.showScoreProgressArea)??!0,showGridScrollHint:((ut=d.scoreInputSetting)==null?void 0:ut.showGridScrollHint)??!1}),A(d.customAnalyses||[]),Z(null),W(K&&N.current.length>0?"dashboard":"matches")},os=t=>{r(p=>p.map(d=>d.id===t.id?{...d,...t}:d)),Z(t)},as=(t,p,d,_,E,g,x,j,b,D,ee,xe=!1)=>{s(t),l(p),h(d),S(_),m(E),L(g),P(x),R(j),q(b),oe(D),r(ee),xe||W(K&&N.current.length>0?"dashboard":"matches")},is=t=>{const p=ie?Ft:k==="settings"?Xt:!1,d=()=>{ie&&localStorage.removeItem(`matchDraft-${ie.id}`),t()};p?(De(()=>d),Te(!0)):d()},ls=()=>{Te(!1),Ce==null||Ce(),De(null)},st=()=>{Te(!1),De(null)},cs=k==="dashboard"?he&&e.jsx(zr,{dashboardId:he,editing:X===he,onExitEdit:()=>de(null),teams:n}):k==="settings"?e.jsx(kr,{matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:F,onSave:as,onDeleteData:ss,onImportData:ns,onExportData:rs,showSnackbar:_e,dashboardVisible:K,onDashboardVisibleChange:pe,setAppBarLeftAction:Ze,onDirtyChange:Jt}):k==="analysis"?e.jsx($r,{matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,customAnalyses:ae,onCustomAnalysesChange:A,tags:y,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,showSnackbar:_e}):ie?e.jsx(Pr,{match:ie,onSave:os,setAppBarAction:Wt,setAppBarLeftAction:Ze,teams:n,teamMembers:a,playDetails:u,playCategories:c,statsSettings:f,rallyCategoryTags:H,rallyDetailTags:V,themeSetting:U,scoreInputSetting:F,onAddMember:Zt,tags:y,onAddTag:t=>L(p=>p.some(d=>d.id===t.id)?p:[...p,t]),onDirtyChange:Gt}):e.jsx(ur,{matches:o,teams:n,tags:y,onSelect:t=>{ge(`/matches/${t.id}/info`),Z(t)},onAdd:es,onDelete:ts,hideFab:Kt});return e.jsx(Bt.Provider,{value:F,children:e.jsx(Ts,{theme:Qt,children:e.jsxs(z,{sx:{height:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box"},children:[e.jsx(_s,{}),e.jsx(Us,{position:"fixed",sx:{bgcolor:U.appBarColor,color:U.appBarTextColor},children:e.jsxs(As,{sx:{position:"relative"},children:[qt,e.jsx(Is,{variant:"h6",component:"div",sx:{position:"absolute",left:"50%",transform:"translateX(-50%)"},color:"inherit",children:"BreakPoint"}),e.jsx(z,{sx:{flexGrow:1}}),Nt]})}),e.jsx(z,{sx:{flex:1,position:"relative",display:"flex",overflowY:"auto"},children:e.jsx(Vs,{initial:!1,mode:"wait",children:e.jsx(Vr,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},sx:{position:"absolute",width:"100%",display:"flex"},children:e.jsx(Rs,{maxWidth:!1,disableGutters:!0,sx:{flex:1,pt:2,pb:2,display:"flex",flexDirection:"column"},children:e.jsx(i.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:cs})})},k)})}),e.jsx(Sr,{value:k==="matches"||k==="analysis"||k==="settings"?k:void 0,onChange:t=>{t===k&&ie===null||is(()=>{et(!0),setTimeout(()=>{Z(null),W(t),de(null),et(!1)},0)})}}),e.jsxs(ke,{open:Yt,onClose:st,children:[e.jsx(Se,{children:"確認"}),e.jsx($e,{sx:{mt:2},children:"未保存のデータがあります。保存せずに移動しますか？"}),e.jsxs(je,{children:[e.jsx(ce,{onClick:st,startIcon:e.jsx(We,{}),children:"キャンセル"}),e.jsx(ce,{onClick:ls,color:"error",startIcon:e.jsx(Fe,{}),children:"OK"})]})]}),e.jsx(jr,{open:ue.open,message:ue.message,severity:ue.severity,actionLabel:ue.actionLabel,onAction:ue.onAction,autoHideDuration:ue.autoHideDuration,onClose:()=>tt(t=>({...t,open:!1}))})]})})})}const Hr=()=>e.jsx(Ps,{basename:"/breakpoint/v1",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs(ks,{children:[e.jsx(fe,{path:"/",element:e.jsx(ye,{})}),e.jsx(fe,{path:"/matches/*",element:e.jsx(ye,{})}),e.jsx(fe,{path:"/analysis/*",element:e.jsx(ye,{})}),e.jsx(fe,{path:"/settings/*",element:e.jsx(ye,{})}),e.jsx(fe,{path:"*",element:e.jsx($s,{to:"/",replace:!0})})]})});function Nr(o={}){const{immediate:r=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:a,onRegisteredSW:l,onRegisterError:c}=o;let h,u;const S=async(m=!0)=>{await u};async function f(){if("serviceWorker"in navigator){const{Workbox:m}=await me(async()=>{const{Workbox:y}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:y}},[]);h=new m("/breakpoint/v1/sw.js",{scope:"/breakpoint/v1/",type:"classic"}),h.addEventListener("activated",y=>{(y.isUpdate||y.isExternal)&&window.location.reload()}),h.addEventListener("installed",y=>{y.isUpdate||s==null||s()}),h.register({immediate:r}).then(y=>{l?l("/breakpoint/v1/sw.js",y):a==null||a(y)}).catch(y=>{c==null||c(y)})}}return u=f(),S}var Ke={},Wr=J;Object.defineProperty(Ke,"__esModule",{value:!0});var zt=Ke.default=void 0,qr=Wr(Y()),Fr=e;zt=Ke.default=(0,qr.default)((0,Fr.jsx)("path",{d:"m12 16.5 4-4h-3v-9h-2v9H8zm9-13h-6v1.99h6v14.03H3V5.49h6V3.5H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2v-14c0-1.1-.9-2-2-2"}),"SystemUpdateAlt");var Qe={},Gr=J;Object.defineProperty(Qe,"__esModule",{value:!0});var Vt=Qe.default=void 0,Xr=Gr(Y()),Jr=e;Vt=Qe.default=(0,Xr.default)((0,Jr.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m4.2 14.2L11 13V7h1.5v5.2l4.5 2.7z"}),"WatchLater");const Yr=({children:o,open:r=!1,onClose:n,PaperProps:s,...a})=>{var h;const l=It();if(Ge("md")){const u=()=>{n&&n({},"backdropClick")},S=te.Children.toArray(o);let f,m;const y=[];S.forEach(R=>{te.isValidElement(R)&&R.type===Se?f=R:te.isValidElement(R)&&R.type===je?m=R:y.push(R)});const L=m?te.Children.toArray(m.props.children):[],H=L[0],P=L.length>1?L[L.length-1]:void 0,V=(R,U)=>{if(te.isValidElement(R)){const q=R;return te.cloneElement(q,{sx:{minWidth:"auto",...q.props.sx||{},...U}})}return null};return e.jsx(Es,{anchor:"bottom",open:r,onClose:u,onOpen:()=>{},sx:{zIndex:l.zIndex.modal},PaperProps:{sx:{height:"100vh",borderTopLeftRadius:0,borderTopRightRadius:0}},children:e.jsxs(z,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(z,{sx:{position:"relative",display:"flex",alignItems:"center",p:2},children:[V(H),e.jsx(z,{sx:{position:"absolute",left:"50%",transform:"translateX(-50%)",fontWeight:"bold"},children:f==null?void 0:f.props.children}),P&&V(P,te.isValidElement(P)&&((h=P.props.sx)!=null&&h.color||P.props.color)?{ml:"auto"}:{ml:"auto",color:l.palette.primary.main})]}),e.jsx(z,{sx:{flex:1,overflowY:"auto"},children:y})]})})}return e.jsx(ke,{...a,open:r,onClose:n,fullWidth:!0,maxWidth:!1,PaperProps:{sx:{width:"100%",maxWidth:768,...(s==null?void 0:s.sx)||{}},...s},children:o})};function Kr({open:o,onReload:r,onClose:n}){return e.jsxs(Yr,{open:o,onClose:n,children:[e.jsx(Se,{children:"更新があります"}),e.jsx($e,{children:"更新があります。再読み込みしますか？"}),e.jsxs(je,{children:[e.jsx(ce,{onClick:n,color:"inherit",startIcon:e.jsx(Vt,{}),children:"後で"}),e.jsx(ce,{onClick:r,autoFocus:!0,startIcon:e.jsx(zt,{}),children:"再読み込み"})]})]})}const Qr=Nr({immediate:!0,onNeedRefresh(){window.dispatchEvent(new Event("sw-need-refresh"))}});function Zr(){const[o,r]=i.useState(!1);i.useEffect(()=>{const s=()=>r(!0);return window.addEventListener("sw-need-refresh",s),()=>window.removeEventListener("sw-need-refresh",s)},[]);const n=()=>{Qr(!0),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(Hr,{}),e.jsx(Kr,{open:o,onReload:n,onClose:()=>r(!1)})]})}Et(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(Zr,{})}));export{jr as A,I as D,Yr as R,dr as S,me as _,Mt as a,We as b,Fe as c,Lt as d,ir as e,Ot as f,lr as g,Pt as h,Rr as l,Y as r,Er as s,Ge as u};
