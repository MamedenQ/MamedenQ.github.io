const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MatchDetail-DaIzyTED.js","assets/mui-vendor-Bb0AjAZd.js","assets/react-vendor-QLNaZ7XN.js","assets/QueryStatsOutlined-BEP-iv_-.js","assets/DragIndicator-Tr1h8JFu.js","assets/chart-vendor-CuPFlH9t.js","assets/motion-vendor-Bslre2pU.js","assets/Settings-wpj36oHG.js","assets/Analysis-CnUOhYNX.js","assets/Dashboard-BLSZe4YA.js"])))=>i.map(i=>d[i]);
import{u as hs,i as J,j as e,a as Et,b as fs,B as H,T as ms,F as ps,S as gs,M as Ae,d as xs,e as Ie,f as Mt,g as vs,h as ys,k as Re,l as z,m as bs,D as $e,n as Se,o as ze,p as je,q as ce,r as Ss,C as js,I as ws,s as Cs,t as Ee,v as Ds,A as Ts,w as _s,x as Us,y as As,z as Is,E as Rs,G as Es,H as Ms,J as Ls}from"./mui-vendor-Bb0AjAZd.js";import{d as Os,a as Bs,r as i,b as se,u as Ps,f as ks,B as $s,h as zs,i as fe,N as Hs}from"./react-vendor-QLNaZ7XN.js";import{m as Vs,A as Ns}from"./motion-vendor-Bslre2pU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var Lt,mt=Os;Lt=mt.createRoot,mt.hydrateRoot;const Ws="modulepreload",qs=function(o){return"/breakpoint/v1/"+o},pt={},me=function(r,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),h=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=Promise.allSettled(n.map(u=>{if(u=qs(u),u in pt)return;pt[u]=!0;const S=u.endsWith(".css"),f=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=S?"stylesheet":Ws,S||(m.as="script"),m.crossOrigin="",m.href=u,h&&m.setAttribute("nonce",h),document.head.appendChild(m),S)return new Promise((y,L)=>{m.addEventListener("load",y),m.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(c){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=c,window.dispatchEvent(h),!h.defaultPrevented)throw c}return a.then(c=>{for(const h of c||[])h.status==="rejected"&&l(h.reason);return r().catch(l)})};var He={},Me={};const Fs=Bs(hs);var gt;function Y(){return gt||(gt=1,function(o){"use client";Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=Fs}(Me)),Me}var Gs=J;Object.defineProperty(He,"__esModule",{value:!0});var Ot=He.default=void 0,Xs=Gs(Y()),Js=e;Ot=He.default=(0,Xs.default)((0,Js.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var Ve={},Ys=J;Object.defineProperty(Ve,"__esModule",{value:!0});var Bt=Ve.default=void 0,Ks=Ys(Y()),Qs=e;Bt=Ve.default=(0,Ks.default)((0,Qs.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var Ne={},Zs=J;Object.defineProperty(Ne,"__esModule",{value:!0});var Pt=Ne.default=void 0,er=Zs(Y()),tr=e;Pt=Ne.default=(0,er.default)((0,tr.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2M9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9zm9 14H6V10h12zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2"}),"LockOutlined");var We={},sr=J;Object.defineProperty(We,"__esModule",{value:!0});var qe=We.default=void 0,rr=sr(Y()),nr=e;qe=We.default=(0,rr.default)((0,nr.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var Fe={},or=J;Object.defineProperty(Fe,"__esModule",{value:!0});var Ge=Fe.default=void 0,ar=or(Y()),ir=e;Ge=Fe.default=(0,ar.default)((0,ir.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");const lr=(o,r)=>[o,r].sort().join(":"),cr=(o,r,n)=>[o,r].sort().map(s=>{var a;return((a=n.find(l=>l.id===s))==null?void 0:a.name)||""}).join(" - ");function dr(o,r){return o.reduce((n,s)=>{let a="";return r==="dateName"?a=`${s.date} ${s.matchName}`:r==="card"?a=lr(s.teamA,s.teamB):a="all",n[a]||(n[a]=[]),n[a].push(s),n},{})}function Xe(o){const r=Et();return fs(r.breakpoints.down(o))}function ur(){return e.jsxs("svg",{width:"160",height:"40",viewBox:"0 0 160 40",role:"img","aria-label":"横スクロール可能",children:[e.jsx("rect",{width:"160",height:"40",rx:"4",fill:"rgba(0,0,0,0.6)"}),e.jsx("text",{x:"80",y:"26",fill:"#fff",fontSize:"14",textAnchor:"middle",children:"横スクロール可能"})]})}const kt=i.createContext({rallyMemberRequired:!1,showRallyIcons:!1,showScoreProgressArea:!1,showGridScrollHint:!1});function hr({storageKey:o,children:r,...n}){const s=i.useRef(null),[a,l]=i.useState(!1),c=Xe("md"),{showGridScrollHint:h}=i.useContext(kt);i.useEffect(()=>{if(!c||!h){l(!1);return}const f=s.current;f&&(typeof window<"u"&&localStorage.getItem(`scrollHint-${o}`)||f.scrollWidth>f.clientWidth&&l(!0))},[c,o,h]);const u=i.useCallback(()=>{l(!1),typeof window<"u"&&localStorage.setItem(`scrollHint-${o}`,"1")},[o]);i.useEffect(()=>{const f=s.current;if(!a||!f)return;const m={once:!0,passive:!0};return f.addEventListener("scroll",u,m),f.addEventListener("pointerdown",u,m),f.addEventListener("touchstart",u,m),()=>{f.removeEventListener("scroll",u),f.removeEventListener("pointerdown",u),f.removeEventListener("touchstart",u)}},[a,u]);const S=i.isValidElement(r)?i.cloneElement(r,{sx:{minWidth:"100%",...r.props.sx||{}}}):r;return e.jsxs(H,{sx:{position:"relative",my:1,width:"100%"},children:[e.jsx(ms,{...n,ref:s,sx:{overflowX:"auto",WebkitOverflowScrolling:"touch","& th, & td":{whiteSpace:"nowrap"},...n.sx||{},width:"100%"},onClick:u,children:S}),a&&e.jsx(H,{onClick:u,sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10,cursor:"pointer"},children:e.jsx(ur,{})})]})}const Le="#1C8139",Oe="#D21972",be="#1C8139",Be="#F5F5F5",Pe="#000000",ke="light",I=be;function fr({matches:o,teams:r,tags:n,onSelect:s,onAdd:a,onDelete:l,hideFab:c=!1}){const[h,u]=i.useState(!1),[S,f]=i.useState([]),[m,y]=i.useState("none"),[L,N]=i.useState(!1),P=Xe("md"),V=_=>{var v;return((v=r.find(G=>G.id===_))==null?void 0:v.name)||""};i.useEffect(()=>{const _=setTimeout(()=>N(!0),300);return()=>clearTimeout(_)},[]),i.useEffect(()=>{c&&N(!1)},[c]);const R=_=>{f([_]),u(!0)},T=()=>{l(S),f([]),u(!1)},q=()=>{f([]),u(!1)},F=m,ae=dr(o,F),ie=_=>_.map(v=>{const G=v.sets.filter(U=>U.my>U.opponent).length,k=v.sets.filter(U=>U.my<U.opponent).length,he=v.sets.map((U,X)=>{const de=X<v.sets.length-1?", ":"";return`${U.my}-${U.opponent}${de}`}).join("");return e.jsxs(Re,{sx:{cursor:"pointer",height:50},hover:!0,onClick:()=>s(v),children:[e.jsx(z,{children:v.date}),e.jsx(z,{children:v.matchName}),e.jsx(z,{children:`${V(v.teamA)} - ${V(v.teamB)}`}),e.jsx(z,{children:v.tags.map(U=>{const X=n.find(K=>K.id===U),de=(X==null?void 0:X.color)||I;return e.jsx(js,{label:(X==null?void 0:X.name)||U,size:"small",sx:{mr:.5,mb:.5,backgroundColor:de,color:"#fff"}},U)})}),e.jsxs(z,{children:[G,"-",k," (",he,")"]}),e.jsx(z,{padding:"checkbox",children:e.jsx(H,{onClick:U=>U.stopPropagation(),sx:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ws,{size:"small",onClick:v.locked?void 0:()=>R(v.id),disabled:v.locked,sx:{width:24,height:24},children:v.locked?e.jsx(Pt,{fontSize:"small",sx:{color:"#D21972"}}):e.jsx(Bt,{fontSize:"small",color:"error"})})})})]},v.id)});return e.jsxs(H,{sx:{pb:P?10:7},children:[e.jsx(H,{sx:{maxWidth:1024,mx:"auto",display:"flex",justifyContent:"flex-end",alignItems:"center",mb:1},children:P?e.jsx(ps,{size:"small",children:e.jsxs(gs,{value:m,onChange:_=>y(_.target.value),children:[e.jsx(Ae,{value:"none",children:"グルーピングなし"}),e.jsx(Ae,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(Ae,{value:"card",children:"対戦カード"})]})}):e.jsxs(xs,{exclusive:!0,value:m,onChange:(_,v)=>{v!==null&&y(v)},children:[e.jsx(Ie,{value:"none",children:"グルーピングなし"}),e.jsx(Ie,{value:"dateName",children:"試合日付＋試合名"}),e.jsx(Ie,{value:"card",children:"対戦カード"})]})}),e.jsx(hr,{component:Mt,storageKey:"match-list",sx:{maxWidth:1024,mx:"auto"},children:e.jsxs(vs,{size:"small",children:[e.jsx(ys,{children:e.jsxs(Re,{sx:{backgroundColor:_=>_.palette.mode==="dark"?"#343A42":"#f5f5f5",height:50},children:[e.jsx(z,{children:"日付"}),e.jsx(z,{children:"試合名"}),e.jsx(z,{children:"対戦カード"}),e.jsx(z,{children:"タグ"}),e.jsx(z,{children:"セット"}),e.jsx(z,{})]})}),e.jsx(bs,{children:F==="none"?ie(ae.all||[]):Object.entries(ae).map(([_,v])=>{const G=F==="card"?cr(v[0].teamA,v[0].teamB,r):_;return e.jsxs(se.Fragment,{children:[e.jsx(Re,{sx:{height:50},children:e.jsx(z,{colSpan:6,sx:{backgroundColor:k=>k.palette.mode==="dark"?"#343A42":"#f5f5f5",fontWeight:"bold"},children:G})}),ie(v)]},_)})})]})}),e.jsxs($e,{open:h,onClose:q,children:[e.jsx(Se,{children:"削除確認"}),e.jsx(ze,{sx:{mt:2},children:"この試合を削除しますか？"}),e.jsxs(je,{children:[e.jsx(ce,{onClick:q,startIcon:e.jsx(qe,{}),color:"inherit",children:"キャンセル"}),e.jsx(ce,{onClick:T,color:"error",startIcon:e.jsx(Ge,{}),children:"OK"})]})]}),L&&e.jsx(Ss,{ariaLabel:"add match",icon:e.jsx(Ot,{}),FabProps:{color:"primary",onClick:a},sx:{position:"fixed",right:20,bottom:80}})]})}var Je={},mr=J;Object.defineProperty(Je,"__esModule",{value:!0});var $t=Je.default=void 0,pr=mr(Y()),gr=e;$t=Je.default=(0,pr.default)((0,gr.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 2.07c3.07.38 5.57 2.52 6.54 5.36L13 5.65zM8 5.08c1.18-.69 3.33-1.06 3-1.02v7.35l-3 1.73zM4.63 15.1c-.4-.96-.63-2-.63-3.1 0-2.02.76-3.86 2-5.27v7.58zm1.01 1.73L12 13.15l3 1.73-6.98 4.03c-.93-.53-1.74-1.23-2.38-2.08M12 20c-.54 0-1.07-.06-1.58-.16l6.58-3.8 1.36.78C16.9 18.75 14.6 20 12 20m1-8.58V7.96l7 4.05c0 1.1-.23 2.14-.63 3.09z"}),"SportsVolleyballOutlined");var Ye={},xr=J;Object.defineProperty(Ye,"__esModule",{value:!0});var zt=Ye.default=void 0,vr=xr(Y()),yr=e;zt=Ye.default=(0,vr.default)((0,yr.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings");var Ke={},br=J;Object.defineProperty(Ke,"__esModule",{value:!0});var Ht=Ke.default=void 0,Sr=br(Y()),jr=e;Ht=Ke.default=(0,Sr.default)((0,jr.jsx)("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"}),"BarChart");function wr({value:o,onChange:r}){return e.jsx(Mt,{sx:{position:"fixed",left:0,right:0,bottom:0,zIndex:n=>n.zIndex.drawer+1},elevation:3,children:e.jsxs(Cs,{showLabels:!0,value:o,onChange:(n,s)=>r(s),children:[e.jsx(Ee,{label:"試合",value:"matches",icon:e.jsx($t,{})}),e.jsx(Ee,{label:"分析",value:"analysis",icon:e.jsx(Ht,{})}),e.jsx(Ee,{label:"設定",value:"settings",icon:e.jsx(zt,{})})]})})}function Cr({open:o,message:r,severity:n="success",onClose:s,actionLabel:a,onAction:l,autoHideDuration:c=3e3}){return e.jsx(Ds,{open:o,autoHideDuration:c,onClose:s,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{top:{xs:72,sm:80}},children:e.jsx(Ts,{onClose:s,severity:n,sx:{width:"100%"},action:a&&l?e.jsx(ce,{color:"inherit",size:"small",onClick:()=>{l(),s()},children:a}):void 0,children:r})})}const Dr="breakpoint-db",re="state",ne="widgets",oe="dashboards",Tr=3;function _r(){return new Promise((o,r)=>{const n=indexedDB.open(Dr,Tr);n.onupgradeneeded=()=>{const s=n.result;s.objectStoreNames.contains(re)||s.createObjectStore(re),s.objectStoreNames.contains(ne)||s.createObjectStore(ne,{keyPath:"id"}),s.objectStoreNames.contains(oe)||s.createObjectStore(oe,{keyPath:"id"})},n.onerror=()=>r(n.error),n.onsuccess=()=>o(n.result)})}const Q=_r();async function Ur(){const o=await Q;return new Promise((r,n)=>{const a=o.transaction(re,"readonly").objectStore(re).get("state");a.onsuccess=()=>r(a.result),a.onerror=()=>n(a.error)})}async function Ar(o){const r=await Q;return new Promise((n,s)=>{const a=r.transaction(re,"readwrite");a.objectStore(re).put(o,"state"),a.oncomplete=()=>n(),a.onerror=()=>s(a.error)})}async function xt(){const o=await Q;return new Promise((r,n)=>{const s=o.transaction(re,"readwrite");s.objectStore(re).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}async function Ir(){const o=await Q;return new Promise((r,n)=>{const a=o.transaction(oe,"readonly").objectStore(oe).getAll();a.onsuccess=()=>{const l=a.result;l.sort((c,h)=>c.order-h.order),r(l)},a.onerror=()=>n(a.error)})}async function Rr(o){const r=await Q;return new Promise((n,s)=>{const a=r.transaction(oe,"readwrite"),l=a.objectStore(oe);l.clear();for(const c of o)l.put(c);a.oncomplete=()=>n(),a.onerror=()=>s(a.error)})}async function Er(){const o=await Q;return new Promise((r,n)=>{const s=o.transaction(oe,"readwrite");s.objectStore(oe).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}async function Mr(o){const r=await Q;return new Promise((n,s)=>{const l=r.transaction(ne,"readonly").objectStore(ne).getAll();l.onsuccess=()=>{const c=l.result;n(c.filter(h=>h.dashboardId===o))},l.onerror=()=>s(l.error)})}async function Lr(o,r){const n=await Q;return new Promise((s,a)=>{const l=n.transaction(ne,"readwrite"),c=l.objectStore(ne),h=c.getAll();h.onsuccess=()=>{const u=h.result;for(const S of u)S.dashboardId===o&&c.delete(S.id);for(const S of r)c.put({...S,dashboardId:o})},h.onerror=()=>a(h.error),l.oncomplete=()=>s(),l.onerror=()=>a(l.error)})}async function vt(){const o=await Q;return new Promise((r,n)=>{const s=o.transaction(ne,"readwrite");s.objectStore(ne).clear(),s.oncomplete=()=>r(),s.onerror=()=>n(s.error)})}function Or(o,r){const s=new TextEncoder().encode(r),a=Pr(s),l=new Uint8Array(30+o.length),c=new DataView(l.buffer);c.setUint32(0,67324752,!0),c.setUint16(4,20,!0),c.setUint16(6,0,!0),c.setUint16(8,0,!0),c.setUint16(10,0,!0),c.setUint16(12,0,!0),c.setUint32(14,a,!0),c.setUint32(18,s.length,!0),c.setUint32(22,s.length,!0),c.setUint16(26,o.length,!0),c.setUint16(28,0,!0);for(let m=0;m<o.length;m++)l[30+m]=o.charCodeAt(m);const h=new Uint8Array(46+o.length),u=new DataView(h.buffer);u.setUint32(0,33639248,!0),u.setUint16(4,20,!0),u.setUint16(6,20,!0),u.setUint16(8,0,!0),u.setUint16(10,0,!0),u.setUint16(12,0,!0),u.setUint16(14,0,!0),u.setUint32(16,a,!0),u.setUint32(20,s.length,!0),u.setUint32(24,s.length,!0),u.setUint16(28,o.length,!0),u.setUint16(30,0,!0),u.setUint16(32,0,!0),u.setUint16(34,0,!0),u.setUint16(36,0,!0),u.setUint32(38,0,!0),u.setUint32(42,0,!0);for(let m=0;m<o.length;m++)h[46+m]=o.charCodeAt(m);const S=new Uint8Array(22),f=new DataView(S.buffer);return f.setUint32(0,101010256,!0),f.setUint16(4,0,!0),f.setUint16(6,0,!0),f.setUint16(8,1,!0),f.setUint16(10,1,!0),f.setUint32(12,h.length,!0),f.setUint32(16,l.length+s.length,!0),f.setUint16(20,0,!0),new Blob([l,s,h,S],{type:"application/zip"})}async function Br(o){const r=await o.arrayBuffer(),n=new DataView(r);if(n.getUint32(0,!0)!==67324752)throw new Error("invalid zip");const s=n.getUint16(26,!0),a=n.getUint16(28,!0),l=n.getUint32(22,!0),c=30+s+a,h=r.slice(c,c+l);return new TextDecoder().decode(h)}function Pr(o){let r=-1;for(let n=0;n<o.length;n++)r=r>>>8^kr[(r^o[n])&255];return(r^-1)>>>0}const kr=(()=>{const o=new Uint32Array(256);for(let r=0;r<256;r++){let n=r;for(let s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;o[r]=n>>>0}return o})(),yt="1.0.0",$r=i.lazy(()=>me(()=>import("./MatchDetail-DaIzyTED.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),zr=i.lazy(()=>me(()=>import("./Settings-wpj36oHG.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),Hr=i.lazy(()=>me(()=>import("./Analysis-CnUOhYNX.js"),__vite__mapDeps([8,1,2,4,5,6]))),Vr=i.lazy(()=>me(()=>import("./Dashboard-BLSZe4YA.js"),__vite__mapDeps([9,1,2,6]))),bt=[],St={},jt=[{id:"init-serve",name:"サーブ",color:I,iconType:"none",tags:[],visible:!0}],wt=[{id:"init-ace",playCategoryId:"init-serve",name:"エース",pointType:"得点",pointUnitType:"メンバー",tags:[],visible:!0},{id:"init-out",playCategoryId:"init-serve",name:"アウト",pointType:"失点",pointUnitType:"メンバー",tags:[],visible:!0},{id:"init-net",playCategoryId:"init-serve",name:"ネット",pointType:"失点",pointUnitType:"メンバー",tags:[],visible:!0}],Ct=[],Dt={rallyMemberRequired:!1,showRallyIcons:!1,showScoreProgressArea:!1,showGridScrollHint:!1},Tt={mode:ke,scoreColor:Le,lossColor:Oe,buttonColor:be,appBarColor:Be,appBarTextColor:Pe},_t=[],Ut=[],At=[],It=[],Rt=[],ve=[],Nr=Vs.create(H);function ye(){const[o,r]=i.useState(Rt),[n,s]=i.useState(bt),[a,l]=i.useState(St),[c,h]=i.useState(jt),[u,S]=i.useState(wt),[f,m]=i.useState(Ct),[y,L]=i.useState(Ut),[N,P]=i.useState(At),[V,R]=i.useState(It),[T,q]=i.useState(Tt),[F,ae]=i.useState(Dt),[ie,_]=i.useState(_t),[v,G]=i.useState(ve),k=i.useRef(ve),[he,U]=i.useState(null),[X,de]=i.useState(null),[K,pe]=i.useState(!1);i.useEffect(()=>{k.current=v},[v]);const[le,Z]=i.useState(null),ee=Ps(),ge=ks(),we=i.useCallback(t=>t.startsWith("/matches")?"matches":t.startsWith("/analysis")?"analysis":t.startsWith("/settings")?"settings":"dashboard",[]),[$,Wt]=i.useState(we(ee.pathname)),W=i.useCallback(t=>{Wt(t);const p=t==="dashboard"?"/":`/${t}`;(t==="dashboard"?ee.pathname!==p:!ee.pathname.startsWith(p))&&ge(p)},[ge,ee.pathname]);i.useEffect(()=>{W(we(ee.pathname))},[ee.pathname,W,we]),i.useEffect(()=>{const t=ee.pathname.split("/").filter(Boolean);if(t[0]==="matches"&&t[1]){const p=o.find(d=>d.id===t[1])||null;Z(p)}else Z(null)},[ee.pathname,o]);const[qt,Ft]=i.useState(null),[Gt,et]=i.useState(null),[Xt,Jt]=i.useState(!1),[Yt,Kt]=i.useState(!1),[Ce,De]=i.useState(null),[Qt,Te]=i.useState(!1),[Zt,tt]=i.useState(!1),[ue,st]=i.useState({open:!1,message:"",severity:"success"}),_e=(t,p,d)=>{st({open:!0,message:t,severity:p,...d})},es=i.useMemo(()=>_s({palette:{mode:T.mode,primary:{main:T.buttonColor}},components:{MuiButtonBase:{styleOverrides:{root:{"&:focus":{outline:"none"},"&.Mui-focusVisible":{outline:"none"}}}},MuiDialogTitle:{styleOverrides:{root:{backgroundColor:T.appBarColor,color:T.appBarTextColor}}}}}),[T.mode,T.buttonColor,T.appBarColor,T.appBarTextColor]);i.useEffect(()=>{window.scrollTo(0,0)},[$,le]),i.useEffect(()=>{!K&&$==="dashboard"&&W("matches")},[K,$,W]),i.useEffect(()=>{Ur().then(t=>{if(!t)return;const p=g=>typeof g=="string"?{id:crypto.randomUUID(),name:g,color:I}:{id:g.id||crypto.randomUUID(),name:g.name,color:g.color||I},d=t.tags?t.tags.map(p):[],A=t.rallyCategoryTags?t.rallyCategoryTags.map(p):t.rallyTags?t.rallyTags.map(p):[],E=t.rallyDetailTags?t.rallyDetailTags.map(p):t.rallyTags?t.rallyTags.map(p):[];t.matches&&r(t.matches.map(g=>({...g,tags:(g.tags||[]).map(x=>{const j=d.find(te=>te.id===x);if(j)return j.id;const b=d.find(te=>te.name===x);if(b)return b.id;const D={id:crypto.randomUUID(),name:x,color:I};return d.push(D),D.id}),matchStatsSettings:g.matchStatsSettings||[]}))),t.teams&&s(t.teams),t.teamMembers&&l(t.teamMembers),t.playCategories&&h(t.playCategories.map(g=>({...g,tags:(g.tags||[]).map(x=>{const j=A.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return A.push(b),b.id}),color:g.color||I,visible:g.visible!==!1}))),t.playDetails&&S(t.playDetails.map(g=>({...g,tags:(g.tags||[]).map(x=>{const j=E.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return E.push(b),b.id}),visible:g.visible!==!1}))),t.statsSettings&&m(t.statsSettings.map(g=>({...g,playCategoryTags:(g.playCategoryTags||[]).map(x=>{const j=A.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return A.push(b),b.id}),playDetailTags:(g.playDetailTags||[]).map(x=>{const j=E.find(D=>D.id===x||D.name===x);if(j)return j.id;const b={id:crypto.randomUUID(),name:x,color:I};return E.push(b),b.id})}))),L(d),P(A),R(E),t.themeSetting&&q({mode:t.themeSetting.mode??ke,scoreColor:t.themeSetting.scoreColor??Le,lossColor:t.themeSetting.lossColor??Oe,buttonColor:t.themeSetting.buttonColor??be,appBarColor:t.themeSetting.appBarColor??Be,appBarTextColor:t.themeSetting.appBarTextColor??Pe}),t.scoreInputSetting&&ae({rallyMemberRequired:t.scoreInputSetting.rallyMemberRequired??!0,showRallyIcons:t.scoreInputSetting.showRallyIcons??!0,showScoreProgressArea:t.scoreInputSetting.showScoreProgressArea??!0,showGridScrollHint:t.scoreInputSetting.showGridScrollHint??!1}),t.customAnalyses&&_(t.customAnalyses),t.dashboardVisible!==void 0?(pe(t.dashboardVisible),t.dashboardVisible||W("matches")):t.dashboardDisabled!==void 0&&(pe(!t.dashboardDisabled),t.dashboardDisabled&&W("matches"))})},[]),i.useEffect(()=>{Ir().then(t=>{if(t.length===0)G([]),k.current=[],U(null),W("matches");else{const p=t.sort((d,A)=>d.order-A.order);G(p),k.current=p,U(p[0].id)}})},[]),i.useEffect(()=>{Ar({matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:N,rallyDetailTags:V,themeSetting:T,scoreInputSetting:F,customAnalyses:ie,dashboardVisible:K})},[o,n,a,c,u,f,y,N,V,T,F,ie,K]);const ts=(t,p)=>{l(d=>({...d,[t]:[...d[t]||[],p]}))},ss=()=>{const t={id:crypto.randomUUID(),date:new Date().toISOString().slice(0,10),matchName:"",location:"",mainReferee:"",subReferee:"",videoUrl:"",memo:"",teamA:"",teamAHeadCoach:"",teamACoach:"",teamAManager:"",teamACaptain:"",teamB:"",teamBHeadCoach:"",teamBCoach:"",teamBManager:"",teamBCaptain:"",tags:[],sets:[],teamAMembers:[],teamBMembers:[],matchStatsSettings:[],locked:!1};r(p=>[...p,t]),ge(`/matches/${t.id}/info`),Z(t)},rs=t=>{let p=[];r(d=>(p=d.map(A=>({...A})),d.filter(A=>!t.includes(A.id)))),_e("試合を削除しました","success",{actionLabel:"元に戻す",onAction:()=>r(p),autoHideDuration:5e3})},ns=async()=>{await xt(),await Er(),await vt(),r(Rt),s(bt),l(St),h(jt),S(wt),m(Ct),L(Ut),P(At),R(It),q(Tt),ae(Dt),_(_t),G(ve),k.current=ve,U(null),Z(null),pe(!1),W("matches")},os=async()=>{const t=[];for(const b of k.current){const D=await Mr(b.id);t.push(...D)}const p={schemaVersion:yt,matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:N,rallyDetailTags:V,themeSetting:T,scoreInputSetting:F,customAnalyses:ie,dashboards:k.current,widgets:t},d=Or("data.json",JSON.stringify(p)),A=URL.createObjectURL(d),E=document.createElement("a");E.href=A;const g=new Date,x=b=>b.toString().padStart(2,"0"),j=g.getFullYear().toString()+x(g.getMonth()+1)+x(g.getDate())+x(g.getHours())+x(g.getMinutes())+x(g.getSeconds());E.download=`breakpoint-data-${j}.zip`,E.click(),URL.revokeObjectURL(A)},as=async t=>{var D,te,xe,nt,ot,at,it,lt,ct,dt,ut,ht,ft;const p=await Br(t),d=JSON.parse(p),A=d.schemaVersion??"1.0.0";A!==yt&&console.warn(`unexpected schema version: ${A}`),await xt();const E=d.dashboards||[];if(G(E),k.current=E,await Rr(E),U(((D=E[0])==null?void 0:D.id)??null),await vt(),Array.isArray(d.widgets)){const w={};for(const C of d.widgets)(w[te=C.dashboardId]||(w[te]=[])).push(C);await Promise.all(Object.entries(w).map(([C,M])=>Lr(C,M)))}const g=w=>typeof w=="string"?{id:crypto.randomUUID(),name:w,color:I}:{id:w.id||crypto.randomUUID(),name:w.name,color:w.color||I},x=((xe=d.tags)==null?void 0:xe.map(g))||[],j=(d.rallyCategoryTags?d.rallyCategoryTags:d.rallyTags||[]).map(g),b=(d.rallyDetailTags?d.rallyDetailTags:d.rallyTags||[]).map(g);r((d.matches||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=x.find(Ue=>Ue.id===C);if(M)return M.id;const O=x.find(Ue=>Ue.name===C);if(O)return O.id;const B={id:crypto.randomUUID(),name:C,color:I};return x.push(B),B.id})}))),s(d.teams||[]),l(d.teamMembers||{}),h((d.playCategories||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=j.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return j.push(O),O.id}),color:w.color||I}))),S((d.playDetails||[]).map(w=>({...w,tags:(w.tags||[]).map(C=>{const M=b.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return b.push(O),O.id})}))),m((d.statsSettings||[]).map(w=>({...w,playCategoryTags:(w.playCategoryTags||[]).map(C=>{const M=j.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return j.push(O),O.id}),playDetailTags:(w.playDetailTags||[]).map(C=>{const M=b.find(B=>B.id===C||B.name===C);if(M)return M.id;const O={id:crypto.randomUUID(),name:C,color:I};return b.push(O),O.id})}))),L(x),P(j),R(b),q({mode:((nt=d.themeSetting)==null?void 0:nt.mode)??ke,scoreColor:((ot=d.themeSetting)==null?void 0:ot.scoreColor)??Le,lossColor:((at=d.themeSetting)==null?void 0:at.lossColor)??Oe,buttonColor:((it=d.themeSetting)==null?void 0:it.buttonColor)??be,appBarColor:((lt=d.themeSetting)==null?void 0:lt.appBarColor)??Be,appBarTextColor:((ct=d.themeSetting)==null?void 0:ct.appBarTextColor)??Pe}),ae({rallyMemberRequired:((dt=d.scoreInputSetting)==null?void 0:dt.rallyMemberRequired)??!0,showRallyIcons:((ut=d.scoreInputSetting)==null?void 0:ut.showRallyIcons)??!0,showScoreProgressArea:((ht=d.scoreInputSetting)==null?void 0:ht.showScoreProgressArea)??!0,showGridScrollHint:((ft=d.scoreInputSetting)==null?void 0:ft.showGridScrollHint)??!1}),_(d.customAnalyses||[]),Z(null),W(K&&k.current.length>0?"dashboard":"matches")},is=t=>{r(p=>p.map(d=>d.id===t.id?{...d,...t}:d)),Z(t)},ls=(t,p,d,A,E,g,x,j,b,D,te,xe=!1)=>{s(t),l(p),h(d),S(A),m(E),L(g),P(x),R(j),q(b),ae(D),r(te),xe||W(K&&k.current.length>0?"dashboard":"matches")},cs=t=>{const p=le?Xt:$==="settings"?Yt:!1,d=()=>{le&&localStorage.removeItem(`matchDraft-${le.id}`),t()};p?(De(()=>d),Te(!0)):d()},ds=()=>{Te(!1),Ce==null||Ce(),De(null)},rt=()=>{Te(!1),De(null)},us=$==="dashboard"?he&&e.jsx(Vr,{dashboardId:he,editing:X===he,onExitEdit:()=>de(null),teams:n}):$==="settings"?e.jsx(zr,{matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,statsSettings:f,tags:y,rallyCategoryTags:N,rallyDetailTags:V,themeSetting:T,scoreInputSetting:F,onSave:ls,onDeleteData:ns,onImportData:as,onExportData:os,showSnackbar:_e,dashboardVisible:K,onDashboardVisibleChange:pe,setAppBarLeftAction:et,onDirtyChange:Kt}):$==="analysis"?e.jsx(Hr,{matches:o,teams:n,teamMembers:a,playCategories:c,playDetails:u,customAnalyses:ie,onCustomAnalysesChange:_,tags:y,rallyCategoryTags:N,rallyDetailTags:V,themeSetting:T,showSnackbar:_e}):le?e.jsx($r,{match:le,onSave:is,setAppBarAction:Ft,setAppBarLeftAction:et,teams:n,teamMembers:a,playDetails:u,playCategories:c,statsSettings:f,rallyCategoryTags:N,rallyDetailTags:V,themeSetting:T,scoreInputSetting:F,onAddMember:ts,tags:y,onAddTag:t=>L(p=>p.some(d=>d.id===t.id)?p:[...p,t]),onDirtyChange:Jt}):e.jsx(fr,{matches:o,teams:n,tags:y,onSelect:t=>{ge(`/matches/${t.id}/info`),Z(t)},onAdd:ss,onDelete:rs,hideFab:Zt});return e.jsx(kt.Provider,{value:F,children:e.jsx(Us,{theme:es,children:e.jsxs(H,{sx:{height:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box"},children:[e.jsx(As,{}),e.jsx(Is,{position:"fixed",sx:{bgcolor:T.appBarColor,color:T.appBarTextColor},children:e.jsxs(Rs,{sx:{position:"relative"},children:[Gt,e.jsx(Es,{variant:"h6",component:"div",sx:{position:"absolute",left:"50%",transform:"translateX(-50%)"},color:"inherit",children:"BreakPoint"}),e.jsx(H,{sx:{flexGrow:1}}),qt]})}),e.jsx(H,{sx:{flex:1,position:"relative",display:"flex",overflowY:"auto"},children:e.jsx(Ns,{initial:!1,mode:"wait",children:e.jsx(Nr,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},sx:{position:"absolute",width:"100%",display:"flex"},children:e.jsx(Ms,{maxWidth:!1,disableGutters:!0,sx:{flex:1,pt:2,pb:2,display:"flex",flexDirection:"column"},children:e.jsx(i.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:us})})},$)})}),e.jsx(wr,{value:$==="matches"||$==="analysis"||$==="settings"?$:void 0,onChange:t=>{t===$&&le===null||cs(()=>{tt(!0),setTimeout(()=>{Z(null),W(t),de(null),tt(!1)},0)})}}),e.jsxs($e,{open:Qt,onClose:rt,children:[e.jsx(Se,{children:"確認"}),e.jsx(ze,{sx:{mt:2},children:"未保存のデータがあります。保存せずに移動しますか？"}),e.jsxs(je,{children:[e.jsx(ce,{onClick:rt,startIcon:e.jsx(qe,{}),children:"キャンセル"}),e.jsx(ce,{onClick:ds,color:"error",startIcon:e.jsx(Ge,{}),children:"OK"})]})]}),e.jsx(Cr,{open:ue.open,message:ue.message,severity:ue.severity,actionLabel:ue.actionLabel,onAction:ue.onAction,autoHideDuration:ue.autoHideDuration,onClose:()=>st(t=>({...t,open:!1}))})]})})})}const Wr=()=>e.jsx($s,{basename:"/breakpoint/v1",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs(zs,{children:[e.jsx(fe,{path:"/",element:e.jsx(ye,{})}),e.jsx(fe,{path:"/matches/*",element:e.jsx(ye,{})}),e.jsx(fe,{path:"/analysis/*",element:e.jsx(ye,{})}),e.jsx(fe,{path:"/settings/*",element:e.jsx(ye,{})}),e.jsx(fe,{path:"*",element:e.jsx(Hs,{to:"/",replace:!0})})]})});function qr(o={}){const{immediate:r=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:a,onRegisteredSW:l,onRegisterError:c}=o;let h,u;const S=async(m=!0)=>{await u};async function f(){if("serviceWorker"in navigator){const{Workbox:m}=await me(async()=>{const{Workbox:y}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:y}},[]);h=new m("/breakpoint/v1/sw.js",{scope:"/breakpoint/v1/",type:"classic"}),h.addEventListener("activated",y=>{(y.isUpdate||y.isExternal)&&window.location.reload()}),h.addEventListener("installed",y=>{y.isUpdate||s==null||s()}),h.register({immediate:r}).then(y=>{l?l("/breakpoint/v1/sw.js",y):a==null||a(y)}).catch(y=>{c==null||c(y)})}}return u=f(),S}var Qe={},Fr=J;Object.defineProperty(Qe,"__esModule",{value:!0});var Vt=Qe.default=void 0,Gr=Fr(Y()),Xr=e;Vt=Qe.default=(0,Gr.default)((0,Xr.jsx)("path",{d:"m12 16.5 4-4h-3v-9h-2v9H8zm9-13h-6v1.99h6v14.03H3V5.49h6V3.5H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2v-14c0-1.1-.9-2-2-2"}),"SystemUpdateAlt");var Ze={},Jr=J;Object.defineProperty(Ze,"__esModule",{value:!0});var Nt=Ze.default=void 0,Yr=Jr(Y()),Kr=e;Nt=Ze.default=(0,Yr.default)((0,Kr.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m4.2 14.2L11 13V7h1.5v5.2l4.5 2.7z"}),"WatchLater");const Qr=({children:o,open:r=!1,onClose:n,PaperProps:s,...a})=>{var h;const l=Et();if(Xe("md")){const u=()=>{n&&n({},"backdropClick")},S=se.Children.toArray(o);let f,m;const y=[];S.forEach(R=>{se.isValidElement(R)&&R.type===Se?f=R:se.isValidElement(R)&&R.type===je?m=R:y.push(R)});const L=m?se.Children.toArray(m.props.children):[],N=L[0],P=L.length>1?L[L.length-1]:void 0,V=(R,T)=>{if(se.isValidElement(R)){const q=R;return se.cloneElement(q,{sx:{minWidth:"auto",...q.props.sx||{},...T}})}return null};return e.jsx(Ls,{anchor:"bottom",open:r,onClose:u,onOpen:()=>{},sx:{zIndex:l.zIndex.modal},PaperProps:{sx:{height:"100vh",borderTopLeftRadius:0,borderTopRightRadius:0}},children:e.jsxs(H,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(H,{sx:{position:"relative",display:"flex",alignItems:"center",p:2},children:[V(N),e.jsx(H,{sx:{position:"absolute",left:"50%",transform:"translateX(-50%)",fontWeight:"bold"},children:f==null?void 0:f.props.children}),P&&V(P,se.isValidElement(P)&&((h=P.props.sx)!=null&&h.color||P.props.color)?{ml:"auto"}:{ml:"auto",color:l.palette.primary.main})]}),e.jsx(H,{sx:{flex:1,overflowY:"auto"},children:y})]})})}return e.jsx($e,{...a,open:r,onClose:n,fullWidth:!0,maxWidth:!1,PaperProps:{sx:{width:"100%",maxWidth:768,...(s==null?void 0:s.sx)||{}},...s},children:o})};function Zr({open:o,onReload:r,onClose:n}){return e.jsxs(Qr,{open:o,onClose:n,children:[e.jsx(Se,{children:"更新があります"}),e.jsx(ze,{children:"更新があります。再読み込みしますか？"}),e.jsxs(je,{children:[e.jsx(ce,{onClick:n,color:"inherit",startIcon:e.jsx(Nt,{}),children:"後で"}),e.jsx(ce,{onClick:r,autoFocus:!0,startIcon:e.jsx(Vt,{}),children:"再読み込み"})]})]})}const en=qr({immediate:!0,onNeedRefresh(){window.dispatchEvent(new Event("sw-need-refresh"))}});function tn(){const[o,r]=i.useState(!1);i.useEffect(()=>{const s=()=>r(!0);return window.addEventListener("sw-need-refresh",s),()=>window.removeEventListener("sw-need-refresh",s)},[]);const n=()=>{en(!0),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(Wr,{}),e.jsx(Zr,{open:o,onReload:n,onClose:()=>r(!1)})]})}Lt(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(tn,{})}));export{Cr as A,I as D,Qr as R,hr as S,me as _,Ot as a,qe as b,Ge as c,Bt as d,cr as e,Pt as f,dr as g,$t as h,Mr as l,Y as r,Lr as s,Xe as u};
